{"ast":null,"code":"import { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow, getComplexFieldID, isComplexField } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * The `Group` module is used to handle group action.\n */\nvar Group = /** @class */function () {\n  /**\n   * Constructor for Grid group module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {GroupSettingsModel} groupSettings - specifies the GroupSettingsModel\n   * @param {string[]} sortedColumns - specifies the sortedColumns\n   * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n   * @hidden\n   */\n  function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n    var _this = this;\n    //Internal variables\n    this.sortRequired = true;\n    this.isAppliedGroup = false;\n    this.isAppliedUnGroup = false;\n    this.reorderingColumns = [];\n    this.visualElement = createElement('div', {\n      className: 'e-cloneproperties e-dragclone e-gdclone',\n      styles: 'line-height:23px',\n      attrs: {\n        action: 'grouping'\n      }\n    });\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = e.sender.target;\n      var element = target.classList.contains('e-groupheadercell') ? target : parentsUntil(target, 'e-groupheadercell');\n      if (!element || !target.classList.contains('e-drag') && _this.groupSettings.allowReordering) {\n        return false;\n      }\n      _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n      _this.visualElement.textContent = element.textContent;\n      _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n      _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n      _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n      gObj.element.appendChild(_this.visualElement);\n      return _this.visualElement;\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    this.dragStart = function (e) {\n      _this.parent.element.classList.add('e-ungroupdrag');\n    };\n    this.drag = function (e) {\n      if (_this.groupSettings.allowReordering) {\n        _this.animateDropper(e);\n      }\n      var target = e.target;\n      var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n      _this.parent.trigger(events.columnDrag, {\n        target: target,\n        draggableType: 'headercell',\n        column: _this.column\n      });\n      if (!_this.groupSettings.allowReordering) {\n        classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n        if (!(parentsUntil(target, literals.gridContent) || parentsUntil(target, 'e-headercell'))) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n      }\n    };\n    this.dragStop = function (e) {\n      _this.parent.element.classList.remove('e-ungroupdrag');\n      var preventDrop = !(parentsUntil(e.target, literals.gridContent) || parentsUntil(e.target, 'e-gridheader'));\n      if (_this.groupSettings.allowReordering && preventDrop) {\n        remove(e.helper);\n        if (parentsUntil(e.target, 'e-groupdroparea')) {\n          _this.rearrangeGroup();\n        } else if (!parentsUntil(e.target, 'e-grid')) {\n          var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n          if (_this.groupSettings.columns.indexOf(field) !== -1) {\n            _this.ungroupColumn(field);\n          }\n        }\n        return;\n      } else if (preventDrop) {\n        remove(e.helper);\n        return;\n      }\n    };\n    this.animateDropper = function (e) {\n      var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n      var dragField = _this.parent.getColumnByUid(uid).field;\n      var parent = parentsUntil(e.target, 'e-groupdroparea');\n      var dropTarget = parentsUntil(e.target, 'e-group-animator');\n      var grouped = [].slice.call(_this.element.getElementsByClassName('e-groupheadercell')).map(function (e) {\n        return e.querySelector('div').getAttribute('ej-mappingname');\n      });\n      var cols = JSON.parse(JSON.stringify(grouped));\n      if (dropTarget || parent) {\n        if (dropTarget) {\n          var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n          var dropIndex = +dropTarget.getAttribute('index');\n          if (dropField !== dragField) {\n            var dragIndex = cols.indexOf(dragField);\n            if (dragIndex !== -1) {\n              cols.splice(dragIndex, 1);\n            }\n            var flag = dropIndex !== -1 && dragIndex === dropIndex;\n            cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n          }\n        } else if (parent && cols.indexOf(dragField) === -1) {\n          cols.push(dragField);\n        }\n        _this.element.innerHTML = '';\n        if (cols.length && !_this.element.classList.contains('e-grouped')) {\n          _this.element.classList.add('e-grouped');\n        }\n        _this.reorderingColumns = cols;\n        for (var c = 0; c < cols.length; c++) {\n          _this.addColToGroupDrop(cols[c]);\n        }\n      } else {\n        _this.addLabel();\n        _this.removeColFromGroupDrop(dragField);\n      }\n    };\n    this.drop = function (e) {\n      var gObj = _this.parent;\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n      _this.element.classList.remove('e-hover');\n      remove(e.droppedElement);\n      _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n      _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        _this.parent.log('action_disabled_column', {\n          moduleName: _this.getModuleName(),\n          columnName: column.headerText\n        });\n        return;\n      }\n      _this.groupColumn(column.field);\n    };\n    this.contentRefresh = true;\n    this.aria = new AriaService();\n    this.parent = parent;\n    this.groupSettings = groupSettings;\n    this.serviceLocator = serviceLocator;\n    this.sortedColumns = sortedColumns;\n    this.focus = serviceLocator.getService('focus');\n    this.addEventListener();\n    this.groupGenerator = new GroupModelGenerator(this.parent);\n  }\n  Group.prototype.addLabel = function () {\n    if (!this.element.getElementsByClassName('e-group-animator').length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    }\n  };\n  Group.prototype.rearrangeGroup = function () {\n    this.sortRequired = false;\n    this.updateModel();\n  };\n  Group.prototype.columnDrag = function (e) {\n    if (this.groupSettings.allowReordering && e.column.allowGrouping) {\n      this.animateDropper(e);\n    }\n    var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n    classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n    if (!parentsUntil(e.target, 'e-groupdroparea') && !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n      classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n    }\n    if (e.target.classList.contains('e-groupdroparea')) {\n      this.element.classList.add('e-hover');\n    } else {\n      this.element.classList.remove('e-hover');\n    }\n  };\n  Group.prototype.columnDragStart = function (e) {\n    if (e.target.classList.contains('e-stackedheadercell')) {\n      return;\n    }\n    var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n    this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n    var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n    this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n  };\n  Group.prototype.columnDrop = function (e) {\n    var gObj = this.parent;\n    if (e.droppedElement.getAttribute('action') === 'grouping') {\n      var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n      if (isNullOrUndefined(column) || column.allowGrouping === false || parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !== gObj.element.getAttribute('id')) {\n        return;\n      }\n      this.ungroupColumn(column.field);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.groupComplete, this.onActionComplete, this);\n    this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n    this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n    this.parent.on(events.click, this.clickHandler, this);\n    this.parent.on(events.columnDrag, this.columnDrag, this);\n    this.parent.on(events.columnDragStart, this.columnDragStart, this);\n    this.parent.on(events.headerDrop, this.columnDrop, this);\n    this.parent.on(events.columnDrop, this.columnDrop, this);\n    this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n    this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n    this.parent.on(events.keyPressed, this.keyPressHandler, this);\n    this.parent.on(events.contentReady, this.initialEnd, this);\n    this.parent.on(events.onEmpty, this.initialEnd, this);\n    this.parent.on(events.initialEnd, this.render, this);\n    this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n    this.parent.on(events.destroy, this.destroy, this);\n    this.parent.on('group-expand-collapse', this.updateExpand, this);\n    this.parent.on('persist-data-changed', this.initialEnd, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(events.initialEnd, this.render);\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.groupComplete, this.onActionComplete);\n    this.parent.off(events.ungroupComplete, this.onActionComplete);\n    this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n    this.parent.off(events.click, this.clickHandler);\n    this.parent.off(events.columnDrag, this.columnDrag);\n    this.parent.off(events.columnDragStart, this.columnDragStart);\n    this.parent.off(events.columnDrop, this.columnDrop);\n    this.parent.off(events.headerDrop, this.columnDrop);\n    this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n    this.parent.off(events.sortComplete, this.refreshSortIcons);\n    this.parent.off(events.keyPressed, this.keyPressHandler);\n    this.parent.off(events.groupAggregates, this.onGroupAggregates);\n    this.parent.off(events.destroy, this.destroy);\n    this.parent.off('group-expand-collapse', this.updateExpand);\n  };\n  Group.prototype.initialEnd = function () {\n    var gObj = this.parent;\n    this.parent.off(events.contentReady, this.initialEnd);\n    this.parent.off(events.onEmpty, this.initialEnd);\n    if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n      this.contentRefresh = false;\n      for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n        var col = _a[_i];\n        this.groupColumn(col);\n      }\n      this.contentRefresh = true;\n    }\n  };\n  Group.prototype.keyPressHandler = function (e) {\n    var gObj = this.parent;\n    if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length || ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n      return;\n    }\n    e.preventDefault();\n    switch (e.action) {\n      case 'altDownArrow':\n      case 'altUpArrow':\n        // eslint-disable-next-line no-case-declarations\n        var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n        if (selected.length) {\n          var rows = gObj.getContentTable().querySelector(literals.tbody).children;\n          var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n          var grpRow = void 0;\n          for (var i = dataRow.rowIndex; i >= 0; i--) {\n            if (!rows[i].classList.contains(literals.row) && !rows[i].classList.contains('e-detailrow')) {\n              grpRow = rows[i];\n              break;\n            }\n          }\n          this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ? '.e-recordplusexpand' : '.e-recordpluscollapse'));\n        }\n        break;\n      case 'ctrlDownArrow':\n        this.expandAll();\n        break;\n      case 'ctrlUpArrow':\n        this.collapseAll();\n        break;\n      case 'enter':\n        if (this.parent.isEdit || closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null) {\n          return;\n        }\n        // eslint-disable-next-line no-case-declarations\n        var element = this.focus.getFocusedElement();\n        // eslint-disable-next-line no-case-declarations\n        var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n        if (!row) {\n          break;\n        }\n        this.expandCollapseRows(row);\n        break;\n      case 'ctrlSpace':\n        // eslint-disable-next-line no-case-declarations\n        var elem = gObj.focusModule.currentInfo.element;\n        if (elem && elem.classList.contains('e-headercell')) {\n          var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n          if (column.field && gObj.groupSettings.columns.indexOf(column.field) < 0) {\n            this.groupColumn(column.field);\n          } else {\n            this.ungroupColumn(column.field);\n          }\n        }\n        break;\n    }\n  };\n  Group.prototype.clickHandler = function (e) {\n    this.expandCollapseRows(e.target);\n    this.applySortFromTarget(e.target);\n    this.unGroupFromTarget(e.target);\n    this.toogleGroupFromHeader(e.target);\n  };\n  Group.prototype.unGroupFromTarget = function (target) {\n    if (target.classList.contains('e-ungroupbutton')) {\n      this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n    }\n  };\n  Group.prototype.toogleGroupFromHeader = function (target) {\n    if (this.groupSettings.showToggleButton) {\n      if (target.classList.contains('e-grptogglebtn')) {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        } else {\n          this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n        }\n      } else {\n        if (target.classList.contains('e-toggleungroup')) {\n          this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n      }\n    }\n  };\n  Group.prototype.applySortFromTarget = function (target) {\n    var gObj = this.parent;\n    var gHeader = closest(target, '.e-groupheadercell');\n    if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') && !target.classList.contains('e-toggleungroup')) {\n      var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n      if (gObj.getColumnHeaderByField(field).getElementsByClassName('e-ascending').length) {\n        gObj.sortColumn(field, 'Descending', true);\n      } else {\n        gObj.sortColumn(field, 'Ascending', true);\n      }\n    }\n  };\n  /**\n   * Expands or collapses grouped rows by target element.\n   *\n   * @param  {Element} target - Defines the target element of the grouped row.\n   * @returns {void}\n   */\n  Group.prototype.expandCollapseRows = function (target) {\n    var trgt = parentsUntil(target, 'e-recordplusexpand') || parentsUntil(target, 'e-recordpluscollapse');\n    if (trgt) {\n      var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n      var isHide = void 0;\n      var dataManager = void 0;\n      var query = void 0;\n      var gObj = this.parent;\n      var indent = trgt.parentElement.getElementsByClassName('e-indentcell').length;\n      var uid = trgt.parentElement.getAttribute('data-uid');\n      var captionRow = gObj.getRowObjectFromUID(uid);\n      var expand = false;\n      if (trgt.classList.contains('e-recordpluscollapse')) {\n        addClass([trgt], 'e-recordplusexpand');\n        removeClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n        expand = true;\n        captionRow.isExpand = true;\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, expand, query, dataManager);\n        }\n        if (this.parent.groupSettings.enableLazyLoading) {\n          this.parent.contentModule.captionExpand(trgt.parentElement);\n        }\n      } else {\n        isHide = true;\n        captionRow.isExpand = false;\n        removeClass([trgt], 'e-recordplusexpand');\n        addClass([trgt], 'e-recordpluscollapse');\n        trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n        if (isGroupAdaptive(gObj)) {\n          this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n        }\n        if (this.parent.groupSettings.enableLazyLoading) {\n          this.parent.contentModule.captionCollapse(trgt.parentElement);\n        }\n      }\n      this.aria.setExpand(trgt, expand);\n      if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n        var rowObjs = gObj.getRowsObject();\n        var startIdx = rowObjs.indexOf(captionRow);\n        var rowsState = {};\n        for (var i = startIdx; i < rowObjs.length; i++) {\n          if (i > startIdx && rowObjs[i].indent === indent) {\n            break;\n          }\n          if (rowObjs[i].isDetailRow) {\n            var visible = rowObjs[i - 1].isExpand && rowObjs[i - 1].visible;\n            rowNodes[i].style.display = visible ? '' : 'none';\n          } else if (rowsState[rowObjs[i].parentUid] === false) {\n            rowObjs[i].visible = false;\n            rowNodes[i].style.display = 'none';\n          } else {\n            if (!(rowObjs[i].isDataRow || rowObjs[i].isCaptionRow || rowObjs[i].isDetailRow || rowObjs[i].isAggregateRow)) {\n              var visible = rowObjs[i].cells.some(function (cell) {\n                return cell.isDataCell && cell.visible;\n              });\n              if (visible === rowObjs[i].visible) {\n                continue;\n              }\n            }\n            rowObjs[i].visible = true;\n            rowNodes[i].style.display = '';\n            rowNodes[i].classList.remove('e-hide');\n          }\n          if (rowObjs[i].isCaptionRow) {\n            rowsState[rowObjs[i].uid] = rowObjs[i].isExpand && rowObjs[i].visible;\n          }\n        }\n        this.parent.notify(events.refreshExpandandCollapse, {\n          rows: this.parent.getRowsObject()\n        });\n      }\n      this.parent.notify(events.captionActionComplete, {\n        isCollapse: isHide,\n        parentUid: uid\n      });\n    }\n  };\n  Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n    var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n    rObj.isExpand = isExpand;\n    updatecloneRow(gObj);\n    this.parent.notify(events.refreshVirtualMaxPage, {});\n    query = gObj.getDataModule().generateQuery(false);\n    query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n    var args = {\n      requestType: 'virtualscroll',\n      rowObject: rObj\n    };\n    if (gObj.contentModule) {\n      args.virtualInfo = gObj.contentModule.prevInfo;\n    }\n    dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n    dataManager.then(function (e) {\n      return gObj.renderModule.dataManagerSuccess(e, args);\n    });\n  };\n  Group.prototype.expandCollapse = function (isExpand) {\n    if (!this.parent.groupSettings.columns.length) {\n      return;\n    }\n    if (!isExpand) {\n      this.parent.notify(events.initialCollapse, isExpand);\n    }\n    var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n    var rowObjs = this.parent.getRowsObject();\n    var row;\n    for (var i = 0, len = rowNodes.length; i < len; i++) {\n      if (rowNodes[i].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n        row = rowNodes[i].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n        if (row) {\n          row.className = isExpand ? 'e-recordplusexpand' : 'e-recordpluscollapse';\n          row.firstElementChild.className = isExpand ? 'e-icons e-gdiagonaldown e-icon-gdownarrow' : 'e-icons e-gnextforward e-icon-grightarrow';\n        }\n        if (!(rowNodes[i].firstElementChild.classList.contains('e-recordplusexpand') || rowNodes[i].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n          rowNodes[i].style.display = isExpand ? '' : 'none';\n        }\n      } else {\n        rowNodes[i].style.display = isExpand ? '' : 'none';\n      }\n      if (rowObjs[i].isCaptionRow) {\n        rowObjs[i].isExpand = isExpand ? true : false;\n      }\n    }\n    this.parent.updateVisibleExpandCollapseRows();\n    this.parent.notify(events.refreshExpandandCollapse, {\n      rows: this.parent.getRowsObject()\n    });\n  };\n  /**\n   * Expands all the grouped rows of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.expandAll = function () {\n    this.expandCollapse(true);\n  };\n  /**\n   * Collapses all the grouped rows of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.collapseAll = function () {\n    this.expandCollapse(false);\n  };\n  /**\n   * The function is used to render grouping\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.render = function () {\n    this.l10n = this.serviceLocator.getService('localization');\n    this.renderGroupDropArea();\n    this.initDragAndDrop();\n    this.refreshToggleBtn();\n  };\n  Group.prototype.renderGroupDropArea = function () {\n    var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n    if (groupElem) {\n      remove(groupElem);\n    }\n    this.element = this.parent.createElement('div', {\n      className: 'e-groupdroparea',\n      attrs: {\n        'tabindex': '-1'\n      }\n    });\n    if (this.groupSettings.allowReordering) {\n      this.element.classList.add('e-group-animate');\n    }\n    this.updateGroupDropArea();\n    this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n    if (!this.groupSettings.showDropArea) {\n      this.element.style.display = 'none';\n    }\n  };\n  Group.prototype.updateGroupDropArea = function (clear) {\n    if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n      var dragLabel = this.l10n.getConstant('GroupDropArea');\n      this.element.innerHTML = dragLabel;\n      this.element.classList.remove('e-grouped');\n    } else {\n      if (this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1 || !this.isAppliedGroup && !this.isAppliedUnGroup) || clear) {\n        this.element.innerHTML = '';\n      }\n      this.element.classList.add('e-grouped');\n    }\n  };\n  Group.prototype.initDragAndDrop = function () {\n    this.initializeGHeaderDrop();\n    this.initializeGHeaderDrag();\n  };\n  Group.prototype.initializeGHeaderDrag = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var drag = new Draggable(this.element, {\n      dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n      distance: this.groupSettings.allowReordering ? -10 : 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop\n    });\n  };\n  Group.prototype.initializeGHeaderDrop = function () {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    var drop = new Droppable(this.element, {\n      accept: '.e-dragclone',\n      drop: this.drop\n    });\n  };\n  /**\n   * Groups a column by column name.\n   *\n   * @param  {string} columnName - Defines the column name to group.\n   * @returns {void}\n   */\n  Group.prototype.groupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = gObj.getColumnByField(columnName);\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1) {\n      this.parent.log('action_disabled_column', {\n        moduleName: this.getModuleName(),\n        columnName: column.headerText\n      });\n      return;\n    }\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.groupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n    column.visible = gObj.groupSettings.showGroupedColumn;\n    this.colName = columnName;\n    this.isAppliedGroup = true;\n    if (this.contentRefresh) {\n      this.updateModel();\n    } else {\n      this.addColToGroupDrop(columnName);\n    }\n    this.updateGroupDropArea();\n    this.isAppliedGroup = false;\n  };\n  /**\n   * Ungroups a column by column name.\n   *\n   * @param  {string} columnName - Defines the column name to ungroup.\n   * @returns {void}\n   */\n  Group.prototype.ungroupColumn = function (columnName) {\n    var gObj = this.parent;\n    var column = this.parent.enableColumnVirtualization ? this.parent.columns.filter(function (c) {\n      return c.field === columnName;\n    })[0] : gObj.getColumnByField(columnName);\n    if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n      return;\n    }\n    if (isActionPrevent(gObj)) {\n      gObj.notify(events.preventBatch, {\n        instance: this,\n        handler: this.ungroupColumn,\n        arg1: columnName\n      });\n      return;\n    }\n    column.visible = true;\n    this.colName = column.field;\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns.splice(columns.indexOf(this.colName), 1);\n    if (this.sortedColumns.indexOf(columnName) < 0) {\n      for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n        if (columnName === gObj.sortSettings.columns[i].field) {\n          gObj.sortSettings.columns.splice(i, 1);\n          break;\n        }\n      }\n    }\n    if (this.groupSettings.allowReordering) {\n      this.reorderingColumns = columns;\n    }\n    this.groupSettings.columns = columns;\n    if (gObj.allowGrouping) {\n      this.isAppliedUnGroup = true;\n      this.parent.dataBind();\n    }\n  };\n  /**\n   * The function used to update groupSettings\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.updateModel = function () {\n    var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n    if (this.sortRequired) {\n      if (columns.indexOf(this.colName) === -1) {\n        columns.push(this.colName);\n      }\n      this.groupAddSortingQuery(this.colName);\n    }\n    this.sortRequired = true;\n    this.parent.groupSettings.columns = columns;\n    this.parent.dataBind();\n  };\n  /**\n   * The function used to trigger onActionComplete\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.onActionComplete = function (e) {\n    if (e.requestType === 'grouping') {\n      this.addColToGroupDrop(this.colName);\n    } else {\n      this.removeColFromGroupDrop(this.colName);\n    }\n    var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n      columnName: this.colName,\n      requestType: 'grouping',\n      type: events.actionComplete\n    } : {\n      requestType: 'ungrouping',\n      type: events.actionComplete\n    };\n    this.parent.trigger(events.actionComplete, extend(e, args));\n    this.colName = null;\n  };\n  Group.prototype.groupAddSortingQuery = function (colName) {\n    var i = 0;\n    while (i < this.parent.sortSettings.columns.length) {\n      if (this.parent.sortSettings.columns[i].field === colName) {\n        break;\n      }\n      i++;\n    }\n    if (this.parent.sortSettings.columns.length === i) {\n      this.parent.sortSettings.columns.push({\n        field: colName,\n        direction: 'Ascending',\n        isFromGroup: true\n      });\n    } else if (!this.parent.allowSorting) {\n      this.parent.sortSettings.columns[i].direction = 'Ascending';\n    }\n  };\n  Group.prototype.createElement = function (field) {\n    var gObj = this.parent;\n    var direction = 'Ascending';\n    var animator = this.parent.createElement('div', {\n      className: 'e-grid-icon e-group-animator'\n    });\n    var groupedColumn = this.parent.createElement('div', {\n      className: 'e-grid-icon e-groupheadercell'\n    });\n    var childDiv = this.parent.createElement('div', {\n      attrs: {\n        'ej-mappingname': field\n      }\n    });\n    if (isComplexField(field)) {\n      childDiv.setAttribute('ej-complexname', getComplexFieldID(field));\n    }\n    var column = this.parent.getColumnByField(field);\n    //Todo headerTemplateID for grouped column, disableHtmlEncode\n    var headerCell = gObj.getColumnHeaderByUid(column.uid);\n    // if (!isNullOrUndefined(column.headerTemplate)) {\n    //     if (column.headerTemplate.indexOf('#') !== -1) {\n    //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n    //     } else {\n    //         childDiv.innerHTML = column.headerTemplate;\n    //     }\n    //     childDiv.firstElementChild.classList.add('e-grouptext');\n    // } else {\n    if (this.groupSettings.allowReordering) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-drag e-icons e-icon-drag',\n        innerHTML: '&nbsp;',\n        attrs: {\n          title: 'Drag',\n          tabindex: '-1',\n          'aria-label': 'Drag the grouped column'\n        }\n      }));\n    }\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-grouptext',\n      innerHTML: column.headerText,\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'sort the grouped column'\n      }\n    }));\n    // }\n    if (this.groupSettings.showToggleButton) {\n      childDiv.appendChild(this.parent.createElement('span', {\n        className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup',\n        innerHTML: '&nbsp;',\n        attrs: {\n          tabindex: '-1',\n          'aria-label': 'ungroup button'\n        }\n      }));\n    }\n    if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n      direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n    }\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-groupsort e-icons ' + ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()),\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'sort the grouped column'\n      }\n    }));\n    childDiv.appendChild(this.parent.createElement('span', {\n      className: 'e-ungroupbutton e-icons e-icon-hide',\n      innerHTML: '&nbsp;',\n      attrs: {\n        title: this.l10n.getConstant('UnGroup'),\n        tabindex: '-1',\n        'aria-label': 'ungroup the grouped column'\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    }));\n    groupedColumn.appendChild(childDiv);\n    if (this.groupSettings.allowReordering) {\n      animator.appendChild(groupedColumn);\n      animator.appendChild(this.createSeparator());\n      groupedColumn = animator;\n    }\n    return groupedColumn;\n  };\n  Group.prototype.addColToGroupDrop = function (field) {\n    var groupElem = isComplexField(field) ? this.parent.element.querySelector('.e-groupdroparea div[ej-complexname=' + getComplexFieldID(field) + ']') : this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + field + ']');\n    if (this.groupSettings.allowReordering && groupElem) {\n      return;\n    }\n    var column = this.parent.getColumnByField(field);\n    if (isNullOrUndefined(column)) {\n      return;\n    }\n    var groupedColumn = this.createElement(field);\n    if (this.groupSettings.allowReordering) {\n      var index = this.element.getElementsByClassName('e-group-animator').length;\n      groupedColumn.setAttribute('index', index.toString());\n    }\n    this.element.appendChild(groupedColumn);\n    //Todo:  rtl\n  };\n\n  Group.prototype.createSeparator = function () {\n    return this.parent.createElement('span', {\n      className: 'e-nextgroup e-icons e-icon-next',\n      innerHTML: '&nbsp;',\n      attrs: {\n        tabindex: '-1',\n        'aria-label': 'Separator for the grouped columns'\n      },\n      styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n    });\n  };\n  Group.prototype.refreshToggleBtn = function (isRemove) {\n    if (this.groupSettings.showToggleButton) {\n      var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n      for (var i = 0, len = headers.length; i < len; i++) {\n        if (!(headers[i].classList.contains('e-emptycell') || headers[i].classList.contains('e-headerchkcelldiv'))) {\n          var column = this.parent.getColumnByUid(headers[i].getAttribute('e-mappinguid'));\n          if (!this.parent.showColumnMenu || this.parent.showColumnMenu && !column.showColumnMenu) {\n            if (headers[i].getElementsByClassName('e-grptogglebtn').length) {\n              remove(headers[i].querySelectorAll('.e-grptogglebtn')[0]);\n            }\n            if (!isRemove) {\n              headers[i].appendChild(this.parent.createElement('span', {\n                className: 'e-grptogglebtn e-icons ' + (this.groupSettings.columns.indexOf(column.field) > -1 ? 'e-toggleungroup e-icon-ungroup' : 'e-togglegroup e-icon-group'),\n                attrs: {\n                  tabindex: '-1',\n                  'aria-label': 'Group button'\n                }\n              }));\n            }\n          }\n        }\n      }\n    }\n  };\n  Group.prototype.removeColFromGroupDrop = function (field) {\n    if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n      var elem = this.getGHeaderCell(field);\n      if (this.groupSettings.allowReordering) {\n        var parent_1 = parentsUntil(elem, 'e-group-animator');\n        remove(parent_1);\n      } else {\n        remove(elem);\n      }\n      this.updateGroupDropArea();\n    }\n    this.isAppliedUnGroup = false;\n  };\n  Group.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n    for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n      var prop = _a[_i];\n      switch (prop) {\n        case 'columns':\n          // eslint-disable-next-line no-case-declarations\n          var args = void 0;\n          if (this.contentRefresh) {\n            if (!this.isAppliedUnGroup) {\n              if (!this.isAppliedGroup) {\n                this.updateGroupDropArea(true);\n                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                  if (this.parent.sortSettings.columns[j].isFromGroup) {\n                    this.parent.sortSettings.columns.splice(j, 1);\n                    j--;\n                  }\n                }\n                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                  this.colName = this.groupSettings.columns[i];\n                  var col = this.parent.getColumnByField(this.colName);\n                  col.visible = this.parent.groupSettings.showGroupedColumn;\n                  this.groupAddSortingQuery(this.colName);\n                  if (i < this.groupSettings.columns.length - 1) {\n                    this.addColToGroupDrop(this.groupSettings.columns[i]);\n                  }\n                }\n              }\n              args = {\n                columnName: this.colName,\n                requestType: e.properties[prop].length ? 'grouping' : 'ungrouping',\n                type: events.actionBegin\n              };\n            } else {\n              args = {\n                columnName: this.colName,\n                requestType: 'ungrouping',\n                type: events.actionBegin\n              };\n            }\n            if (!this.groupSettings.showGroupedColumn) {\n              var columns = e.oldProperties[prop];\n              for (var i = 0; i < columns.length; i++) {\n                if (e.properties[prop].indexOf(columns[i]) === -1) {\n                  this.parent.getColumnByField(columns[i]).visible = true;\n                }\n              }\n            }\n            this.parent.notify(events.modelChanged, args);\n          }\n          break;\n        case 'showDropArea':\n          this.updateGroupDropArea();\n          if (this.groupSettings.showDropArea) {\n            this.element.style.display = '';\n          } else {\n            this.element.style.display = 'none';\n          }\n          break;\n        case 'showGroupedColumn':\n          this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n          this.parent.notify(events.modelChanged, {\n            requestType: 'refresh'\n          });\n          break;\n        case 'showUngroupButton':\n          this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n          break;\n        case 'showToggleButton':\n          this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n          this.parent.refreshHeader();\n          break;\n        case 'enableLazyLoading':\n          this.parent.freezeRefresh();\n          break;\n      }\n    }\n  };\n  Group.prototype.updateGroupedColumn = function (isVisible) {\n    for (var i = 0; i < this.groupSettings.columns.length; i++) {\n      this.parent.getColumnByField(this.groupSettings.columns[i]).visible = isVisible;\n    }\n  };\n  Group.prototype.updateButtonVisibility = function (isVisible, className) {\n    var gHeader = [].slice.call(this.element.getElementsByClassName(className));\n    for (var i = 0; i < gHeader.length; i++) {\n      gHeader[i].style.display = isVisible ? '' : 'none';\n    }\n  };\n  Group.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.render();\n    }\n  };\n  /**\n   * To destroy the reorder\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Group.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    if ((this.parent.isDestroyed || !this.parent.allowGrouping) && !this.parent.refreshing) {\n      this.clearGrouping();\n    }\n    this.removeEventListener();\n    this.refreshToggleBtn(true);\n    if (this.element.parentNode) {\n      remove(this.element);\n    }\n    //call ejdrag and drop destroy\n  };\n  /**\n   * Clears all the grouped columns of the Grid.\n   *\n   * @returns {void}\n   */\n  Group.prototype.clearGrouping = function () {\n    var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n    this.contentRefresh = false;\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (i === len - 1) {\n        this.contentRefresh = true;\n      }\n      this.ungroupColumn(cols[i]);\n    }\n    this.contentRefresh = true;\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  Group.prototype.getModuleName = function () {\n    return 'group';\n  };\n  Group.prototype.refreshSortIcons = function () {\n    var gObj = this.parent;\n    var header;\n    var cols = gObj.sortSettings.columns;\n    var gCols = gObj.groupSettings.columns;\n    var fieldNames = this.parent.getColumns().map(function (c) {\n      return c.field;\n    });\n    this.refreshToggleBtn();\n    for (var i = 0, len = cols.length; i < len; i++) {\n      if (fieldNames.indexOf(cols[i].field) === -1) {\n        continue;\n      }\n      header = gObj.getColumnHeaderByField(cols[i].field);\n      if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[i].field) > -1 || this.groupSettings.columns.indexOf(cols[i].field) > -1)) {\n        classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n        if (cols.length > 1) {\n          header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', {\n            className: 'e-sortnumber',\n            innerHTML: (i + 1).toString()\n          }));\n        }\n      } else if (this.getGHeaderCell(cols[i].field) && this.getGHeaderCell(cols[i].field).getElementsByClassName('e-groupsort').length) {\n        if (cols[i].direction === 'Ascending') {\n          classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n        } else {\n          classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n        }\n      }\n    }\n    for (var i = 0, len = gCols.length; i < len; i++) {\n      if (fieldNames.indexOf(gCols[i]) === -1) {\n        continue;\n      }\n      gObj.getColumnHeaderByField(gCols[i]).setAttribute('aria-grouped', 'true');\n    }\n  };\n  Group.prototype.getGHeaderCell = function (field) {\n    if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n      return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n    }\n    return null;\n  };\n  Group.prototype.onGroupAggregates = function (editedData) {\n    var aggregates = this.iterateGroupAggregates(editedData);\n    var rowData = this.groupGenerator.generateRows(aggregates, {});\n    var summaryRows = this.parent.getRowsObject().filter(function (row) {\n      return !row.isDataRow;\n    });\n    var updateSummaryRows = rowData.filter(function (data) {\n      return !data.isDataRow;\n    });\n    if (this.parent.isReact || this.parent.isVue) {\n      this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n    }\n    for (var i = 0; i < updateSummaryRows.length; i++) {\n      var row = updateSummaryRows[i];\n      var cells = row.cells.filter(function (cell) {\n        return cell.isDataCell;\n      });\n      var args = {\n        cells: cells,\n        data: row.data,\n        dataUid: summaryRows[i] ? summaryRows[i].uid : ''\n      };\n      this.parent.notify(events.refreshAggregateCell, args);\n    }\n  };\n  Group.prototype.iterateGroupAggregates = function (editedData) {\n    var updatedData = editedData instanceof Array ? editedData : [];\n    var rows = this.parent.getRowsObject();\n    var initData = this.parent.getCurrentViewRecords();\n    var deletedCols = [];\n    var changeds = rows.map(function (row) {\n      if (row.edit === 'delete') {\n        deletedCols.push(row.data);\n      }\n      return row.changes instanceof Object ? row.changes : row.data;\n    });\n    var field = this.parent.getPrimaryKeyFieldNames()[0];\n    changeds = updatedData.length === 0 ? changeds : updatedData;\n    var mergeData = initData.map(function (item) {\n      var pKeyVal = DataUtil.getObject(field, item);\n      var value;\n      var hasVal = changeds.some(function (cItem) {\n        value = cItem;\n        return pKeyVal === DataUtil.getObject(field, cItem);\n      });\n      return hasVal ? value : item;\n    });\n    var eData = editedData;\n    if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n      for (var i = 0; i < deletedCols.length; i++) {\n        var index = mergeData.indexOf(deletedCols[i]);\n        mergeData.splice(index, 1);\n      }\n    }\n    var aggregates = [];\n    var aggregateRows = this.parent.aggregates;\n    for (var j = 0; j < aggregateRows.length; j++) {\n      var row = aggregateRows[j];\n      for (var k = 0; k < row.columns.length; k++) {\n        var aggr = {};\n        var type = row.columns[k].type.toString();\n        aggr = {\n          type: type.toLowerCase(),\n          field: row.columns[k].field\n        };\n        aggregates.push(aggr);\n      }\n    }\n    var result;\n    var aggrds;\n    var groupedCols = this.parent.groupSettings.columns;\n    for (var l = 0; l < groupedCols.length; l++) {\n      aggrds = result ? result : mergeData;\n      result = DataUtil.group(aggrds, groupedCols[l], aggregates, null, null);\n    }\n    return result;\n  };\n  Group.prototype.updateExpand = function (args) {\n    var uid = args.uid;\n    var isExpand = args.isExpand;\n    var rows = this.parent.getRowsObject();\n    for (var i = 0; i < rows.length; i++) {\n      var row = rows[i];\n      if (row.uid === uid || isNullOrUndefined(uid)) {\n        row.isExpand = isExpand;\n        var _loop_1 = function (j) {\n          var childRow = rows[j];\n          var closestParent = void 0;\n          if (childRow.parentUid !== row.uid) {\n            closestParent = rows.filter(function (x) {\n              return x.uid === childRow.parentUid;\n            })[0];\n          }\n          if (childRow.parentUid === row.uid) {\n            childRow.visible = row.isExpand;\n          } else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n            if (closestParent.isExpand && closestParent.visible === true) {\n              childRow.visible = true;\n            } else if (closestParent.isExpand && closestParent.visible === false) {\n              childRow.visible = false;\n            }\n          }\n          if (isNullOrUndefined(uid)) {\n            return \"break\";\n          }\n        };\n        for (var j = i + 1; j < rows.length; j++) {\n          var state_1 = _loop_1(j);\n          if (state_1 === \"break\") break;\n        }\n      }\n    }\n    this.parent.notify(events.contentReady, {\n      rows: rows,\n      args: {\n        isFrozen: false,\n        rows: rows\n      }\n    });\n  };\n  return Group;\n}();\nexport { Group };","map":{"version":3,"names":["Draggable","Droppable","createElement","closest","remove","classList","addClass","removeClass","isNullOrUndefined","extend","parentsUntil","isActionPrevent","isGroupAdaptive","updatecloneRow","getComplexFieldID","isComplexField","events","AriaService","GroupModelGenerator","DataUtil","literals","Group","parent","groupSettings","sortedColumns","serviceLocator","_this","sortRequired","isAppliedGroup","isAppliedUnGroup","reorderingColumns","visualElement","className","styles","attrs","action","helper","e","gObj","target","sender","element","contains","allowReordering","column","getColumnByField","firstElementChild","getAttribute","textContent","style","width","offsetWidth","height","offsetHeight","setAttribute","uid","appendChild","dragStart","add","drag","animateDropper","cloneElement","querySelector","trigger","columnDrag","draggableType","gridContent","dragStop","preventDrop","rearrangeGroup","field","getColumnByUid","columns","indexOf","ungroupColumn","dragField","dropTarget","grouped","slice","call","getElementsByClassName","map","cols","JSON","parse","stringify","dropField","dropIndex","dragIndex","splice","flag","push","innerHTML","length","c","addColToGroupDrop","addLabel","removeColFromGroupDrop","drop","droppedElement","aria","setDropTarget","setGrabbed","getHeaderTable","allowGrouping","getColumnHeaderByUid","log","moduleName","getModuleName","columnName","headerText","groupColumn","contentRefresh","focus","getService","addEventListener","groupGenerator","prototype","dragLabel","l10n","getConstant","updateModel","columnDragStart","dropArea","columnDrop","isDestroyed","on","uiUpdate","enableAfterRender","groupComplete","onActionComplete","ungroupComplete","inBoundModelChanged","onPropertyChanged","click","clickHandler","headerDrop","headerRefreshed","refreshSortIcons","sortComplete","keyPressed","keyPressHandler","contentReady","initialEnd","onEmpty","render","groupAggregates","onGroupAggregates","destroy","updateExpand","removeEventListener","off","getColumns","_i","_a","col","preventDefault","selected","allowSelection","getSelectedRowIndexes","rows","getContentTable","tbody","children","dataRow","getDataRows","grpRow","i","rowIndex","row","expandCollapseRows","expandAll","collapseAll","isEdit","id","getFocusedElement","parentElement","elem","focusModule","currentInfo","applySortFromTarget","unGroupFromTarget","toogleGroupFromHeader","showToggleButton","gHeader","allowSorting","getColumnHeaderByField","sortColumn","trgt","rowNodes","isHide","dataManager","query","indent","captionRow","getRowObjectFromUID","expand","isExpand","updateVirtualRows","enableLazyLoading","contentModule","captionExpand","captionCollapse","setExpand","rowObjs","getRowsObject","startIdx","rowsState","isDetailRow","visible","display","parentUid","isDataRow","isCaptionRow","isAggregateRow","cells","some","cell","isDataCell","notify","refreshExpandandCollapse","captionActionComplete","isCollapse","rObj","refreshVirtualMaxPage","getDataModule","generateQuery","queries","aggregateQuery","getQuery","clone","args","requestType","rowObject","virtualInfo","prevInfo","getData","requiresCount","then","renderModule","dataManagerSuccess","expandCollapse","initialCollapse","len","querySelectorAll","updateVisibleExpandCollapseRows","renderGroupDropArea","initDragAndDrop","refreshToggleBtn","groupElem","updateGroupDropArea","insertBefore","firstChild","showDropArea","clear","initializeGHeaderDrop","initializeGHeaderDrag","dragTarget","distance","accept","preventBatch","instance","handler","arg1","showGroupedColumn","colName","enableColumnVirtualization","filter","sortSettings","dataBind","groupAddSortingQuery","type","actionComplete","direction","isFromGroup","animator","groupedColumn","childDiv","headerCell","title","tabindex","toLowerCase","showUngroupButton","createSeparator","index","toString","isRemove","headers","showColumnMenu","getGHeaderCell","parent_1","module","Object","keys","properties","prop","j","actionBegin","oldProperties","modelChanged","updateGroupedColumn","updateButtonVisibility","refreshHeader","freezeRefresh","isVisible","enable","gridElement","gridHeader","refreshing","clearGrouping","parentNode","header","gCols","fieldNames","editedData","aggregates","iterateGroupAggregates","rowData","generateRows","summaryRows","updateSummaryRows","data","isReact","isVue","destroyTemplate","dataUid","refreshAggregateCell","updatedData","Array","initData","getCurrentViewRecords","deletedCols","changeds","edit","changes","getPrimaryKeyFieldNames","mergeData","item","pKeyVal","getObject","value","hasVal","cItem","eData","aggregateRows","k","aggr","result","aggrds","groupedCols","l","group","_loop_1","childRow","closestParent","x","state_1","isFrozen"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/actions/group.js"],"sourcesContent":["import { Draggable, Droppable } from '@syncfusion/ej2-base';\nimport { createElement, closest, remove, classList, addClass, removeClass } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, isActionPrevent, isGroupAdaptive, updatecloneRow, getComplexFieldID, isComplexField } from '../base/util';\nimport * as events from '../base/constant';\nimport { AriaService } from '../services/aria-service';\nimport { GroupModelGenerator } from '../services/group-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * The `Group` module is used to handle group action.\n */\nvar Group = /** @class */ (function () {\n    /**\n     * Constructor for Grid group module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {GroupSettingsModel} groupSettings - specifies the GroupSettingsModel\n     * @param {string[]} sortedColumns - specifies the sortedColumns\n     * @param {ServiceLocator} serviceLocator - specifies the serviceLocator\n     * @hidden\n     */\n    function Group(parent, groupSettings, sortedColumns, serviceLocator) {\n        var _this = this;\n        //Internal variables\n        this.sortRequired = true;\n        this.isAppliedGroup = false;\n        this.isAppliedUnGroup = false;\n        this.reorderingColumns = [];\n        this.visualElement = createElement('div', {\n            className: 'e-cloneproperties e-dragclone e-gdclone',\n            styles: 'line-height:23px', attrs: { action: 'grouping' }\n        });\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = e.sender.target;\n            var element = target.classList.contains('e-groupheadercell') ? target :\n                parentsUntil(target, 'e-groupheadercell');\n            if (!element || (!target.classList.contains('e-drag') && _this.groupSettings.allowReordering)) {\n                return false;\n            }\n            _this.column = gObj.getColumnByField(element.firstElementChild.getAttribute('ej-mappingname'));\n            _this.visualElement.textContent = element.textContent;\n            _this.visualElement.style.width = element.offsetWidth + 2 + 'px';\n            _this.visualElement.style.height = element.offsetHeight + 2 + 'px';\n            _this.visualElement.setAttribute('e-mappinguid', _this.column.uid);\n            gObj.element.appendChild(_this.visualElement);\n            return _this.visualElement;\n        };\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        this.dragStart = function (e) {\n            _this.parent.element.classList.add('e-ungroupdrag');\n        };\n        this.drag = function (e) {\n            if (_this.groupSettings.allowReordering) {\n                _this.animateDropper(e);\n            }\n            var target = e.target;\n            var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n            _this.parent.trigger(events.columnDrag, { target: target, draggableType: 'headercell', column: _this.column });\n            if (!_this.groupSettings.allowReordering) {\n                classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n                if (!(parentsUntil(target, literals.gridContent) || parentsUntil(target, 'e-headercell'))) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                }\n            }\n        };\n        this.dragStop = function (e) {\n            _this.parent.element.classList.remove('e-ungroupdrag');\n            var preventDrop = !(parentsUntil(e.target, literals.gridContent) || parentsUntil(e.target, 'e-gridheader'));\n            if (_this.groupSettings.allowReordering && preventDrop) {\n                remove(e.helper);\n                if (parentsUntil(e.target, 'e-groupdroparea')) {\n                    _this.rearrangeGroup();\n                }\n                else if (!(parentsUntil(e.target, 'e-grid'))) {\n                    var field = _this.parent.getColumnByUid(e.helper.getAttribute('e-mappinguid')).field;\n                    if (_this.groupSettings.columns.indexOf(field) !== -1) {\n                        _this.ungroupColumn(field);\n                    }\n                }\n                return;\n            }\n            else if (preventDrop) {\n                remove(e.helper);\n                return;\n            }\n        };\n        this.animateDropper = function (e) {\n            var uid = _this.parent.element.querySelector('.e-cloneproperties').getAttribute('e-mappinguid');\n            var dragField = _this.parent.getColumnByUid(uid).field;\n            var parent = parentsUntil(e.target, 'e-groupdroparea');\n            var dropTarget = parentsUntil(e.target, 'e-group-animator');\n            var grouped = [].slice.call(_this.element.getElementsByClassName('e-groupheadercell'))\n                .map(function (e) { return e.querySelector('div').getAttribute('ej-mappingname'); });\n            var cols = JSON.parse(JSON.stringify(grouped));\n            if (dropTarget || parent) {\n                if (dropTarget) {\n                    var dropField = dropTarget.querySelector('div[ej-mappingname]').getAttribute('ej-mappingname');\n                    var dropIndex = +(dropTarget.getAttribute('index'));\n                    if (dropField !== dragField) {\n                        var dragIndex = cols.indexOf(dragField);\n                        if (dragIndex !== -1) {\n                            cols.splice(dragIndex, 1);\n                        }\n                        var flag = dropIndex !== -1 && dragIndex === dropIndex;\n                        cols.splice(dropIndex + (flag ? 1 : 0), 0, dragField);\n                    }\n                }\n                else if (parent && cols.indexOf(dragField) === -1) {\n                    cols.push(dragField);\n                }\n                _this.element.innerHTML = '';\n                if (cols.length && !_this.element.classList.contains('e-grouped')) {\n                    _this.element.classList.add('e-grouped');\n                }\n                _this.reorderingColumns = cols;\n                for (var c = 0; c < cols.length; c++) {\n                    _this.addColToGroupDrop(cols[c]);\n                }\n            }\n            else {\n                _this.addLabel();\n                _this.removeColFromGroupDrop(dragField);\n            }\n        };\n        this.drop = function (e) {\n            var gObj = _this.parent;\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            _this.element.classList.remove('e-hover');\n            remove(e.droppedElement);\n            _this.aria.setDropTarget(_this.parent.element.querySelector('.e-groupdroparea'), false);\n            _this.aria.setGrabbed(_this.parent.getHeaderTable().querySelector('[aria-grabbed=true]'), false);\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                _this.parent.log('action_disabled_column', { moduleName: _this.getModuleName(), columnName: column.headerText });\n                return;\n            }\n            _this.groupColumn(column.field);\n        };\n        this.contentRefresh = true;\n        this.aria = new AriaService();\n        this.parent = parent;\n        this.groupSettings = groupSettings;\n        this.serviceLocator = serviceLocator;\n        this.sortedColumns = sortedColumns;\n        this.focus = serviceLocator.getService('focus');\n        this.addEventListener();\n        this.groupGenerator = new GroupModelGenerator(this.parent);\n    }\n    Group.prototype.addLabel = function () {\n        if (!this.element.getElementsByClassName('e-group-animator').length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n    };\n    Group.prototype.rearrangeGroup = function () {\n        this.sortRequired = false;\n        this.updateModel();\n    };\n    Group.prototype.columnDrag = function (e) {\n        if (this.groupSettings.allowReordering && e.column.allowGrouping) {\n            this.animateDropper(e);\n        }\n        var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n        classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur']);\n        if (!parentsUntil(e.target, 'e-groupdroparea') &&\n            !(this.parent.allowReordering && parentsUntil(e.target, 'e-headercell'))) {\n            classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        }\n        if (e.target.classList.contains('e-groupdroparea')) {\n            this.element.classList.add('e-hover');\n        }\n        else {\n            this.element.classList.remove('e-hover');\n        }\n    };\n    Group.prototype.columnDragStart = function (e) {\n        if (e.target.classList.contains('e-stackedheadercell')) {\n            return;\n        }\n        var dropArea = this.parent.element.querySelector('.e-groupdroparea');\n        this.aria.setDropTarget(dropArea, e.column.allowGrouping);\n        var element = e.target.classList.contains('e-headercell') ? e.target : parentsUntil(e.target, 'e-headercell');\n        this.aria.setGrabbed(element, true, !e.column.allowGrouping);\n    };\n    Group.prototype.columnDrop = function (e) {\n        var gObj = this.parent;\n        if (e.droppedElement.getAttribute('action') === 'grouping') {\n            var column = gObj.getColumnByUid(e.droppedElement.getAttribute('e-mappinguid'));\n            if (isNullOrUndefined(column) || column.allowGrouping === false ||\n                parentsUntil(gObj.getColumnHeaderByUid(column.uid), 'e-grid').getAttribute('id') !==\n                    gObj.element.getAttribute('id')) {\n                return;\n            }\n            this.ungroupColumn(column.field);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.groupComplete, this.onActionComplete, this);\n        this.parent.on(events.ungroupComplete, this.onActionComplete, this);\n        this.parent.on(events.inBoundModelChanged, this.onPropertyChanged, this);\n        this.parent.on(events.click, this.clickHandler, this);\n        this.parent.on(events.columnDrag, this.columnDrag, this);\n        this.parent.on(events.columnDragStart, this.columnDragStart, this);\n        this.parent.on(events.headerDrop, this.columnDrop, this);\n        this.parent.on(events.columnDrop, this.columnDrop, this);\n        this.parent.on(events.headerRefreshed, this.refreshSortIcons, this);\n        this.parent.on(events.sortComplete, this.refreshSortIcons, this);\n        this.parent.on(events.keyPressed, this.keyPressHandler, this);\n        this.parent.on(events.contentReady, this.initialEnd, this);\n        this.parent.on(events.onEmpty, this.initialEnd, this);\n        this.parent.on(events.initialEnd, this.render, this);\n        this.parent.on(events.groupAggregates, this.onGroupAggregates, this);\n        this.parent.on(events.destroy, this.destroy, this);\n        this.parent.on('group-expand-collapse', this.updateExpand, this);\n        this.parent.on('persist-data-changed', this.initialEnd, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(events.initialEnd, this.render);\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.groupComplete, this.onActionComplete);\n        this.parent.off(events.ungroupComplete, this.onActionComplete);\n        this.parent.off(events.inBoundModelChanged, this.onPropertyChanged);\n        this.parent.off(events.click, this.clickHandler);\n        this.parent.off(events.columnDrag, this.columnDrag);\n        this.parent.off(events.columnDragStart, this.columnDragStart);\n        this.parent.off(events.columnDrop, this.columnDrop);\n        this.parent.off(events.headerDrop, this.columnDrop);\n        this.parent.off(events.headerRefreshed, this.refreshSortIcons);\n        this.parent.off(events.sortComplete, this.refreshSortIcons);\n        this.parent.off(events.keyPressed, this.keyPressHandler);\n        this.parent.off(events.groupAggregates, this.onGroupAggregates);\n        this.parent.off(events.destroy, this.destroy);\n        this.parent.off('group-expand-collapse', this.updateExpand);\n    };\n    Group.prototype.initialEnd = function () {\n        var gObj = this.parent;\n        this.parent.off(events.contentReady, this.initialEnd);\n        this.parent.off(events.onEmpty, this.initialEnd);\n        if (this.parent.getColumns().length && this.groupSettings.columns.length) {\n            this.contentRefresh = false;\n            for (var _i = 0, _a = gObj.groupSettings.columns; _i < _a.length; _i++) {\n                var col = _a[_i];\n                this.groupColumn(col);\n            }\n            this.contentRefresh = true;\n        }\n    };\n    Group.prototype.keyPressHandler = function (e) {\n        var gObj = this.parent;\n        if (e.action !== 'ctrlSpace' && (!this.groupSettings.columns.length ||\n            ['altDownArrow', 'altUpArrow', 'ctrlDownArrow', 'ctrlUpArrow', 'enter'].indexOf(e.action) === -1)) {\n            return;\n        }\n        e.preventDefault();\n        switch (e.action) {\n            case 'altDownArrow':\n            case 'altUpArrow':\n                // eslint-disable-next-line no-case-declarations\n                var selected = gObj.allowSelection ? gObj.getSelectedRowIndexes() : [];\n                if (selected.length) {\n                    var rows = gObj.getContentTable().querySelector(literals.tbody).children;\n                    var dataRow = gObj.getDataRows()[selected[selected.length - 1]];\n                    var grpRow = void 0;\n                    for (var i = dataRow.rowIndex; i >= 0; i--) {\n                        if (!rows[i].classList.contains(literals.row) && !rows[i].classList.contains('e-detailrow')) {\n                            grpRow = rows[i];\n                            break;\n                        }\n                    }\n                    this.expandCollapseRows(grpRow.querySelector(e.action === 'altUpArrow' ?\n                        '.e-recordplusexpand' : '.e-recordpluscollapse'));\n                }\n                break;\n            case 'ctrlDownArrow':\n                this.expandAll();\n                break;\n            case 'ctrlUpArrow':\n                this.collapseAll();\n                break;\n            case 'enter':\n                if (this.parent.isEdit || (closest(e.target, '#' + this.parent.element.id + '_searchbar') !== null)) {\n                    return;\n                }\n                // eslint-disable-next-line no-case-declarations\n                var element = this.focus.getFocusedElement();\n                // eslint-disable-next-line no-case-declarations\n                var row = element ? element.parentElement.querySelector('[class^=\"e-record\"]') : null;\n                if (!row) {\n                    break;\n                }\n                this.expandCollapseRows(row);\n                break;\n            case 'ctrlSpace':\n                // eslint-disable-next-line no-case-declarations\n                var elem = gObj.focusModule.currentInfo.element;\n                if (elem && elem.classList.contains('e-headercell')) {\n                    var column = gObj.getColumnByUid(elem.firstElementChild.getAttribute('e-mappinguid'));\n                    if (column.field && gObj.groupSettings.columns.indexOf(column.field) < 0) {\n                        this.groupColumn(column.field);\n                    }\n                    else {\n                        this.ungroupColumn(column.field);\n                    }\n                }\n                break;\n        }\n    };\n    Group.prototype.clickHandler = function (e) {\n        this.expandCollapseRows(e.target);\n        this.applySortFromTarget(e.target);\n        this.unGroupFromTarget(e.target);\n        this.toogleGroupFromHeader(e.target);\n    };\n    Group.prototype.unGroupFromTarget = function (target) {\n        if (target.classList.contains('e-ungroupbutton')) {\n            this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n        }\n    };\n    Group.prototype.toogleGroupFromHeader = function (target) {\n        if (this.groupSettings.showToggleButton) {\n            if (target.classList.contains('e-grptogglebtn')) {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n                else {\n                    this.groupColumn(this.parent.getColumnByUid(target.parentElement.getAttribute('e-mappinguid')).field);\n                }\n            }\n            else {\n                if (target.classList.contains('e-toggleungroup')) {\n                    this.ungroupColumn(target.parentElement.getAttribute('ej-mappingname'));\n                }\n            }\n        }\n    };\n    Group.prototype.applySortFromTarget = function (target) {\n        var gObj = this.parent;\n        var gHeader = closest(target, '.e-groupheadercell');\n        if (gObj.allowSorting && gHeader && !target.classList.contains('e-ungroupbutton') &&\n            !target.classList.contains('e-toggleungroup')) {\n            var field = gHeader.firstElementChild.getAttribute('ej-mappingname');\n            if (gObj.getColumnHeaderByField(field).getElementsByClassName('e-ascending').length) {\n                gObj.sortColumn(field, 'Descending', true);\n            }\n            else {\n                gObj.sortColumn(field, 'Ascending', true);\n            }\n        }\n    };\n    /**\n     * Expands or collapses grouped rows by target element.\n     *\n     * @param  {Element} target - Defines the target element of the grouped row.\n     * @returns {void}\n     */\n    Group.prototype.expandCollapseRows = function (target) {\n        var trgt = parentsUntil(target, 'e-recordplusexpand') ||\n            parentsUntil(target, 'e-recordpluscollapse');\n        if (trgt) {\n            var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n            var isHide = void 0;\n            var dataManager = void 0;\n            var query = void 0;\n            var gObj = this.parent;\n            var indent = trgt.parentElement.getElementsByClassName('e-indentcell').length;\n            var uid = trgt.parentElement.getAttribute('data-uid');\n            var captionRow = gObj.getRowObjectFromUID(uid);\n            var expand = false;\n            if (trgt.classList.contains('e-recordpluscollapse')) {\n                addClass([trgt], 'e-recordplusexpand');\n                removeClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gdiagonaldown e-icon-gdownarrow';\n                expand = true;\n                captionRow.isExpand = true;\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, expand, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    this.parent.contentModule.captionExpand(trgt.parentElement);\n                }\n            }\n            else {\n                isHide = true;\n                captionRow.isExpand = false;\n                removeClass([trgt], 'e-recordplusexpand');\n                addClass([trgt], 'e-recordpluscollapse');\n                trgt.firstElementChild.className = 'e-icons e-gnextforward e-icon-grightarrow';\n                if (isGroupAdaptive(gObj)) {\n                    this.updateVirtualRows(gObj, target, !isHide, query, dataManager);\n                }\n                if (this.parent.groupSettings.enableLazyLoading) {\n                    this.parent.contentModule.captionCollapse(trgt.parentElement);\n                }\n            }\n            this.aria.setExpand(trgt, expand);\n            if (!isGroupAdaptive(gObj) && !this.parent.groupSettings.enableLazyLoading) {\n                var rowObjs = gObj.getRowsObject();\n                var startIdx = rowObjs.indexOf(captionRow);\n                var rowsState = {};\n                for (var i = startIdx; i < rowObjs.length; i++) {\n                    if (i > startIdx && rowObjs[i].indent === indent) {\n                        break;\n                    }\n                    if (rowObjs[i].isDetailRow) {\n                        var visible = rowObjs[i - 1].isExpand && rowObjs[i - 1].visible;\n                        rowNodes[i].style.display = visible ? '' : 'none';\n                    }\n                    else if (rowsState[rowObjs[i].parentUid] === false) {\n                        rowObjs[i].visible = false;\n                        rowNodes[i].style.display = 'none';\n                    }\n                    else {\n                        if (!(rowObjs[i].isDataRow || rowObjs[i].isCaptionRow || rowObjs[i].isDetailRow || rowObjs[i].isAggregateRow)) {\n                            var visible = rowObjs[i].cells.some(function (cell) { return cell.isDataCell\n                                && cell.visible; });\n                            if (visible === rowObjs[i].visible) {\n                                continue;\n                            }\n                        }\n                        rowObjs[i].visible = true;\n                        rowNodes[i].style.display = '';\n                        rowNodes[i].classList.remove('e-hide');\n                    }\n                    if (rowObjs[i].isCaptionRow) {\n                        rowsState[rowObjs[i].uid] = rowObjs[i].isExpand && rowObjs[i].visible;\n                    }\n                }\n                this.parent.notify(events.refreshExpandandCollapse, { rows: this.parent.getRowsObject() });\n            }\n            this.parent.notify(events.captionActionComplete, { isCollapse: isHide, parentUid: uid });\n        }\n    };\n    Group.prototype.updateVirtualRows = function (gObj, target, isExpand, query, dataManager) {\n        var rObj = gObj.getRowObjectFromUID(target.closest('tr').getAttribute('data-uid'));\n        rObj.isExpand = isExpand;\n        updatecloneRow(gObj);\n        this.parent.notify(events.refreshVirtualMaxPage, {});\n        query = gObj.getDataModule().generateQuery(false);\n        query.queries = gObj.getDataModule().aggregateQuery(gObj.getQuery().clone()).queries;\n        var args = { requestType: 'virtualscroll', rowObject: rObj };\n        if (gObj.contentModule) {\n            args.virtualInfo = gObj.contentModule.prevInfo;\n        }\n        dataManager = gObj.getDataModule().getData(args, query.requiresCount());\n        dataManager.then(function (e) { return gObj.renderModule.dataManagerSuccess(e, args); });\n    };\n    Group.prototype.expandCollapse = function (isExpand) {\n        if (!this.parent.groupSettings.columns.length) {\n            return;\n        }\n        if (!isExpand) {\n            this.parent.notify(events.initialCollapse, isExpand);\n        }\n        var rowNodes = this.parent.getContentTable().querySelector(literals.tbody).children;\n        var rowObjs = this.parent.getRowsObject();\n        var row;\n        for (var i = 0, len = rowNodes.length; i < len; i++) {\n            if (rowNodes[i].querySelectorAll('.e-recordplusexpand, .e-recordpluscollapse').length) {\n                row = rowNodes[i].querySelector(isExpand ? '.e-recordpluscollapse' : '.e-recordplusexpand');\n                if (row) {\n                    row.className = isExpand ? 'e-recordplusexpand' : 'e-recordpluscollapse';\n                    row.firstElementChild.className = isExpand ? 'e-icons e-gdiagonaldown e-icon-gdownarrow' :\n                        'e-icons e-gnextforward e-icon-grightarrow';\n                }\n                if (!(rowNodes[i].firstElementChild.classList.contains('e-recordplusexpand') ||\n                    rowNodes[i].firstElementChild.classList.contains('e-recordpluscollapse'))) {\n                    rowNodes[i].style.display = isExpand ? '' : 'none';\n                }\n            }\n            else {\n                rowNodes[i].style.display = isExpand ? '' : 'none';\n            }\n            if (rowObjs[i].isCaptionRow) {\n                rowObjs[i].isExpand = isExpand ? true : false;\n            }\n        }\n        this.parent.updateVisibleExpandCollapseRows();\n        this.parent.notify(events.refreshExpandandCollapse, { rows: this.parent.getRowsObject() });\n    };\n    /**\n     * Expands all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.expandAll = function () {\n        this.expandCollapse(true);\n    };\n    /**\n     * Collapses all the grouped rows of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.collapseAll = function () {\n        this.expandCollapse(false);\n    };\n    /**\n     * The function is used to render grouping\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.render = function () {\n        this.l10n = this.serviceLocator.getService('localization');\n        this.renderGroupDropArea();\n        this.initDragAndDrop();\n        this.refreshToggleBtn();\n    };\n    Group.prototype.renderGroupDropArea = function () {\n        var groupElem = this.parent.element.querySelector('.e-groupdroparea');\n        if (groupElem) {\n            remove(groupElem);\n        }\n        this.element = this.parent.createElement('div', { className: 'e-groupdroparea', attrs: { 'tabindex': '-1' } });\n        if (this.groupSettings.allowReordering) {\n            this.element.classList.add('e-group-animate');\n        }\n        this.updateGroupDropArea();\n        this.parent.element.insertBefore(this.element, this.parent.element.firstChild);\n        if (!this.groupSettings.showDropArea) {\n            this.element.style.display = 'none';\n        }\n    };\n    Group.prototype.updateGroupDropArea = function (clear) {\n        if (this.groupSettings.showDropArea && !this.groupSettings.columns.length) {\n            var dragLabel = this.l10n.getConstant('GroupDropArea');\n            this.element.innerHTML = dragLabel;\n            this.element.classList.remove('e-grouped');\n        }\n        else {\n            if ((this.element.innerHTML === this.l10n.getConstant('GroupDropArea') && (this.groupSettings.columns.length === 1\n                || !this.isAppliedGroup && !this.isAppliedUnGroup)) || clear) {\n                this.element.innerHTML = '';\n            }\n            this.element.classList.add('e-grouped');\n        }\n    };\n    Group.prototype.initDragAndDrop = function () {\n        this.initializeGHeaderDrop();\n        this.initializeGHeaderDrag();\n    };\n    Group.prototype.initializeGHeaderDrag = function () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var drag = new Draggable(this.element, {\n            dragTarget: this.groupSettings.allowReordering ? '.e-drag' : '.e-groupheadercell',\n            distance: this.groupSettings.allowReordering ? -10 : 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop\n        });\n    };\n    Group.prototype.initializeGHeaderDrop = function () {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        var drop = new Droppable(this.element, {\n            accept: '.e-dragclone',\n            drop: this.drop\n        });\n    };\n    /**\n     * Groups a column by column name.\n     *\n     * @param  {string} columnName - Defines the column name to group.\n     * @returns {void}\n     */\n    Group.prototype.groupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false ||\n            (this.contentRefresh && this.groupSettings.columns.indexOf(columnName) > -1)) {\n            this.parent.log('action_disabled_column', { moduleName: this.getModuleName(), columnName: column.headerText });\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.groupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = gObj.groupSettings.showGroupedColumn;\n        this.colName = columnName;\n        this.isAppliedGroup = true;\n        if (this.contentRefresh) {\n            this.updateModel();\n        }\n        else {\n            this.addColToGroupDrop(columnName);\n        }\n        this.updateGroupDropArea();\n        this.isAppliedGroup = false;\n    };\n    /**\n     * Ungroups a column by column name.\n     *\n     * @param  {string} columnName - Defines the column name to ungroup.\n     * @returns {void}\n     */\n    Group.prototype.ungroupColumn = function (columnName) {\n        var gObj = this.parent;\n        var column = this.parent.enableColumnVirtualization ?\n            this.parent.columns.filter(function (c) { return c.field === columnName; })[0] : gObj.getColumnByField(columnName);\n        if (isNullOrUndefined(column) || column.allowGrouping === false || this.groupSettings.columns.indexOf(columnName) < 0) {\n            return;\n        }\n        if (isActionPrevent(gObj)) {\n            gObj.notify(events.preventBatch, { instance: this, handler: this.ungroupColumn, arg1: columnName });\n            return;\n        }\n        column.visible = true;\n        this.colName = column.field;\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns.splice(columns.indexOf(this.colName), 1);\n        if (this.sortedColumns.indexOf(columnName) < 0) {\n            for (var i = 0, len = gObj.sortSettings.columns.length; i < len; i++) {\n                if (columnName === gObj.sortSettings.columns[i].field) {\n                    gObj.sortSettings.columns.splice(i, 1);\n                    break;\n                }\n            }\n        }\n        if (this.groupSettings.allowReordering) {\n            this.reorderingColumns = columns;\n        }\n        this.groupSettings.columns = columns;\n        if (gObj.allowGrouping) {\n            this.isAppliedUnGroup = true;\n            this.parent.dataBind();\n        }\n    };\n    /**\n     * The function used to update groupSettings\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.updateModel = function () {\n        var columns = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        columns = this.reorderingColumns.length ? JSON.parse(JSON.stringify(this.reorderingColumns)) : columns;\n        if (this.sortRequired) {\n            if (columns.indexOf(this.colName) === -1) {\n                columns.push(this.colName);\n            }\n            this.groupAddSortingQuery(this.colName);\n        }\n        this.sortRequired = true;\n        this.parent.groupSettings.columns = columns;\n        this.parent.dataBind();\n    };\n    /**\n     * The function used to trigger onActionComplete\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.onActionComplete = function (e) {\n        if (e.requestType === 'grouping') {\n            this.addColToGroupDrop(this.colName);\n        }\n        else {\n            this.removeColFromGroupDrop(this.colName);\n        }\n        var args = this.groupSettings.columns.indexOf(this.colName) > -1 ? {\n            columnName: this.colName, requestType: 'grouping', type: events.actionComplete\n        } : { requestType: 'ungrouping', type: events.actionComplete };\n        this.parent.trigger(events.actionComplete, extend(e, args));\n        this.colName = null;\n    };\n    Group.prototype.groupAddSortingQuery = function (colName) {\n        var i = 0;\n        while (i < this.parent.sortSettings.columns.length) {\n            if (this.parent.sortSettings.columns[i].field === colName) {\n                break;\n            }\n            i++;\n        }\n        if (this.parent.sortSettings.columns.length === i) {\n            this.parent.sortSettings.columns.push({ field: colName, direction: 'Ascending', isFromGroup: true });\n        }\n        else if (!this.parent.allowSorting) {\n            this.parent.sortSettings.columns[i].direction = 'Ascending';\n        }\n    };\n    Group.prototype.createElement = function (field) {\n        var gObj = this.parent;\n        var direction = 'Ascending';\n        var animator = this.parent.createElement('div', { className: 'e-grid-icon e-group-animator' });\n        var groupedColumn = this.parent.createElement('div', { className: 'e-grid-icon e-groupheadercell' });\n        var childDiv = this.parent.createElement('div', { attrs: { 'ej-mappingname': field } });\n        if (isComplexField(field)) {\n            childDiv.setAttribute('ej-complexname', getComplexFieldID(field));\n        }\n        var column = this.parent.getColumnByField(field);\n        //Todo headerTemplateID for grouped column, disableHtmlEncode\n        var headerCell = gObj.getColumnHeaderByUid(column.uid);\n        // if (!isNullOrUndefined(column.headerTemplate)) {\n        //     if (column.headerTemplate.indexOf('#') !== -1) {\n        //         childDiv.innerHTML = document.querySelector(column.headerTemplate).innerHTML.trim();\n        //     } else {\n        //         childDiv.innerHTML = column.headerTemplate;\n        //     }\n        //     childDiv.firstElementChild.classList.add('e-grouptext');\n        // } else {\n        if (this.groupSettings.allowReordering) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-drag e-icons e-icon-drag', innerHTML: '&nbsp;',\n                attrs: { title: 'Drag', tabindex: '-1', 'aria-label': 'Drag the grouped column' }\n            }));\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-grouptext', innerHTML: column.headerText,\n            attrs: { tabindex: '-1', 'aria-label': 'sort the grouped column' }\n        }));\n        // }\n        if (this.groupSettings.showToggleButton) {\n            childDiv.appendChild(this.parent.createElement('span', {\n                className: 'e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup', innerHTML: '&nbsp;',\n                attrs: { tabindex: '-1', 'aria-label': 'ungroup button' }\n            }));\n        }\n        if (headerCell.querySelectorAll('.e-ascending,.e-descending').length) {\n            direction = headerCell.querySelector('.e-ascending') ? 'Ascending' : 'Descending';\n        }\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-groupsort e-icons ' +\n                ('e-' + direction.toLowerCase() + ' e-icon-' + direction.toLowerCase()), innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': 'sort the grouped column' }\n        }));\n        childDiv.appendChild(this.parent.createElement('span', {\n            className: 'e-ungroupbutton e-icons e-icon-hide', innerHTML: '&nbsp;',\n            attrs: { title: this.l10n.getConstant('UnGroup'),\n                tabindex: '-1', 'aria-label': 'ungroup the grouped column' },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        }));\n        groupedColumn.appendChild(childDiv);\n        if (this.groupSettings.allowReordering) {\n            animator.appendChild(groupedColumn);\n            animator.appendChild(this.createSeparator());\n            groupedColumn = animator;\n        }\n        return groupedColumn;\n    };\n    Group.prototype.addColToGroupDrop = function (field) {\n        var groupElem = isComplexField(field) ? this.parent.element.querySelector('.e-groupdroparea div[ej-complexname=' +\n            getComplexFieldID(field) + ']') : this.parent.element.querySelector('.e-groupdroparea div[ej-mappingname=' + field + ']');\n        if (this.groupSettings.allowReordering && groupElem) {\n            return;\n        }\n        var column = this.parent.getColumnByField(field);\n        if (isNullOrUndefined(column)) {\n            return;\n        }\n        var groupedColumn = this.createElement(field);\n        if (this.groupSettings.allowReordering) {\n            var index = this.element.getElementsByClassName('e-group-animator').length;\n            groupedColumn.setAttribute('index', index.toString());\n        }\n        this.element.appendChild(groupedColumn);\n        //Todo:  rtl\n    };\n    Group.prototype.createSeparator = function () {\n        return this.parent.createElement('span', {\n            className: 'e-nextgroup e-icons e-icon-next', innerHTML: '&nbsp;',\n            attrs: { tabindex: '-1', 'aria-label': 'Separator for the grouped columns' },\n            styles: this.groupSettings.showUngroupButton ? '' : 'display:none'\n        });\n    };\n    Group.prototype.refreshToggleBtn = function (isRemove) {\n        if (this.groupSettings.showToggleButton) {\n            var headers = [].slice.call(this.parent.getHeaderTable().getElementsByClassName('e-headercelldiv'));\n            for (var i = 0, len = headers.length; i < len; i++) {\n                if (!((headers[i].classList.contains('e-emptycell')) || (headers[i].classList.contains('e-headerchkcelldiv')))) {\n                    var column = this.parent.getColumnByUid(headers[i].getAttribute('e-mappinguid'));\n                    if (!this.parent.showColumnMenu || (this.parent.showColumnMenu && !column.showColumnMenu)) {\n                        if (headers[i].getElementsByClassName('e-grptogglebtn').length) {\n                            remove(headers[i].querySelectorAll('.e-grptogglebtn')[0]);\n                        }\n                        if (!isRemove) {\n                            headers[i].appendChild(this.parent.createElement('span', {\n                                className: 'e-grptogglebtn e-icons ' +\n                                    (this.groupSettings.columns.indexOf(column.field) > -1 ? 'e-toggleungroup e-icon-ungroup'\n                                        : 'e-togglegroup e-icon-group'), attrs: { tabindex: '-1', 'aria-label': 'Group button' }\n                            }));\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Group.prototype.removeColFromGroupDrop = function (field) {\n        if (!isNullOrUndefined(this.getGHeaderCell(field))) {\n            var elem = this.getGHeaderCell(field);\n            if (this.groupSettings.allowReordering) {\n                var parent_1 = parentsUntil(elem, 'e-group-animator');\n                remove(parent_1);\n            }\n            else {\n                remove(elem);\n            }\n            this.updateGroupDropArea();\n        }\n        this.isAppliedUnGroup = false;\n    };\n    Group.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        for (var _i = 0, _a = Object.keys(e.properties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'columns':\n                    // eslint-disable-next-line no-case-declarations\n                    var args = void 0;\n                    if (this.contentRefresh) {\n                        if (!this.isAppliedUnGroup) {\n                            if (!this.isAppliedGroup) {\n                                this.updateGroupDropArea(true);\n                                for (var j = 0; j < this.parent.sortSettings.columns.length; j++) {\n                                    if (this.parent.sortSettings.columns[j].isFromGroup) {\n                                        this.parent.sortSettings.columns.splice(j, 1);\n                                        j--;\n                                    }\n                                }\n                                for (var i = 0; i < this.groupSettings.columns.length; i++) {\n                                    this.colName = this.groupSettings.columns[i];\n                                    var col = this.parent.getColumnByField(this.colName);\n                                    col.visible = this.parent.groupSettings.showGroupedColumn;\n                                    this.groupAddSortingQuery(this.colName);\n                                    if (i < this.groupSettings.columns.length - 1) {\n                                        this.addColToGroupDrop(this.groupSettings.columns[i]);\n                                    }\n                                }\n                            }\n                            args = {\n                                columnName: this.colName, requestType: e.properties[prop].length ? 'grouping' : 'ungrouping',\n                                type: events.actionBegin\n                            };\n                        }\n                        else {\n                            args = { columnName: this.colName, requestType: 'ungrouping', type: events.actionBegin };\n                        }\n                        if (!this.groupSettings.showGroupedColumn) {\n                            var columns = e.oldProperties[prop];\n                            for (var i = 0; i < columns.length; i++) {\n                                if (e.properties[prop].indexOf(columns[i]) === -1) {\n                                    this.parent.getColumnByField(columns[i]).visible = true;\n                                }\n                            }\n                        }\n                        this.parent.notify(events.modelChanged, args);\n                    }\n                    break;\n                case 'showDropArea':\n                    this.updateGroupDropArea();\n                    if (this.groupSettings.showDropArea) {\n                        this.element.style.display = '';\n                    }\n                    else {\n                        this.element.style.display = 'none';\n                    }\n                    break;\n                case 'showGroupedColumn':\n                    this.updateGroupedColumn(this.groupSettings.showGroupedColumn);\n                    this.parent.notify(events.modelChanged, { requestType: 'refresh' });\n                    break;\n                case 'showUngroupButton':\n                    this.updateButtonVisibility(this.groupSettings.showUngroupButton, 'e-ungroupbutton');\n                    break;\n                case 'showToggleButton':\n                    this.updateButtonVisibility(this.groupSettings.showToggleButton, 'e-togglegroupbutton ');\n                    this.parent.refreshHeader();\n                    break;\n                case 'enableLazyLoading':\n                    this.parent.freezeRefresh();\n                    break;\n            }\n        }\n    };\n    Group.prototype.updateGroupedColumn = function (isVisible) {\n        for (var i = 0; i < this.groupSettings.columns.length; i++) {\n            this.parent.getColumnByField(this.groupSettings.columns[i]).visible = isVisible;\n        }\n    };\n    Group.prototype.updateButtonVisibility = function (isVisible, className) {\n        var gHeader = [].slice.call(this.element.getElementsByClassName(className));\n        for (var i = 0; i < gHeader.length; i++) {\n            gHeader[i].style.display = isVisible ? '' : 'none';\n        }\n    };\n    Group.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.render();\n        }\n    };\n    /**\n     * To destroy the reorder\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Group.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        if ((this.parent.isDestroyed || !this.parent.allowGrouping) && !this.parent.refreshing) {\n            this.clearGrouping();\n        }\n        this.removeEventListener();\n        this.refreshToggleBtn(true);\n        if (this.element.parentNode) {\n            remove(this.element);\n        }\n        //call ejdrag and drop destroy\n    };\n    /**\n     * Clears all the grouped columns of the Grid.\n     *\n     * @returns {void}\n     */\n    Group.prototype.clearGrouping = function () {\n        var cols = JSON.parse(JSON.stringify(this.groupSettings.columns));\n        this.contentRefresh = false;\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (i === (len - 1)) {\n                this.contentRefresh = true;\n            }\n            this.ungroupColumn(cols[i]);\n        }\n        this.contentRefresh = true;\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Group.prototype.getModuleName = function () {\n        return 'group';\n    };\n    Group.prototype.refreshSortIcons = function () {\n        var gObj = this.parent;\n        var header;\n        var cols = gObj.sortSettings.columns;\n        var gCols = gObj.groupSettings.columns;\n        var fieldNames = this.parent.getColumns().map(function (c) { return c.field; });\n        this.refreshToggleBtn();\n        for (var i = 0, len = cols.length; i < len; i++) {\n            if (fieldNames.indexOf(cols[i].field) === -1) {\n                continue;\n            }\n            header = gObj.getColumnHeaderByField(cols[i].field);\n            if (!gObj.allowSorting && (this.sortedColumns.indexOf(cols[i].field) > -1 ||\n                this.groupSettings.columns.indexOf(cols[i].field) > -1)) {\n                classList(header.querySelector('.e-sortfilterdiv'), ['e-ascending', 'e-icon-ascending'], []);\n                if (cols.length > 1) {\n                    header.querySelector('.e-headercelldiv').appendChild(this.parent.createElement('span', { className: 'e-sortnumber', innerHTML: (i + 1).toString() }));\n                }\n            }\n            else if (this.getGHeaderCell(cols[i].field) && this.getGHeaderCell(cols[i].field).getElementsByClassName('e-groupsort').length) {\n                if (cols[i].direction === 'Ascending') {\n                    classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-ascending', 'e-icon-ascending'], ['e-descending', 'e-icon-descending']);\n                }\n                else {\n                    classList(this.getGHeaderCell(cols[i].field).querySelector('.e-groupsort'), ['e-descending', 'e-icon-descending'], ['e-ascending', 'e-icon-ascending']);\n                }\n            }\n        }\n        for (var i = 0, len = gCols.length; i < len; i++) {\n            if (fieldNames.indexOf(gCols[i]) === -1) {\n                continue;\n            }\n            gObj.getColumnHeaderByField(gCols[i]).setAttribute('aria-grouped', 'true');\n        }\n    };\n    Group.prototype.getGHeaderCell = function (field) {\n        if (this.element && this.element.querySelector('[ej-mappingname=\"' + field + '\"]')) {\n            return this.element.querySelector('[ej-mappingname=\"' + field + '\"]').parentElement;\n        }\n        return null;\n    };\n    Group.prototype.onGroupAggregates = function (editedData) {\n        var aggregates = this.iterateGroupAggregates(editedData);\n        var rowData = this.groupGenerator.generateRows(aggregates, {});\n        var summaryRows = this.parent.getRowsObject().filter(function (row) { return !row.isDataRow; });\n        var updateSummaryRows = rowData.filter(function (data) { return !data.isDataRow; });\n        if (this.parent.isReact || this.parent.isVue) {\n            this.parent.destroyTemplate(['groupFooterTemplate', 'groupCaptionTemplate', 'footerTemplate']);\n        }\n        for (var i = 0; i < updateSummaryRows.length; i++) {\n            var row = updateSummaryRows[i];\n            var cells = row.cells.filter(function (cell) { return cell.isDataCell; });\n            var args = { cells: cells, data: row.data, dataUid: summaryRows[i] ? summaryRows[i].uid : '' };\n            this.parent.notify(events.refreshAggregateCell, args);\n        }\n    };\n    Group.prototype.iterateGroupAggregates = function (editedData) {\n        var updatedData = editedData instanceof Array ? editedData : [];\n        var rows = this.parent.getRowsObject();\n        var initData = this.parent.getCurrentViewRecords();\n        var deletedCols = [];\n        var changeds = rows.map(function (row) {\n            if (row.edit === 'delete') {\n                deletedCols.push(row.data);\n            }\n            return row.changes instanceof Object ? row.changes : row.data;\n        });\n        var field = this.parent.getPrimaryKeyFieldNames()[0];\n        changeds = updatedData.length === 0 ? changeds : updatedData;\n        var mergeData = initData.map(function (item) {\n            var pKeyVal = DataUtil.getObject(field, item);\n            var value;\n            var hasVal = changeds.some(function (cItem) {\n                value = cItem;\n                return pKeyVal === DataUtil.getObject(field, cItem);\n            });\n            return hasVal ? value : item;\n        });\n        var eData = editedData;\n        if (!(eData.type && eData.type === 'cancel') && deletedCols.length > 0) {\n            for (var i = 0; i < deletedCols.length; i++) {\n                var index = mergeData.indexOf(deletedCols[i]);\n                mergeData.splice(index, 1);\n            }\n        }\n        var aggregates = [];\n        var aggregateRows = this.parent.aggregates;\n        for (var j = 0; j < aggregateRows.length; j++) {\n            var row = aggregateRows[j];\n            for (var k = 0; k < row.columns.length; k++) {\n                var aggr = {};\n                var type = row.columns[k].type.toString();\n                aggr = { type: type.toLowerCase(), field: row.columns[k].field };\n                aggregates.push(aggr);\n            }\n        }\n        var result;\n        var aggrds;\n        var groupedCols = this.parent.groupSettings.columns;\n        for (var l = 0; l < groupedCols.length; l++) {\n            aggrds = result ? result : mergeData;\n            result = DataUtil.group(aggrds, groupedCols[l], aggregates, null, null);\n        }\n        return result;\n    };\n    Group.prototype.updateExpand = function (args) {\n        var uid = args.uid;\n        var isExpand = args.isExpand;\n        var rows = this.parent.getRowsObject();\n        for (var i = 0; i < rows.length; i++) {\n            var row = rows[i];\n            if (row.uid === uid || isNullOrUndefined(uid)) {\n                row.isExpand = isExpand;\n                var _loop_1 = function (j) {\n                    var childRow = rows[j];\n                    var closestParent = void 0;\n                    if (childRow.parentUid !== row.uid) {\n                        closestParent = rows.filter(function (x) { return x.uid === childRow.parentUid; })[0];\n                    }\n                    if (childRow.parentUid === row.uid) {\n                        childRow.visible = row.isExpand;\n                    }\n                    else if (!isNullOrUndefined(closestParent) && childRow.parentUid === closestParent.uid) {\n                        if (closestParent.isExpand && closestParent.visible === true) {\n                            childRow.visible = true;\n                        }\n                        else if (closestParent.isExpand && closestParent.visible === false) {\n                            childRow.visible = false;\n                        }\n                    }\n                    if (isNullOrUndefined(uid)) {\n                        return \"break\";\n                    }\n                };\n                for (var j = i + 1; j < rows.length; j++) {\n                    var state_1 = _loop_1(j);\n                    if (state_1 === \"break\")\n                        break;\n                }\n            }\n        }\n        this.parent.notify(events.contentReady, { rows: rows, args: { isFrozen: false, rows: rows } });\n    };\n    return Group;\n}());\nexport { Group };\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,SAAS,QAAQ,sBAAsB;AAC3D,SAASC,aAAa,EAAEC,OAAO,EAAEC,MAAM,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,WAAW,QAAQ,sBAAsB;AACvG,SAASC,iBAAiB,EAAEC,MAAM,QAAQ,sBAAsB;AAChE,SAASC,YAAY,EAAEC,eAAe,EAAEC,eAAe,EAAEC,cAAc,EAAEC,iBAAiB,EAAEC,cAAc,QAAQ,cAAc;AAChI,OAAO,KAAKC,MAAM,MAAM,kBAAkB;AAC1C,SAASC,WAAW,QAAQ,0BAA0B;AACtD,SAASC,mBAAmB,QAAQ,mCAAmC;AACvE,SAASC,QAAQ,QAAQ,sBAAsB;AAC/C,OAAO,KAAKC,QAAQ,MAAM,yBAAyB;AACnD;AACA;AACA;AACA;AACA;AACA,IAAIC,KAAK,GAAG,aAAe,YAAY;EACnC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACI,SAASA,KAAKA,CAACC,MAAM,EAAEC,aAAa,EAAEC,aAAa,EAAEC,cAAc,EAAE;IACjE,IAAIC,KAAK,GAAG,IAAI;IAChB;IACA,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,cAAc,GAAG,KAAK;IAC3B,IAAI,CAACC,gBAAgB,GAAG,KAAK;IAC7B,IAAI,CAACC,iBAAiB,GAAG,EAAE;IAC3B,IAAI,CAACC,aAAa,GAAG7B,aAAa,CAAC,KAAK,EAAE;MACtC8B,SAAS,EAAE,yCAAyC;MACpDC,MAAM,EAAE,kBAAkB;MAAEC,KAAK,EAAE;QAAEC,MAAM,EAAE;MAAW;IAC5D,CAAC,CAAC;IACF,IAAI,CAACC,MAAM,GAAG,UAAUC,CAAC,EAAE;MACvB,IAAIC,IAAI,GAAGZ,KAAK,CAACJ,MAAM;MACvB,IAAIiB,MAAM,GAAGF,CAAC,CAACG,MAAM,CAACD,MAAM;MAC5B,IAAIE,OAAO,GAAGF,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,mBAAmB,CAAC,GAAGH,MAAM,GACjE7B,YAAY,CAAC6B,MAAM,EAAE,mBAAmB,CAAC;MAC7C,IAAI,CAACE,OAAO,IAAK,CAACF,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,QAAQ,CAAC,IAAIhB,KAAK,CAACH,aAAa,CAACoB,eAAgB,EAAE;QAC3F,OAAO,KAAK;MAChB;MACAjB,KAAK,CAACkB,MAAM,GAAGN,IAAI,CAACO,gBAAgB,CAACJ,OAAO,CAACK,iBAAiB,CAACC,YAAY,CAAC,gBAAgB,CAAC,CAAC;MAC9FrB,KAAK,CAACK,aAAa,CAACiB,WAAW,GAAGP,OAAO,CAACO,WAAW;MACrDtB,KAAK,CAACK,aAAa,CAACkB,KAAK,CAACC,KAAK,GAAGT,OAAO,CAACU,WAAW,GAAG,CAAC,GAAG,IAAI;MAChEzB,KAAK,CAACK,aAAa,CAACkB,KAAK,CAACG,MAAM,GAAGX,OAAO,CAACY,YAAY,GAAG,CAAC,GAAG,IAAI;MAClE3B,KAAK,CAACK,aAAa,CAACuB,YAAY,CAAC,cAAc,EAAE5B,KAAK,CAACkB,MAAM,CAACW,GAAG,CAAC;MAClEjB,IAAI,CAACG,OAAO,CAACe,WAAW,CAAC9B,KAAK,CAACK,aAAa,CAAC;MAC7C,OAAOL,KAAK,CAACK,aAAa;IAC9B,CAAC;IACD;IACA,IAAI,CAAC0B,SAAS,GAAG,UAAUpB,CAAC,EAAE;MAC1BX,KAAK,CAACJ,MAAM,CAACmB,OAAO,CAACpC,SAAS,CAACqD,GAAG,CAAC,eAAe,CAAC;IACvD,CAAC;IACD,IAAI,CAACC,IAAI,GAAG,UAAUtB,CAAC,EAAE;MACrB,IAAIX,KAAK,CAACH,aAAa,CAACoB,eAAe,EAAE;QACrCjB,KAAK,CAACkC,cAAc,CAACvB,CAAC,CAAC;MAC3B;MACA,IAAIE,MAAM,GAAGF,CAAC,CAACE,MAAM;MACrB,IAAIsB,YAAY,GAAGnC,KAAK,CAACJ,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,oBAAoB,CAAC;MAC3EpC,KAAK,CAACJ,MAAM,CAACyC,OAAO,CAAC/C,MAAM,CAACgD,UAAU,EAAE;QAAEzB,MAAM,EAAEA,MAAM;QAAE0B,aAAa,EAAE,YAAY;QAAErB,MAAM,EAAElB,KAAK,CAACkB;MAAO,CAAC,CAAC;MAC9G,IAAI,CAAClB,KAAK,CAACH,aAAa,CAACoB,eAAe,EAAE;QACtCtC,SAAS,CAACwD,YAAY,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,iBAAiB,CAAC,CAAC;QAC9D,IAAI,EAAEnD,YAAY,CAAC6B,MAAM,EAAEnB,QAAQ,CAAC8C,WAAW,CAAC,IAAIxD,YAAY,CAAC6B,MAAM,EAAE,cAAc,CAAC,CAAC,EAAE;UACvFlC,SAAS,CAACwD,YAAY,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,cAAc,CAAC,CAAC;QAClE;MACJ;IACJ,CAAC;IACD,IAAI,CAACM,QAAQ,GAAG,UAAU9B,CAAC,EAAE;MACzBX,KAAK,CAACJ,MAAM,CAACmB,OAAO,CAACpC,SAAS,CAACD,MAAM,CAAC,eAAe,CAAC;MACtD,IAAIgE,WAAW,GAAG,EAAE1D,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAEnB,QAAQ,CAAC8C,WAAW,CAAC,IAAIxD,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,cAAc,CAAC,CAAC;MAC3G,IAAIb,KAAK,CAACH,aAAa,CAACoB,eAAe,IAAIyB,WAAW,EAAE;QACpDhE,MAAM,CAACiC,CAAC,CAACD,MAAM,CAAC;QAChB,IAAI1B,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,iBAAiB,CAAC,EAAE;UAC3Cb,KAAK,CAAC2C,cAAc,CAAC,CAAC;QAC1B,CAAC,MACI,IAAI,CAAE3D,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,QAAQ,CAAE,EAAE;UAC1C,IAAI+B,KAAK,GAAG5C,KAAK,CAACJ,MAAM,CAACiD,cAAc,CAAClC,CAAC,CAACD,MAAM,CAACW,YAAY,CAAC,cAAc,CAAC,CAAC,CAACuB,KAAK;UACpF,IAAI5C,KAAK,CAACH,aAAa,CAACiD,OAAO,CAACC,OAAO,CAACH,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE;YACnD5C,KAAK,CAACgD,aAAa,CAACJ,KAAK,CAAC;UAC9B;QACJ;QACA;MACJ,CAAC,MACI,IAAIF,WAAW,EAAE;QAClBhE,MAAM,CAACiC,CAAC,CAACD,MAAM,CAAC;QAChB;MACJ;IACJ,CAAC;IACD,IAAI,CAACwB,cAAc,GAAG,UAAUvB,CAAC,EAAE;MAC/B,IAAIkB,GAAG,GAAG7B,KAAK,CAACJ,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,oBAAoB,CAAC,CAACf,YAAY,CAAC,cAAc,CAAC;MAC/F,IAAI4B,SAAS,GAAGjD,KAAK,CAACJ,MAAM,CAACiD,cAAc,CAAChB,GAAG,CAAC,CAACe,KAAK;MACtD,IAAIhD,MAAM,GAAGZ,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,iBAAiB,CAAC;MACtD,IAAIqC,UAAU,GAAGlE,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,kBAAkB,CAAC;MAC3D,IAAIsC,OAAO,GAAG,EAAE,CAACC,KAAK,CAACC,IAAI,CAACrD,KAAK,CAACe,OAAO,CAACuC,sBAAsB,CAAC,mBAAmB,CAAC,CAAC,CACjFC,GAAG,CAAC,UAAU5C,CAAC,EAAE;QAAE,OAAOA,CAAC,CAACyB,aAAa,CAAC,KAAK,CAAC,CAACf,YAAY,CAAC,gBAAgB,CAAC;MAAE,CAAC,CAAC;MACxF,IAAImC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAACR,OAAO,CAAC,CAAC;MAC9C,IAAID,UAAU,IAAItD,MAAM,EAAE;QACtB,IAAIsD,UAAU,EAAE;UACZ,IAAIU,SAAS,GAAGV,UAAU,CAACd,aAAa,CAAC,qBAAqB,CAAC,CAACf,YAAY,CAAC,gBAAgB,CAAC;UAC9F,IAAIwC,SAAS,GAAG,CAAEX,UAAU,CAAC7B,YAAY,CAAC,OAAO,CAAE;UACnD,IAAIuC,SAAS,KAAKX,SAAS,EAAE;YACzB,IAAIa,SAAS,GAAGN,IAAI,CAACT,OAAO,CAACE,SAAS,CAAC;YACvC,IAAIa,SAAS,KAAK,CAAC,CAAC,EAAE;cAClBN,IAAI,CAACO,MAAM,CAACD,SAAS,EAAE,CAAC,CAAC;YAC7B;YACA,IAAIE,IAAI,GAAGH,SAAS,KAAK,CAAC,CAAC,IAAIC,SAAS,KAAKD,SAAS;YACtDL,IAAI,CAACO,MAAM,CAACF,SAAS,IAAIG,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE,CAAC,EAAEf,SAAS,CAAC;UACzD;QACJ,CAAC,MACI,IAAIrD,MAAM,IAAI4D,IAAI,CAACT,OAAO,CAACE,SAAS,CAAC,KAAK,CAAC,CAAC,EAAE;UAC/CO,IAAI,CAACS,IAAI,CAAChB,SAAS,CAAC;QACxB;QACAjD,KAAK,CAACe,OAAO,CAACmD,SAAS,GAAG,EAAE;QAC5B,IAAIV,IAAI,CAACW,MAAM,IAAI,CAACnE,KAAK,CAACe,OAAO,CAACpC,SAAS,CAACqC,QAAQ,CAAC,WAAW,CAAC,EAAE;UAC/DhB,KAAK,CAACe,OAAO,CAACpC,SAAS,CAACqD,GAAG,CAAC,WAAW,CAAC;QAC5C;QACAhC,KAAK,CAACI,iBAAiB,GAAGoD,IAAI;QAC9B,KAAK,IAAIY,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGZ,IAAI,CAACW,MAAM,EAAEC,CAAC,EAAE,EAAE;UAClCpE,KAAK,CAACqE,iBAAiB,CAACb,IAAI,CAACY,CAAC,CAAC,CAAC;QACpC;MACJ,CAAC,MACI;QACDpE,KAAK,CAACsE,QAAQ,CAAC,CAAC;QAChBtE,KAAK,CAACuE,sBAAsB,CAACtB,SAAS,CAAC;MAC3C;IACJ,CAAC;IACD,IAAI,CAACuB,IAAI,GAAG,UAAU7D,CAAC,EAAE;MACrB,IAAIC,IAAI,GAAGZ,KAAK,CAACJ,MAAM;MACvB,IAAIsB,MAAM,GAAGN,IAAI,CAACiC,cAAc,CAAClC,CAAC,CAAC8D,cAAc,CAACpD,YAAY,CAAC,cAAc,CAAC,CAAC;MAC/ErB,KAAK,CAACe,OAAO,CAACpC,SAAS,CAACD,MAAM,CAAC,SAAS,CAAC;MACzCA,MAAM,CAACiC,CAAC,CAAC8D,cAAc,CAAC;MACxBzE,KAAK,CAAC0E,IAAI,CAACC,aAAa,CAAC3E,KAAK,CAACJ,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,kBAAkB,CAAC,EAAE,KAAK,CAAC;MACvFpC,KAAK,CAAC0E,IAAI,CAACE,UAAU,CAAC5E,KAAK,CAACJ,MAAM,CAACiF,cAAc,CAAC,CAAC,CAACzC,aAAa,CAAC,qBAAqB,CAAC,EAAE,KAAK,CAAC;MAChG,IAAItD,iBAAiB,CAACoC,MAAM,CAAC,IAAIA,MAAM,CAAC4D,aAAa,KAAK,KAAK,IAC3D9F,YAAY,CAAC4B,IAAI,CAACmE,oBAAoB,CAAC7D,MAAM,CAACW,GAAG,CAAC,EAAE,QAAQ,CAAC,CAACR,YAAY,CAAC,IAAI,CAAC,KAC5ET,IAAI,CAACG,OAAO,CAACM,YAAY,CAAC,IAAI,CAAC,EAAE;QACrCrB,KAAK,CAACJ,MAAM,CAACoF,GAAG,CAAC,wBAAwB,EAAE;UAAEC,UAAU,EAAEjF,KAAK,CAACkF,aAAa,CAAC,CAAC;UAAEC,UAAU,EAAEjE,MAAM,CAACkE;QAAW,CAAC,CAAC;QAChH;MACJ;MACApF,KAAK,CAACqF,WAAW,CAACnE,MAAM,CAAC0B,KAAK,CAAC;IACnC,CAAC;IACD,IAAI,CAAC0C,cAAc,GAAG,IAAI;IAC1B,IAAI,CAACZ,IAAI,GAAG,IAAInF,WAAW,CAAC,CAAC;IAC7B,IAAI,CAACK,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,aAAa,GAAGA,aAAa;IAClC,IAAI,CAACE,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACD,aAAa,GAAGA,aAAa;IAClC,IAAI,CAACyF,KAAK,GAAGxF,cAAc,CAACyF,UAAU,CAAC,OAAO,CAAC;IAC/C,IAAI,CAACC,gBAAgB,CAAC,CAAC;IACvB,IAAI,CAACC,cAAc,GAAG,IAAIlG,mBAAmB,CAAC,IAAI,CAACI,MAAM,CAAC;EAC9D;EACAD,KAAK,CAACgG,SAAS,CAACrB,QAAQ,GAAG,YAAY;IACnC,IAAI,CAAC,IAAI,CAACvD,OAAO,CAACuC,sBAAsB,CAAC,kBAAkB,CAAC,CAACa,MAAM,EAAE;MACjE,IAAIyB,SAAS,GAAG,IAAI,CAACC,IAAI,CAACC,WAAW,CAAC,eAAe,CAAC;MACtD,IAAI,CAAC/E,OAAO,CAACmD,SAAS,GAAG0B,SAAS;MAClC,IAAI,CAAC7E,OAAO,CAACpC,SAAS,CAACD,MAAM,CAAC,WAAW,CAAC;IAC9C;EACJ,CAAC;EACDiB,KAAK,CAACgG,SAAS,CAAChD,cAAc,GAAG,YAAY;IACzC,IAAI,CAAC1C,YAAY,GAAG,KAAK;IACzB,IAAI,CAAC8F,WAAW,CAAC,CAAC;EACtB,CAAC;EACDpG,KAAK,CAACgG,SAAS,CAACrD,UAAU,GAAG,UAAU3B,CAAC,EAAE;IACtC,IAAI,IAAI,CAACd,aAAa,CAACoB,eAAe,IAAIN,CAAC,CAACO,MAAM,CAAC4D,aAAa,EAAE;MAC9D,IAAI,CAAC5C,cAAc,CAACvB,CAAC,CAAC;IAC1B;IACA,IAAIwB,YAAY,GAAG,IAAI,CAACvC,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,oBAAoB,CAAC;IAC1EzD,SAAS,CAACwD,YAAY,EAAE,CAAC,cAAc,CAAC,EAAE,CAAC,iBAAiB,CAAC,CAAC;IAC9D,IAAI,CAACnD,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,iBAAiB,CAAC,IAC1C,EAAE,IAAI,CAACjB,MAAM,CAACqB,eAAe,IAAIjC,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,cAAc,CAAC,CAAC,EAAE;MAC1ElC,SAAS,CAACwD,YAAY,EAAE,CAAC,iBAAiB,CAAC,EAAE,CAAC,cAAc,CAAC,CAAC;IAClE;IACA,IAAIxB,CAAC,CAACE,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;MAChD,IAAI,CAACD,OAAO,CAACpC,SAAS,CAACqD,GAAG,CAAC,SAAS,CAAC;IACzC,CAAC,MACI;MACD,IAAI,CAACjB,OAAO,CAACpC,SAAS,CAACD,MAAM,CAAC,SAAS,CAAC;IAC5C;EACJ,CAAC;EACDiB,KAAK,CAACgG,SAAS,CAACK,eAAe,GAAG,UAAUrF,CAAC,EAAE;IAC3C,IAAIA,CAAC,CAACE,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,qBAAqB,CAAC,EAAE;MACpD;IACJ;IACA,IAAIiF,QAAQ,GAAG,IAAI,CAACrG,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,kBAAkB,CAAC;IACpE,IAAI,CAACsC,IAAI,CAACC,aAAa,CAACsB,QAAQ,EAAEtF,CAAC,CAACO,MAAM,CAAC4D,aAAa,CAAC;IACzD,IAAI/D,OAAO,GAAGJ,CAAC,CAACE,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,cAAc,CAAC,GAAGL,CAAC,CAACE,MAAM,GAAG7B,YAAY,CAAC2B,CAAC,CAACE,MAAM,EAAE,cAAc,CAAC;IAC7G,IAAI,CAAC6D,IAAI,CAACE,UAAU,CAAC7D,OAAO,EAAE,IAAI,EAAE,CAACJ,CAAC,CAACO,MAAM,CAAC4D,aAAa,CAAC;EAChE,CAAC;EACDnF,KAAK,CAACgG,SAAS,CAACO,UAAU,GAAG,UAAUvF,CAAC,EAAE;IACtC,IAAIC,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIe,CAAC,CAAC8D,cAAc,CAACpD,YAAY,CAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;MACxD,IAAIH,MAAM,GAAGN,IAAI,CAACiC,cAAc,CAAClC,CAAC,CAAC8D,cAAc,CAACpD,YAAY,CAAC,cAAc,CAAC,CAAC;MAC/E,IAAIvC,iBAAiB,CAACoC,MAAM,CAAC,IAAIA,MAAM,CAAC4D,aAAa,KAAK,KAAK,IAC3D9F,YAAY,CAAC4B,IAAI,CAACmE,oBAAoB,CAAC7D,MAAM,CAACW,GAAG,CAAC,EAAE,QAAQ,CAAC,CAACR,YAAY,CAAC,IAAI,CAAC,KAC5ET,IAAI,CAACG,OAAO,CAACM,YAAY,CAAC,IAAI,CAAC,EAAE;QACrC;MACJ;MACA,IAAI,CAAC2B,aAAa,CAAC9B,MAAM,CAAC0B,KAAK,CAAC;IACpC;EACJ,CAAC;EACD;AACJ;AACA;AACA;EACIjD,KAAK,CAACgG,SAAS,CAACF,gBAAgB,GAAG,YAAY;IAC3C,IAAI,IAAI,CAAC7F,MAAM,CAACuG,WAAW,EAAE;MACzB;IACJ;IACA,IAAI,CAACvG,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC+G,QAAQ,EAAE,IAAI,CAACC,iBAAiB,EAAE,IAAI,CAAC;IAC7D,IAAI,CAAC1G,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACiH,aAAa,EAAE,IAAI,CAACC,gBAAgB,EAAE,IAAI,CAAC;IACjE,IAAI,CAAC5G,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACmH,eAAe,EAAE,IAAI,CAACD,gBAAgB,EAAE,IAAI,CAAC;IACnE,IAAI,CAAC5G,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACoH,mBAAmB,EAAE,IAAI,CAACC,iBAAiB,EAAE,IAAI,CAAC;IACxE,IAAI,CAAC/G,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACsH,KAAK,EAAE,IAAI,CAACC,YAAY,EAAE,IAAI,CAAC;IACrD,IAAI,CAACjH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACgD,UAAU,EAAE,IAAI,CAACA,UAAU,EAAE,IAAI,CAAC;IACxD,IAAI,CAAC1C,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC0G,eAAe,EAAE,IAAI,CAACA,eAAe,EAAE,IAAI,CAAC;IAClE,IAAI,CAACpG,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACwH,UAAU,EAAE,IAAI,CAACZ,UAAU,EAAE,IAAI,CAAC;IACxD,IAAI,CAACtG,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC4G,UAAU,EAAE,IAAI,CAACA,UAAU,EAAE,IAAI,CAAC;IACxD,IAAI,CAACtG,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACyH,eAAe,EAAE,IAAI,CAACC,gBAAgB,EAAE,IAAI,CAAC;IACnE,IAAI,CAACpH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC2H,YAAY,EAAE,IAAI,CAACD,gBAAgB,EAAE,IAAI,CAAC;IAChE,IAAI,CAACpH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC4H,UAAU,EAAE,IAAI,CAACC,eAAe,EAAE,IAAI,CAAC;IAC7D,IAAI,CAACvH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC8H,YAAY,EAAE,IAAI,CAACC,UAAU,EAAE,IAAI,CAAC;IAC1D,IAAI,CAACzH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACgI,OAAO,EAAE,IAAI,CAACD,UAAU,EAAE,IAAI,CAAC;IACrD,IAAI,CAACzH,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAAC+H,UAAU,EAAE,IAAI,CAACE,MAAM,EAAE,IAAI,CAAC;IACpD,IAAI,CAAC3H,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACkI,eAAe,EAAE,IAAI,CAACC,iBAAiB,EAAE,IAAI,CAAC;IACpE,IAAI,CAAC7H,MAAM,CAACwG,EAAE,CAAC9G,MAAM,CAACoI,OAAO,EAAE,IAAI,CAACA,OAAO,EAAE,IAAI,CAAC;IAClD,IAAI,CAAC9H,MAAM,CAACwG,EAAE,CAAC,uBAAuB,EAAE,IAAI,CAACuB,YAAY,EAAE,IAAI,CAAC;IAChE,IAAI,CAAC/H,MAAM,CAACwG,EAAE,CAAC,sBAAsB,EAAE,IAAI,CAACiB,UAAU,EAAE,IAAI,CAAC;EACjE,CAAC;EACD;AACJ;AACA;AACA;EACI1H,KAAK,CAACgG,SAAS,CAACiC,mBAAmB,GAAG,YAAY;IAC9C,IAAI,IAAI,CAAChI,MAAM,CAACuG,WAAW,EAAE;MACzB;IACJ;IACA,IAAI,CAACvG,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC+H,UAAU,EAAE,IAAI,CAACE,MAAM,CAAC;IAC/C,IAAI,CAAC3H,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC+G,QAAQ,EAAE,IAAI,CAACC,iBAAiB,CAAC;IACxD,IAAI,CAAC1G,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACiH,aAAa,EAAE,IAAI,CAACC,gBAAgB,CAAC;IAC5D,IAAI,CAAC5G,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACmH,eAAe,EAAE,IAAI,CAACD,gBAAgB,CAAC;IAC9D,IAAI,CAAC5G,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACoH,mBAAmB,EAAE,IAAI,CAACC,iBAAiB,CAAC;IACnE,IAAI,CAAC/G,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACsH,KAAK,EAAE,IAAI,CAACC,YAAY,CAAC;IAChD,IAAI,CAACjH,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACgD,UAAU,EAAE,IAAI,CAACA,UAAU,CAAC;IACnD,IAAI,CAAC1C,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC0G,eAAe,EAAE,IAAI,CAACA,eAAe,CAAC;IAC7D,IAAI,CAACpG,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC4G,UAAU,EAAE,IAAI,CAACA,UAAU,CAAC;IACnD,IAAI,CAACtG,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACwH,UAAU,EAAE,IAAI,CAACZ,UAAU,CAAC;IACnD,IAAI,CAACtG,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACyH,eAAe,EAAE,IAAI,CAACC,gBAAgB,CAAC;IAC9D,IAAI,CAACpH,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC2H,YAAY,EAAE,IAAI,CAACD,gBAAgB,CAAC;IAC3D,IAAI,CAACpH,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC4H,UAAU,EAAE,IAAI,CAACC,eAAe,CAAC;IACxD,IAAI,CAACvH,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACkI,eAAe,EAAE,IAAI,CAACC,iBAAiB,CAAC;IAC/D,IAAI,CAAC7H,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACoI,OAAO,EAAE,IAAI,CAACA,OAAO,CAAC;IAC7C,IAAI,CAAC9H,MAAM,CAACiI,GAAG,CAAC,uBAAuB,EAAE,IAAI,CAACF,YAAY,CAAC;EAC/D,CAAC;EACDhI,KAAK,CAACgG,SAAS,CAAC0B,UAAU,GAAG,YAAY;IACrC,IAAIzG,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAI,CAACA,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAAC8H,YAAY,EAAE,IAAI,CAACC,UAAU,CAAC;IACrD,IAAI,CAACzH,MAAM,CAACiI,GAAG,CAACvI,MAAM,CAACgI,OAAO,EAAE,IAAI,CAACD,UAAU,CAAC;IAChD,IAAI,IAAI,CAACzH,MAAM,CAACkI,UAAU,CAAC,CAAC,CAAC3D,MAAM,IAAI,IAAI,CAACtE,aAAa,CAACiD,OAAO,CAACqB,MAAM,EAAE;MACtE,IAAI,CAACmB,cAAc,GAAG,KAAK;MAC3B,KAAK,IAAIyC,EAAE,GAAG,CAAC,EAAEC,EAAE,GAAGpH,IAAI,CAACf,aAAa,CAACiD,OAAO,EAAEiF,EAAE,GAAGC,EAAE,CAAC7D,MAAM,EAAE4D,EAAE,EAAE,EAAE;QACpE,IAAIE,GAAG,GAAGD,EAAE,CAACD,EAAE,CAAC;QAChB,IAAI,CAAC1C,WAAW,CAAC4C,GAAG,CAAC;MACzB;MACA,IAAI,CAAC3C,cAAc,GAAG,IAAI;IAC9B;EACJ,CAAC;EACD3F,KAAK,CAACgG,SAAS,CAACwB,eAAe,GAAG,UAAUxG,CAAC,EAAE;IAC3C,IAAIC,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIe,CAAC,CAACF,MAAM,KAAK,WAAW,KAAK,CAAC,IAAI,CAACZ,aAAa,CAACiD,OAAO,CAACqB,MAAM,IAC/D,CAAC,cAAc,EAAE,YAAY,EAAE,eAAe,EAAE,aAAa,EAAE,OAAO,CAAC,CAACpB,OAAO,CAACpC,CAAC,CAACF,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE;MACnG;IACJ;IACAE,CAAC,CAACuH,cAAc,CAAC,CAAC;IAClB,QAAQvH,CAAC,CAACF,MAAM;MACZ,KAAK,cAAc;MACnB,KAAK,YAAY;QACb;QACA,IAAI0H,QAAQ,GAAGvH,IAAI,CAACwH,cAAc,GAAGxH,IAAI,CAACyH,qBAAqB,CAAC,CAAC,GAAG,EAAE;QACtE,IAAIF,QAAQ,CAAChE,MAAM,EAAE;UACjB,IAAImE,IAAI,GAAG1H,IAAI,CAAC2H,eAAe,CAAC,CAAC,CAACnG,aAAa,CAAC1C,QAAQ,CAAC8I,KAAK,CAAC,CAACC,QAAQ;UACxE,IAAIC,OAAO,GAAG9H,IAAI,CAAC+H,WAAW,CAAC,CAAC,CAACR,QAAQ,CAACA,QAAQ,CAAChE,MAAM,GAAG,CAAC,CAAC,CAAC;UAC/D,IAAIyE,MAAM,GAAG,KAAK,CAAC;UACnB,KAAK,IAAIC,CAAC,GAAGH,OAAO,CAACI,QAAQ,EAAED,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;YACxC,IAAI,CAACP,IAAI,CAACO,CAAC,CAAC,CAAClK,SAAS,CAACqC,QAAQ,CAACtB,QAAQ,CAACqJ,GAAG,CAAC,IAAI,CAACT,IAAI,CAACO,CAAC,CAAC,CAAClK,SAAS,CAACqC,QAAQ,CAAC,aAAa,CAAC,EAAE;cACzF4H,MAAM,GAAGN,IAAI,CAACO,CAAC,CAAC;cAChB;YACJ;UACJ;UACA,IAAI,CAACG,kBAAkB,CAACJ,MAAM,CAACxG,aAAa,CAACzB,CAAC,CAACF,MAAM,KAAK,YAAY,GAClE,qBAAqB,GAAG,uBAAuB,CAAC,CAAC;QACzD;QACA;MACJ,KAAK,eAAe;QAChB,IAAI,CAACwI,SAAS,CAAC,CAAC;QAChB;MACJ,KAAK,aAAa;QACd,IAAI,CAACC,WAAW,CAAC,CAAC;QAClB;MACJ,KAAK,OAAO;QACR,IAAI,IAAI,CAACtJ,MAAM,CAACuJ,MAAM,IAAK1K,OAAO,CAACkC,CAAC,CAACE,MAAM,EAAE,GAAG,GAAG,IAAI,CAACjB,MAAM,CAACmB,OAAO,CAACqI,EAAE,GAAG,YAAY,CAAC,KAAK,IAAK,EAAE;UACjG;QACJ;QACA;QACA,IAAIrI,OAAO,GAAG,IAAI,CAACwE,KAAK,CAAC8D,iBAAiB,CAAC,CAAC;QAC5C;QACA,IAAIN,GAAG,GAAGhI,OAAO,GAAGA,OAAO,CAACuI,aAAa,CAAClH,aAAa,CAAC,qBAAqB,CAAC,GAAG,IAAI;QACrF,IAAI,CAAC2G,GAAG,EAAE;UACN;QACJ;QACA,IAAI,CAACC,kBAAkB,CAACD,GAAG,CAAC;QAC5B;MACJ,KAAK,WAAW;QACZ;QACA,IAAIQ,IAAI,GAAG3I,IAAI,CAAC4I,WAAW,CAACC,WAAW,CAAC1I,OAAO;QAC/C,IAAIwI,IAAI,IAAIA,IAAI,CAAC5K,SAAS,CAACqC,QAAQ,CAAC,cAAc,CAAC,EAAE;UACjD,IAAIE,MAAM,GAAGN,IAAI,CAACiC,cAAc,CAAC0G,IAAI,CAACnI,iBAAiB,CAACC,YAAY,CAAC,cAAc,CAAC,CAAC;UACrF,IAAIH,MAAM,CAAC0B,KAAK,IAAIhC,IAAI,CAACf,aAAa,CAACiD,OAAO,CAACC,OAAO,CAAC7B,MAAM,CAAC0B,KAAK,CAAC,GAAG,CAAC,EAAE;YACtE,IAAI,CAACyC,WAAW,CAACnE,MAAM,CAAC0B,KAAK,CAAC;UAClC,CAAC,MACI;YACD,IAAI,CAACI,aAAa,CAAC9B,MAAM,CAAC0B,KAAK,CAAC;UACpC;QACJ;QACA;IACR;EACJ,CAAC;EACDjD,KAAK,CAACgG,SAAS,CAACkB,YAAY,GAAG,UAAUlG,CAAC,EAAE;IACxC,IAAI,CAACqI,kBAAkB,CAACrI,CAAC,CAACE,MAAM,CAAC;IACjC,IAAI,CAAC6I,mBAAmB,CAAC/I,CAAC,CAACE,MAAM,CAAC;IAClC,IAAI,CAAC8I,iBAAiB,CAAChJ,CAAC,CAACE,MAAM,CAAC;IAChC,IAAI,CAAC+I,qBAAqB,CAACjJ,CAAC,CAACE,MAAM,CAAC;EACxC,CAAC;EACDlB,KAAK,CAACgG,SAAS,CAACgE,iBAAiB,GAAG,UAAU9I,MAAM,EAAE;IAClD,IAAIA,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;MAC9C,IAAI,CAACgC,aAAa,CAACnC,MAAM,CAACyI,aAAa,CAACjI,YAAY,CAAC,gBAAgB,CAAC,CAAC;IAC3E;EACJ,CAAC;EACD1B,KAAK,CAACgG,SAAS,CAACiE,qBAAqB,GAAG,UAAU/I,MAAM,EAAE;IACtD,IAAI,IAAI,CAAChB,aAAa,CAACgK,gBAAgB,EAAE;MACrC,IAAIhJ,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,gBAAgB,CAAC,EAAE;QAC7C,IAAIH,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;UAC9C,IAAI,CAACgC,aAAa,CAAC,IAAI,CAACpD,MAAM,CAACiD,cAAc,CAAChC,MAAM,CAACyI,aAAa,CAACjI,YAAY,CAAC,cAAc,CAAC,CAAC,CAACuB,KAAK,CAAC;QAC3G,CAAC,MACI;UACD,IAAI,CAACyC,WAAW,CAAC,IAAI,CAACzF,MAAM,CAACiD,cAAc,CAAChC,MAAM,CAACyI,aAAa,CAACjI,YAAY,CAAC,cAAc,CAAC,CAAC,CAACuB,KAAK,CAAC;QACzG;MACJ,CAAC,MACI;QACD,IAAI/B,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;UAC9C,IAAI,CAACgC,aAAa,CAACnC,MAAM,CAACyI,aAAa,CAACjI,YAAY,CAAC,gBAAgB,CAAC,CAAC;QAC3E;MACJ;IACJ;EACJ,CAAC;EACD1B,KAAK,CAACgG,SAAS,CAAC+D,mBAAmB,GAAG,UAAU7I,MAAM,EAAE;IACpD,IAAID,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIkK,OAAO,GAAGrL,OAAO,CAACoC,MAAM,EAAE,oBAAoB,CAAC;IACnD,IAAID,IAAI,CAACmJ,YAAY,IAAID,OAAO,IAAI,CAACjJ,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,IAC7E,CAACH,MAAM,CAAClC,SAAS,CAACqC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;MAC/C,IAAI4B,KAAK,GAAGkH,OAAO,CAAC1I,iBAAiB,CAACC,YAAY,CAAC,gBAAgB,CAAC;MACpE,IAAIT,IAAI,CAACoJ,sBAAsB,CAACpH,KAAK,CAAC,CAACU,sBAAsB,CAAC,aAAa,CAAC,CAACa,MAAM,EAAE;QACjFvD,IAAI,CAACqJ,UAAU,CAACrH,KAAK,EAAE,YAAY,EAAE,IAAI,CAAC;MAC9C,CAAC,MACI;QACDhC,IAAI,CAACqJ,UAAU,CAACrH,KAAK,EAAE,WAAW,EAAE,IAAI,CAAC;MAC7C;IACJ;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACIjD,KAAK,CAACgG,SAAS,CAACqD,kBAAkB,GAAG,UAAUnI,MAAM,EAAE;IACnD,IAAIqJ,IAAI,GAAGlL,YAAY,CAAC6B,MAAM,EAAE,oBAAoB,CAAC,IACjD7B,YAAY,CAAC6B,MAAM,EAAE,sBAAsB,CAAC;IAChD,IAAIqJ,IAAI,EAAE;MACN,IAAIC,QAAQ,GAAG,IAAI,CAACvK,MAAM,CAAC2I,eAAe,CAAC,CAAC,CAACnG,aAAa,CAAC1C,QAAQ,CAAC8I,KAAK,CAAC,CAACC,QAAQ;MACnF,IAAI2B,MAAM,GAAG,KAAK,CAAC;MACnB,IAAIC,WAAW,GAAG,KAAK,CAAC;MACxB,IAAIC,KAAK,GAAG,KAAK,CAAC;MAClB,IAAI1J,IAAI,GAAG,IAAI,CAAChB,MAAM;MACtB,IAAI2K,MAAM,GAAGL,IAAI,CAACZ,aAAa,CAAChG,sBAAsB,CAAC,cAAc,CAAC,CAACa,MAAM;MAC7E,IAAItC,GAAG,GAAGqI,IAAI,CAACZ,aAAa,CAACjI,YAAY,CAAC,UAAU,CAAC;MACrD,IAAImJ,UAAU,GAAG5J,IAAI,CAAC6J,mBAAmB,CAAC5I,GAAG,CAAC;MAC9C,IAAI6I,MAAM,GAAG,KAAK;MAClB,IAAIR,IAAI,CAACvL,SAAS,CAACqC,QAAQ,CAAC,sBAAsB,CAAC,EAAE;QACjDpC,QAAQ,CAAC,CAACsL,IAAI,CAAC,EAAE,oBAAoB,CAAC;QACtCrL,WAAW,CAAC,CAACqL,IAAI,CAAC,EAAE,sBAAsB,CAAC;QAC3CA,IAAI,CAAC9I,iBAAiB,CAACd,SAAS,GAAG,2CAA2C;QAC9EoK,MAAM,GAAG,IAAI;QACbF,UAAU,CAACG,QAAQ,GAAG,IAAI;QAC1B,IAAIzL,eAAe,CAAC0B,IAAI,CAAC,EAAE;UACvB,IAAI,CAACgK,iBAAiB,CAAChK,IAAI,EAAEC,MAAM,EAAE6J,MAAM,EAAEJ,KAAK,EAAED,WAAW,CAAC;QACpE;QACA,IAAI,IAAI,CAACzK,MAAM,CAACC,aAAa,CAACgL,iBAAiB,EAAE;UAC7C,IAAI,CAACjL,MAAM,CAACkL,aAAa,CAACC,aAAa,CAACb,IAAI,CAACZ,aAAa,CAAC;QAC/D;MACJ,CAAC,MACI;QACDc,MAAM,GAAG,IAAI;QACbI,UAAU,CAACG,QAAQ,GAAG,KAAK;QAC3B9L,WAAW,CAAC,CAACqL,IAAI,CAAC,EAAE,oBAAoB,CAAC;QACzCtL,QAAQ,CAAC,CAACsL,IAAI,CAAC,EAAE,sBAAsB,CAAC;QACxCA,IAAI,CAAC9I,iBAAiB,CAACd,SAAS,GAAG,2CAA2C;QAC9E,IAAIpB,eAAe,CAAC0B,IAAI,CAAC,EAAE;UACvB,IAAI,CAACgK,iBAAiB,CAAChK,IAAI,EAAEC,MAAM,EAAE,CAACuJ,MAAM,EAAEE,KAAK,EAAED,WAAW,CAAC;QACrE;QACA,IAAI,IAAI,CAACzK,MAAM,CAACC,aAAa,CAACgL,iBAAiB,EAAE;UAC7C,IAAI,CAACjL,MAAM,CAACkL,aAAa,CAACE,eAAe,CAACd,IAAI,CAACZ,aAAa,CAAC;QACjE;MACJ;MACA,IAAI,CAAC5E,IAAI,CAACuG,SAAS,CAACf,IAAI,EAAEQ,MAAM,CAAC;MACjC,IAAI,CAACxL,eAAe,CAAC0B,IAAI,CAAC,IAAI,CAAC,IAAI,CAAChB,MAAM,CAACC,aAAa,CAACgL,iBAAiB,EAAE;QACxE,IAAIK,OAAO,GAAGtK,IAAI,CAACuK,aAAa,CAAC,CAAC;QAClC,IAAIC,QAAQ,GAAGF,OAAO,CAACnI,OAAO,CAACyH,UAAU,CAAC;QAC1C,IAAIa,SAAS,GAAG,CAAC,CAAC;QAClB,KAAK,IAAIxC,CAAC,GAAGuC,QAAQ,EAAEvC,CAAC,GAAGqC,OAAO,CAAC/G,MAAM,EAAE0E,CAAC,EAAE,EAAE;UAC5C,IAAIA,CAAC,GAAGuC,QAAQ,IAAIF,OAAO,CAACrC,CAAC,CAAC,CAAC0B,MAAM,KAAKA,MAAM,EAAE;YAC9C;UACJ;UACA,IAAIW,OAAO,CAACrC,CAAC,CAAC,CAACyC,WAAW,EAAE;YACxB,IAAIC,OAAO,GAAGL,OAAO,CAACrC,CAAC,GAAG,CAAC,CAAC,CAAC8B,QAAQ,IAAIO,OAAO,CAACrC,CAAC,GAAG,CAAC,CAAC,CAAC0C,OAAO;YAC/DpB,QAAQ,CAACtB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAGD,OAAO,GAAG,EAAE,GAAG,MAAM;UACrD,CAAC,MACI,IAAIF,SAAS,CAACH,OAAO,CAACrC,CAAC,CAAC,CAAC4C,SAAS,CAAC,KAAK,KAAK,EAAE;YAChDP,OAAO,CAACrC,CAAC,CAAC,CAAC0C,OAAO,GAAG,KAAK;YAC1BpB,QAAQ,CAACtB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAG,MAAM;UACtC,CAAC,MACI;YACD,IAAI,EAAEN,OAAO,CAACrC,CAAC,CAAC,CAAC6C,SAAS,IAAIR,OAAO,CAACrC,CAAC,CAAC,CAAC8C,YAAY,IAAIT,OAAO,CAACrC,CAAC,CAAC,CAACyC,WAAW,IAAIJ,OAAO,CAACrC,CAAC,CAAC,CAAC+C,cAAc,CAAC,EAAE;cAC3G,IAAIL,OAAO,GAAGL,OAAO,CAACrC,CAAC,CAAC,CAACgD,KAAK,CAACC,IAAI,CAAC,UAAUC,IAAI,EAAE;gBAAE,OAAOA,IAAI,CAACC,UAAU,IACrED,IAAI,CAACR,OAAO;cAAE,CAAC,CAAC;cACvB,IAAIA,OAAO,KAAKL,OAAO,CAACrC,CAAC,CAAC,CAAC0C,OAAO,EAAE;gBAChC;cACJ;YACJ;YACAL,OAAO,CAACrC,CAAC,CAAC,CAAC0C,OAAO,GAAG,IAAI;YACzBpB,QAAQ,CAACtB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAG,EAAE;YAC9BrB,QAAQ,CAACtB,CAAC,CAAC,CAAClK,SAAS,CAACD,MAAM,CAAC,QAAQ,CAAC;UAC1C;UACA,IAAIwM,OAAO,CAACrC,CAAC,CAAC,CAAC8C,YAAY,EAAE;YACzBN,SAAS,CAACH,OAAO,CAACrC,CAAC,CAAC,CAAChH,GAAG,CAAC,GAAGqJ,OAAO,CAACrC,CAAC,CAAC,CAAC8B,QAAQ,IAAIO,OAAO,CAACrC,CAAC,CAAC,CAAC0C,OAAO;UACzE;QACJ;QACA,IAAI,CAAC3L,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC4M,wBAAwB,EAAE;UAAE5D,IAAI,EAAE,IAAI,CAAC1I,MAAM,CAACuL,aAAa,CAAC;QAAE,CAAC,CAAC;MAC9F;MACA,IAAI,CAACvL,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC6M,qBAAqB,EAAE;QAAEC,UAAU,EAAEhC,MAAM;QAAEqB,SAAS,EAAE5J;MAAI,CAAC,CAAC;IAC5F;EACJ,CAAC;EACDlC,KAAK,CAACgG,SAAS,CAACiF,iBAAiB,GAAG,UAAUhK,IAAI,EAAEC,MAAM,EAAE8J,QAAQ,EAAEL,KAAK,EAAED,WAAW,EAAE;IACtF,IAAIgC,IAAI,GAAGzL,IAAI,CAAC6J,mBAAmB,CAAC5J,MAAM,CAACpC,OAAO,CAAC,IAAI,CAAC,CAAC4C,YAAY,CAAC,UAAU,CAAC,CAAC;IAClFgL,IAAI,CAAC1B,QAAQ,GAAGA,QAAQ;IACxBxL,cAAc,CAACyB,IAAI,CAAC;IACpB,IAAI,CAAChB,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAACgN,qBAAqB,EAAE,CAAC,CAAC,CAAC;IACpDhC,KAAK,GAAG1J,IAAI,CAAC2L,aAAa,CAAC,CAAC,CAACC,aAAa,CAAC,KAAK,CAAC;IACjDlC,KAAK,CAACmC,OAAO,GAAG7L,IAAI,CAAC2L,aAAa,CAAC,CAAC,CAACG,cAAc,CAAC9L,IAAI,CAAC+L,QAAQ,CAAC,CAAC,CAACC,KAAK,CAAC,CAAC,CAAC,CAACH,OAAO;IACpF,IAAII,IAAI,GAAG;MAAEC,WAAW,EAAE,eAAe;MAAEC,SAAS,EAAEV;IAAK,CAAC;IAC5D,IAAIzL,IAAI,CAACkK,aAAa,EAAE;MACpB+B,IAAI,CAACG,WAAW,GAAGpM,IAAI,CAACkK,aAAa,CAACmC,QAAQ;IAClD;IACA5C,WAAW,GAAGzJ,IAAI,CAAC2L,aAAa,CAAC,CAAC,CAACW,OAAO,CAACL,IAAI,EAAEvC,KAAK,CAAC6C,aAAa,CAAC,CAAC,CAAC;IACvE9C,WAAW,CAAC+C,IAAI,CAAC,UAAUzM,CAAC,EAAE;MAAE,OAAOC,IAAI,CAACyM,YAAY,CAACC,kBAAkB,CAAC3M,CAAC,EAAEkM,IAAI,CAAC;IAAE,CAAC,CAAC;EAC5F,CAAC;EACDlN,KAAK,CAACgG,SAAS,CAAC4H,cAAc,GAAG,UAAU5C,QAAQ,EAAE;IACjD,IAAI,CAAC,IAAI,CAAC/K,MAAM,CAACC,aAAa,CAACiD,OAAO,CAACqB,MAAM,EAAE;MAC3C;IACJ;IACA,IAAI,CAACwG,QAAQ,EAAE;MACX,IAAI,CAAC/K,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAACkO,eAAe,EAAE7C,QAAQ,CAAC;IACxD;IACA,IAAIR,QAAQ,GAAG,IAAI,CAACvK,MAAM,CAAC2I,eAAe,CAAC,CAAC,CAACnG,aAAa,CAAC1C,QAAQ,CAAC8I,KAAK,CAAC,CAACC,QAAQ;IACnF,IAAIyC,OAAO,GAAG,IAAI,CAACtL,MAAM,CAACuL,aAAa,CAAC,CAAC;IACzC,IAAIpC,GAAG;IACP,KAAK,IAAIF,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAGtD,QAAQ,CAAChG,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;MACjD,IAAIsB,QAAQ,CAACtB,CAAC,CAAC,CAAC6E,gBAAgB,CAAC,4CAA4C,CAAC,CAACvJ,MAAM,EAAE;QACnF4E,GAAG,GAAGoB,QAAQ,CAACtB,CAAC,CAAC,CAACzG,aAAa,CAACuI,QAAQ,GAAG,uBAAuB,GAAG,qBAAqB,CAAC;QAC3F,IAAI5B,GAAG,EAAE;UACLA,GAAG,CAACzI,SAAS,GAAGqK,QAAQ,GAAG,oBAAoB,GAAG,sBAAsB;UACxE5B,GAAG,CAAC3H,iBAAiB,CAACd,SAAS,GAAGqK,QAAQ,GAAG,2CAA2C,GACpF,2CAA2C;QACnD;QACA,IAAI,EAAER,QAAQ,CAACtB,CAAC,CAAC,CAACzH,iBAAiB,CAACzC,SAAS,CAACqC,QAAQ,CAAC,oBAAoB,CAAC,IACxEmJ,QAAQ,CAACtB,CAAC,CAAC,CAACzH,iBAAiB,CAACzC,SAAS,CAACqC,QAAQ,CAAC,sBAAsB,CAAC,CAAC,EAAE;UAC3EmJ,QAAQ,CAACtB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAGb,QAAQ,GAAG,EAAE,GAAG,MAAM;QACtD;MACJ,CAAC,MACI;QACDR,QAAQ,CAACtB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAGb,QAAQ,GAAG,EAAE,GAAG,MAAM;MACtD;MACA,IAAIO,OAAO,CAACrC,CAAC,CAAC,CAAC8C,YAAY,EAAE;QACzBT,OAAO,CAACrC,CAAC,CAAC,CAAC8B,QAAQ,GAAGA,QAAQ,GAAG,IAAI,GAAG,KAAK;MACjD;IACJ;IACA,IAAI,CAAC/K,MAAM,CAAC+N,+BAA+B,CAAC,CAAC;IAC7C,IAAI,CAAC/N,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC4M,wBAAwB,EAAE;MAAE5D,IAAI,EAAE,IAAI,CAAC1I,MAAM,CAACuL,aAAa,CAAC;IAAE,CAAC,CAAC;EAC9F,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIxL,KAAK,CAACgG,SAAS,CAACsD,SAAS,GAAG,YAAY;IACpC,IAAI,CAACsE,cAAc,CAAC,IAAI,CAAC;EAC7B,CAAC;EACD;AACJ;AACA;AACA;AACA;EACI5N,KAAK,CAACgG,SAAS,CAACuD,WAAW,GAAG,YAAY;IACtC,IAAI,CAACqE,cAAc,CAAC,KAAK,CAAC;EAC9B,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACI5N,KAAK,CAACgG,SAAS,CAAC4B,MAAM,GAAG,YAAY;IACjC,IAAI,CAAC1B,IAAI,GAAG,IAAI,CAAC9F,cAAc,CAACyF,UAAU,CAAC,cAAc,CAAC;IAC1D,IAAI,CAACoI,mBAAmB,CAAC,CAAC;IAC1B,IAAI,CAACC,eAAe,CAAC,CAAC;IACtB,IAAI,CAACC,gBAAgB,CAAC,CAAC;EAC3B,CAAC;EACDnO,KAAK,CAACgG,SAAS,CAACiI,mBAAmB,GAAG,YAAY;IAC9C,IAAIG,SAAS,GAAG,IAAI,CAACnO,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,kBAAkB,CAAC;IACrE,IAAI2L,SAAS,EAAE;MACXrP,MAAM,CAACqP,SAAS,CAAC;IACrB;IACA,IAAI,CAAChN,OAAO,GAAG,IAAI,CAACnB,MAAM,CAACpB,aAAa,CAAC,KAAK,EAAE;MAAE8B,SAAS,EAAE,iBAAiB;MAAEE,KAAK,EAAE;QAAE,UAAU,EAAE;MAAK;IAAE,CAAC,CAAC;IAC9G,IAAI,IAAI,CAACX,aAAa,CAACoB,eAAe,EAAE;MACpC,IAAI,CAACF,OAAO,CAACpC,SAAS,CAACqD,GAAG,CAAC,iBAAiB,CAAC;IACjD;IACA,IAAI,CAACgM,mBAAmB,CAAC,CAAC;IAC1B,IAAI,CAACpO,MAAM,CAACmB,OAAO,CAACkN,YAAY,CAAC,IAAI,CAAClN,OAAO,EAAE,IAAI,CAACnB,MAAM,CAACmB,OAAO,CAACmN,UAAU,CAAC;IAC9E,IAAI,CAAC,IAAI,CAACrO,aAAa,CAACsO,YAAY,EAAE;MAClC,IAAI,CAACpN,OAAO,CAACQ,KAAK,CAACiK,OAAO,GAAG,MAAM;IACvC;EACJ,CAAC;EACD7L,KAAK,CAACgG,SAAS,CAACqI,mBAAmB,GAAG,UAAUI,KAAK,EAAE;IACnD,IAAI,IAAI,CAACvO,aAAa,CAACsO,YAAY,IAAI,CAAC,IAAI,CAACtO,aAAa,CAACiD,OAAO,CAACqB,MAAM,EAAE;MACvE,IAAIyB,SAAS,GAAG,IAAI,CAACC,IAAI,CAACC,WAAW,CAAC,eAAe,CAAC;MACtD,IAAI,CAAC/E,OAAO,CAACmD,SAAS,GAAG0B,SAAS;MAClC,IAAI,CAAC7E,OAAO,CAACpC,SAAS,CAACD,MAAM,CAAC,WAAW,CAAC;IAC9C,CAAC,MACI;MACD,IAAK,IAAI,CAACqC,OAAO,CAACmD,SAAS,KAAK,IAAI,CAAC2B,IAAI,CAACC,WAAW,CAAC,eAAe,CAAC,KAAK,IAAI,CAACjG,aAAa,CAACiD,OAAO,CAACqB,MAAM,KAAK,CAAC,IAC3G,CAAC,IAAI,CAACjE,cAAc,IAAI,CAAC,IAAI,CAACC,gBAAgB,CAAC,IAAKiO,KAAK,EAAE;QAC9D,IAAI,CAACrN,OAAO,CAACmD,SAAS,GAAG,EAAE;MAC/B;MACA,IAAI,CAACnD,OAAO,CAACpC,SAAS,CAACqD,GAAG,CAAC,WAAW,CAAC;IAC3C;EACJ,CAAC;EACDrC,KAAK,CAACgG,SAAS,CAACkI,eAAe,GAAG,YAAY;IAC1C,IAAI,CAACQ,qBAAqB,CAAC,CAAC;IAC5B,IAAI,CAACC,qBAAqB,CAAC,CAAC;EAChC,CAAC;EACD3O,KAAK,CAACgG,SAAS,CAAC2I,qBAAqB,GAAG,YAAY;IAChD;IACA,IAAIrM,IAAI,GAAG,IAAI3D,SAAS,CAAC,IAAI,CAACyC,OAAO,EAAE;MACnCwN,UAAU,EAAE,IAAI,CAAC1O,aAAa,CAACoB,eAAe,GAAG,SAAS,GAAG,oBAAoB;MACjFuN,QAAQ,EAAE,IAAI,CAAC3O,aAAa,CAACoB,eAAe,GAAG,CAAC,EAAE,GAAG,CAAC;MACtDP,MAAM,EAAE,IAAI,CAACA,MAAM;MACnBqB,SAAS,EAAE,IAAI,CAACA,SAAS;MACzBE,IAAI,EAAE,IAAI,CAACA,IAAI;MACfQ,QAAQ,EAAE,IAAI,CAACA;IACnB,CAAC,CAAC;EACN,CAAC;EACD9C,KAAK,CAACgG,SAAS,CAAC0I,qBAAqB,GAAG,YAAY;IAChD;IACA,IAAI7J,IAAI,GAAG,IAAIjG,SAAS,CAAC,IAAI,CAACwC,OAAO,EAAE;MACnC0N,MAAM,EAAE,cAAc;MACtBjK,IAAI,EAAE,IAAI,CAACA;IACf,CAAC,CAAC;EACN,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACI7E,KAAK,CAACgG,SAAS,CAACN,WAAW,GAAG,UAAUF,UAAU,EAAE;IAChD,IAAIvE,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIsB,MAAM,GAAGN,IAAI,CAACO,gBAAgB,CAACgE,UAAU,CAAC;IAC9C,IAAIrG,iBAAiB,CAACoC,MAAM,CAAC,IAAIA,MAAM,CAAC4D,aAAa,KAAK,KAAK,IAC1D,IAAI,CAACQ,cAAc,IAAI,IAAI,CAACzF,aAAa,CAACiD,OAAO,CAACC,OAAO,CAACoC,UAAU,CAAC,GAAG,CAAC,CAAE,EAAE;MAC9E,IAAI,CAACvF,MAAM,CAACoF,GAAG,CAAC,wBAAwB,EAAE;QAAEC,UAAU,EAAE,IAAI,CAACC,aAAa,CAAC,CAAC;QAAEC,UAAU,EAAEjE,MAAM,CAACkE;MAAW,CAAC,CAAC;MAC9G;IACJ;IACA,IAAInG,eAAe,CAAC2B,IAAI,CAAC,EAAE;MACvBA,IAAI,CAACqL,MAAM,CAAC3M,MAAM,CAACoP,YAAY,EAAE;QAAEC,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,IAAI,CAACvJ,WAAW;QAAEwJ,IAAI,EAAE1J;MAAW,CAAC,CAAC;MACjG;IACJ;IACAjE,MAAM,CAACqK,OAAO,GAAG3K,IAAI,CAACf,aAAa,CAACiP,iBAAiB;IACrD,IAAI,CAACC,OAAO,GAAG5J,UAAU;IACzB,IAAI,CAACjF,cAAc,GAAG,IAAI;IAC1B,IAAI,IAAI,CAACoF,cAAc,EAAE;MACrB,IAAI,CAACS,WAAW,CAAC,CAAC;IACtB,CAAC,MACI;MACD,IAAI,CAAC1B,iBAAiB,CAACc,UAAU,CAAC;IACtC;IACA,IAAI,CAAC6I,mBAAmB,CAAC,CAAC;IAC1B,IAAI,CAAC9N,cAAc,GAAG,KAAK;EAC/B,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACIP,KAAK,CAACgG,SAAS,CAAC3C,aAAa,GAAG,UAAUmC,UAAU,EAAE;IAClD,IAAIvE,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIsB,MAAM,GAAG,IAAI,CAACtB,MAAM,CAACoP,0BAA0B,GAC/C,IAAI,CAACpP,MAAM,CAACkD,OAAO,CAACmM,MAAM,CAAC,UAAU7K,CAAC,EAAE;MAAE,OAAOA,CAAC,CAACxB,KAAK,KAAKuC,UAAU;IAAE,CAAC,CAAC,CAAC,CAAC,CAAC,GAAGvE,IAAI,CAACO,gBAAgB,CAACgE,UAAU,CAAC;IACtH,IAAIrG,iBAAiB,CAACoC,MAAM,CAAC,IAAIA,MAAM,CAAC4D,aAAa,KAAK,KAAK,IAAI,IAAI,CAACjF,aAAa,CAACiD,OAAO,CAACC,OAAO,CAACoC,UAAU,CAAC,GAAG,CAAC,EAAE;MACnH;IACJ;IACA,IAAIlG,eAAe,CAAC2B,IAAI,CAAC,EAAE;MACvBA,IAAI,CAACqL,MAAM,CAAC3M,MAAM,CAACoP,YAAY,EAAE;QAAEC,QAAQ,EAAE,IAAI;QAAEC,OAAO,EAAE,IAAI,CAAC5L,aAAa;QAAE6L,IAAI,EAAE1J;MAAW,CAAC,CAAC;MACnG;IACJ;IACAjE,MAAM,CAACqK,OAAO,GAAG,IAAI;IACrB,IAAI,CAACwD,OAAO,GAAG7N,MAAM,CAAC0B,KAAK;IAC3B,IAAIE,OAAO,GAAGW,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAC9D,aAAa,CAACiD,OAAO,CAAC,CAAC;IACpEA,OAAO,CAACiB,MAAM,CAACjB,OAAO,CAACC,OAAO,CAAC,IAAI,CAACgM,OAAO,CAAC,EAAE,CAAC,CAAC;IAChD,IAAI,IAAI,CAACjP,aAAa,CAACiD,OAAO,CAACoC,UAAU,CAAC,GAAG,CAAC,EAAE;MAC5C,KAAK,IAAI0D,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAG7M,IAAI,CAACsO,YAAY,CAACpM,OAAO,CAACqB,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;QAClE,IAAI1D,UAAU,KAAKvE,IAAI,CAACsO,YAAY,CAACpM,OAAO,CAAC+F,CAAC,CAAC,CAACjG,KAAK,EAAE;UACnDhC,IAAI,CAACsO,YAAY,CAACpM,OAAO,CAACiB,MAAM,CAAC8E,CAAC,EAAE,CAAC,CAAC;UACtC;QACJ;MACJ;IACJ;IACA,IAAI,IAAI,CAAChJ,aAAa,CAACoB,eAAe,EAAE;MACpC,IAAI,CAACb,iBAAiB,GAAG0C,OAAO;IACpC;IACA,IAAI,CAACjD,aAAa,CAACiD,OAAO,GAAGA,OAAO;IACpC,IAAIlC,IAAI,CAACkE,aAAa,EAAE;MACpB,IAAI,CAAC3E,gBAAgB,GAAG,IAAI;MAC5B,IAAI,CAACP,MAAM,CAACuP,QAAQ,CAAC,CAAC;IAC1B;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACIxP,KAAK,CAACgG,SAAS,CAACI,WAAW,GAAG,YAAY;IACtC,IAAIjD,OAAO,GAAGW,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAC9D,aAAa,CAACiD,OAAO,CAAC,CAAC;IACpEA,OAAO,GAAG,IAAI,CAAC1C,iBAAiB,CAAC+D,MAAM,GAAGV,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAACvD,iBAAiB,CAAC,CAAC,GAAG0C,OAAO;IACtG,IAAI,IAAI,CAAC7C,YAAY,EAAE;MACnB,IAAI6C,OAAO,CAACC,OAAO,CAAC,IAAI,CAACgM,OAAO,CAAC,KAAK,CAAC,CAAC,EAAE;QACtCjM,OAAO,CAACmB,IAAI,CAAC,IAAI,CAAC8K,OAAO,CAAC;MAC9B;MACA,IAAI,CAACK,oBAAoB,CAAC,IAAI,CAACL,OAAO,CAAC;IAC3C;IACA,IAAI,CAAC9O,YAAY,GAAG,IAAI;IACxB,IAAI,CAACL,MAAM,CAACC,aAAa,CAACiD,OAAO,GAAGA,OAAO;IAC3C,IAAI,CAAClD,MAAM,CAACuP,QAAQ,CAAC,CAAC;EAC1B,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;AACA;EACIxP,KAAK,CAACgG,SAAS,CAACa,gBAAgB,GAAG,UAAU7F,CAAC,EAAE;IAC5C,IAAIA,CAAC,CAACmM,WAAW,KAAK,UAAU,EAAE;MAC9B,IAAI,CAACzI,iBAAiB,CAAC,IAAI,CAAC0K,OAAO,CAAC;IACxC,CAAC,MACI;MACD,IAAI,CAACxK,sBAAsB,CAAC,IAAI,CAACwK,OAAO,CAAC;IAC7C;IACA,IAAIlC,IAAI,GAAG,IAAI,CAAChN,aAAa,CAACiD,OAAO,CAACC,OAAO,CAAC,IAAI,CAACgM,OAAO,CAAC,GAAG,CAAC,CAAC,GAAG;MAC/D5J,UAAU,EAAE,IAAI,CAAC4J,OAAO;MAAEjC,WAAW,EAAE,UAAU;MAAEuC,IAAI,EAAE/P,MAAM,CAACgQ;IACpE,CAAC,GAAG;MAAExC,WAAW,EAAE,YAAY;MAAEuC,IAAI,EAAE/P,MAAM,CAACgQ;IAAe,CAAC;IAC9D,IAAI,CAAC1P,MAAM,CAACyC,OAAO,CAAC/C,MAAM,CAACgQ,cAAc,EAAEvQ,MAAM,CAAC4B,CAAC,EAAEkM,IAAI,CAAC,CAAC;IAC3D,IAAI,CAACkC,OAAO,GAAG,IAAI;EACvB,CAAC;EACDpP,KAAK,CAACgG,SAAS,CAACyJ,oBAAoB,GAAG,UAAUL,OAAO,EAAE;IACtD,IAAIlG,CAAC,GAAG,CAAC;IACT,OAAOA,CAAC,GAAG,IAAI,CAACjJ,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACqB,MAAM,EAAE;MAChD,IAAI,IAAI,CAACvE,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAAC+F,CAAC,CAAC,CAACjG,KAAK,KAAKmM,OAAO,EAAE;QACvD;MACJ;MACAlG,CAAC,EAAE;IACP;IACA,IAAI,IAAI,CAACjJ,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACqB,MAAM,KAAK0E,CAAC,EAAE;MAC/C,IAAI,CAACjJ,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACmB,IAAI,CAAC;QAAErB,KAAK,EAAEmM,OAAO;QAAEQ,SAAS,EAAE,WAAW;QAAEC,WAAW,EAAE;MAAK,CAAC,CAAC;IACxG,CAAC,MACI,IAAI,CAAC,IAAI,CAAC5P,MAAM,CAACmK,YAAY,EAAE;MAChC,IAAI,CAACnK,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAAC+F,CAAC,CAAC,CAAC0G,SAAS,GAAG,WAAW;IAC/D;EACJ,CAAC;EACD5P,KAAK,CAACgG,SAAS,CAACnH,aAAa,GAAG,UAAUoE,KAAK,EAAE;IAC7C,IAAIhC,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAI2P,SAAS,GAAG,WAAW;IAC3B,IAAIE,QAAQ,GAAG,IAAI,CAAC7P,MAAM,CAACpB,aAAa,CAAC,KAAK,EAAE;MAAE8B,SAAS,EAAE;IAA+B,CAAC,CAAC;IAC9F,IAAIoP,aAAa,GAAG,IAAI,CAAC9P,MAAM,CAACpB,aAAa,CAAC,KAAK,EAAE;MAAE8B,SAAS,EAAE;IAAgC,CAAC,CAAC;IACpG,IAAIqP,QAAQ,GAAG,IAAI,CAAC/P,MAAM,CAACpB,aAAa,CAAC,KAAK,EAAE;MAAEgC,KAAK,EAAE;QAAE,gBAAgB,EAAEoC;MAAM;IAAE,CAAC,CAAC;IACvF,IAAIvD,cAAc,CAACuD,KAAK,CAAC,EAAE;MACvB+M,QAAQ,CAAC/N,YAAY,CAAC,gBAAgB,EAAExC,iBAAiB,CAACwD,KAAK,CAAC,CAAC;IACrE;IACA,IAAI1B,MAAM,GAAG,IAAI,CAACtB,MAAM,CAACuB,gBAAgB,CAACyB,KAAK,CAAC;IAChD;IACA,IAAIgN,UAAU,GAAGhP,IAAI,CAACmE,oBAAoB,CAAC7D,MAAM,CAACW,GAAG,CAAC;IACtD;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA,IAAI,IAAI,CAAChC,aAAa,CAACoB,eAAe,EAAE;MACpC0O,QAAQ,CAAC7N,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;QACnD8B,SAAS,EAAE,4BAA4B;QAAE4D,SAAS,EAAE,QAAQ;QAC5D1D,KAAK,EAAE;UAAEqP,KAAK,EAAE,MAAM;UAAEC,QAAQ,EAAE,IAAI;UAAE,YAAY,EAAE;QAA0B;MACpF,CAAC,CAAC,CAAC;IACP;IACAH,QAAQ,CAAC7N,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;MACnD8B,SAAS,EAAE,aAAa;MAAE4D,SAAS,EAAEhD,MAAM,CAACkE,UAAU;MACtD5E,KAAK,EAAE;QAAEsP,QAAQ,EAAE,IAAI;QAAE,YAAY,EAAE;MAA0B;IACrE,CAAC,CAAC,CAAC;IACH;IACA,IAAI,IAAI,CAACjQ,aAAa,CAACgK,gBAAgB,EAAE;MACrC8F,QAAQ,CAAC7N,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;QACnD8B,SAAS,EAAE,4DAA4D;QAAE4D,SAAS,EAAE,QAAQ;QAC5F1D,KAAK,EAAE;UAAEsP,QAAQ,EAAE,IAAI;UAAE,YAAY,EAAE;QAAiB;MAC5D,CAAC,CAAC,CAAC;IACP;IACA,IAAIF,UAAU,CAAClC,gBAAgB,CAAC,4BAA4B,CAAC,CAACvJ,MAAM,EAAE;MAClEoL,SAAS,GAAGK,UAAU,CAACxN,aAAa,CAAC,cAAc,CAAC,GAAG,WAAW,GAAG,YAAY;IACrF;IACAuN,QAAQ,CAAC7N,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;MACnD8B,SAAS,EAAE,sBAAsB,IAC5B,IAAI,GAAGiP,SAAS,CAACQ,WAAW,CAAC,CAAC,GAAG,UAAU,GAAGR,SAAS,CAACQ,WAAW,CAAC,CAAC,CAAC;MAAE7L,SAAS,EAAE,QAAQ;MAChG1D,KAAK,EAAE;QAAEsP,QAAQ,EAAE,IAAI;QAAE,YAAY,EAAE;MAA0B;IACrE,CAAC,CAAC,CAAC;IACHH,QAAQ,CAAC7N,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;MACnD8B,SAAS,EAAE,qCAAqC;MAAE4D,SAAS,EAAE,QAAQ;MACrE1D,KAAK,EAAE;QAAEqP,KAAK,EAAE,IAAI,CAAChK,IAAI,CAACC,WAAW,CAAC,SAAS,CAAC;QAC5CgK,QAAQ,EAAE,IAAI;QAAE,YAAY,EAAE;MAA6B,CAAC;MAChEvP,MAAM,EAAE,IAAI,CAACV,aAAa,CAACmQ,iBAAiB,GAAG,EAAE,GAAG;IACxD,CAAC,CAAC,CAAC;IACHN,aAAa,CAAC5N,WAAW,CAAC6N,QAAQ,CAAC;IACnC,IAAI,IAAI,CAAC9P,aAAa,CAACoB,eAAe,EAAE;MACpCwO,QAAQ,CAAC3N,WAAW,CAAC4N,aAAa,CAAC;MACnCD,QAAQ,CAAC3N,WAAW,CAAC,IAAI,CAACmO,eAAe,CAAC,CAAC,CAAC;MAC5CP,aAAa,GAAGD,QAAQ;IAC5B;IACA,OAAOC,aAAa;EACxB,CAAC;EACD/P,KAAK,CAACgG,SAAS,CAACtB,iBAAiB,GAAG,UAAUzB,KAAK,EAAE;IACjD,IAAImL,SAAS,GAAG1O,cAAc,CAACuD,KAAK,CAAC,GAAG,IAAI,CAAChD,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,sCAAsC,GAC5GhD,iBAAiB,CAACwD,KAAK,CAAC,GAAG,GAAG,CAAC,GAAG,IAAI,CAAChD,MAAM,CAACmB,OAAO,CAACqB,aAAa,CAAC,sCAAsC,GAAGQ,KAAK,GAAG,GAAG,CAAC;IAC7H,IAAI,IAAI,CAAC/C,aAAa,CAACoB,eAAe,IAAI8M,SAAS,EAAE;MACjD;IACJ;IACA,IAAI7M,MAAM,GAAG,IAAI,CAACtB,MAAM,CAACuB,gBAAgB,CAACyB,KAAK,CAAC;IAChD,IAAI9D,iBAAiB,CAACoC,MAAM,CAAC,EAAE;MAC3B;IACJ;IACA,IAAIwO,aAAa,GAAG,IAAI,CAAClR,aAAa,CAACoE,KAAK,CAAC;IAC7C,IAAI,IAAI,CAAC/C,aAAa,CAACoB,eAAe,EAAE;MACpC,IAAIiP,KAAK,GAAG,IAAI,CAACnP,OAAO,CAACuC,sBAAsB,CAAC,kBAAkB,CAAC,CAACa,MAAM;MAC1EuL,aAAa,CAAC9N,YAAY,CAAC,OAAO,EAAEsO,KAAK,CAACC,QAAQ,CAAC,CAAC,CAAC;IACzD;IACA,IAAI,CAACpP,OAAO,CAACe,WAAW,CAAC4N,aAAa,CAAC;IACvC;EACJ,CAAC;;EACD/P,KAAK,CAACgG,SAAS,CAACsK,eAAe,GAAG,YAAY;IAC1C,OAAO,IAAI,CAACrQ,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;MACrC8B,SAAS,EAAE,iCAAiC;MAAE4D,SAAS,EAAE,QAAQ;MACjE1D,KAAK,EAAE;QAAEsP,QAAQ,EAAE,IAAI;QAAE,YAAY,EAAE;MAAoC,CAAC;MAC5EvP,MAAM,EAAE,IAAI,CAACV,aAAa,CAACmQ,iBAAiB,GAAG,EAAE,GAAG;IACxD,CAAC,CAAC;EACN,CAAC;EACDrQ,KAAK,CAACgG,SAAS,CAACmI,gBAAgB,GAAG,UAAUsC,QAAQ,EAAE;IACnD,IAAI,IAAI,CAACvQ,aAAa,CAACgK,gBAAgB,EAAE;MACrC,IAAIwG,OAAO,GAAG,EAAE,CAACjN,KAAK,CAACC,IAAI,CAAC,IAAI,CAACzD,MAAM,CAACiF,cAAc,CAAC,CAAC,CAACvB,sBAAsB,CAAC,iBAAiB,CAAC,CAAC;MACnG,KAAK,IAAIuF,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAG4C,OAAO,CAAClM,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;QAChD,IAAI,EAAGwH,OAAO,CAACxH,CAAC,CAAC,CAAClK,SAAS,CAACqC,QAAQ,CAAC,aAAa,CAAC,IAAMqP,OAAO,CAACxH,CAAC,CAAC,CAAClK,SAAS,CAACqC,QAAQ,CAAC,oBAAoB,CAAE,CAAC,EAAE;UAC5G,IAAIE,MAAM,GAAG,IAAI,CAACtB,MAAM,CAACiD,cAAc,CAACwN,OAAO,CAACxH,CAAC,CAAC,CAACxH,YAAY,CAAC,cAAc,CAAC,CAAC;UAChF,IAAI,CAAC,IAAI,CAACzB,MAAM,CAAC0Q,cAAc,IAAK,IAAI,CAAC1Q,MAAM,CAAC0Q,cAAc,IAAI,CAACpP,MAAM,CAACoP,cAAe,EAAE;YACvF,IAAID,OAAO,CAACxH,CAAC,CAAC,CAACvF,sBAAsB,CAAC,gBAAgB,CAAC,CAACa,MAAM,EAAE;cAC5DzF,MAAM,CAAC2R,OAAO,CAACxH,CAAC,CAAC,CAAC6E,gBAAgB,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7D;YACA,IAAI,CAAC0C,QAAQ,EAAE;cACXC,OAAO,CAACxH,CAAC,CAAC,CAAC/G,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;gBACrD8B,SAAS,EAAE,yBAAyB,IAC/B,IAAI,CAACT,aAAa,CAACiD,OAAO,CAACC,OAAO,CAAC7B,MAAM,CAAC0B,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,gCAAgC,GACnF,4BAA4B,CAAC;gBAAEpC,KAAK,EAAE;kBAAEsP,QAAQ,EAAE,IAAI;kBAAE,YAAY,EAAE;gBAAe;cACnG,CAAC,CAAC,CAAC;YACP;UACJ;QACJ;MACJ;IACJ;EACJ,CAAC;EACDnQ,KAAK,CAACgG,SAAS,CAACpB,sBAAsB,GAAG,UAAU3B,KAAK,EAAE;IACtD,IAAI,CAAC9D,iBAAiB,CAAC,IAAI,CAACyR,cAAc,CAAC3N,KAAK,CAAC,CAAC,EAAE;MAChD,IAAI2G,IAAI,GAAG,IAAI,CAACgH,cAAc,CAAC3N,KAAK,CAAC;MACrC,IAAI,IAAI,CAAC/C,aAAa,CAACoB,eAAe,EAAE;QACpC,IAAIuP,QAAQ,GAAGxR,YAAY,CAACuK,IAAI,EAAE,kBAAkB,CAAC;QACrD7K,MAAM,CAAC8R,QAAQ,CAAC;MACpB,CAAC,MACI;QACD9R,MAAM,CAAC6K,IAAI,CAAC;MAChB;MACA,IAAI,CAACyE,mBAAmB,CAAC,CAAC;IAC9B;IACA,IAAI,CAAC7N,gBAAgB,GAAG,KAAK;EACjC,CAAC;EACDR,KAAK,CAACgG,SAAS,CAACgB,iBAAiB,GAAG,UAAUhG,CAAC,EAAE;IAC7C,IAAIA,CAAC,CAAC8P,MAAM,KAAK,IAAI,CAACvL,aAAa,CAAC,CAAC,EAAE;MACnC;IACJ;IACA,KAAK,IAAI6C,EAAE,GAAG,CAAC,EAAEC,EAAE,GAAG0I,MAAM,CAACC,IAAI,CAAChQ,CAAC,CAACiQ,UAAU,CAAC,EAAE7I,EAAE,GAAGC,EAAE,CAAC7D,MAAM,EAAE4D,EAAE,EAAE,EAAE;MACnE,IAAI8I,IAAI,GAAG7I,EAAE,CAACD,EAAE,CAAC;MACjB,QAAQ8I,IAAI;QACR,KAAK,SAAS;UACV;UACA,IAAIhE,IAAI,GAAG,KAAK,CAAC;UACjB,IAAI,IAAI,CAACvH,cAAc,EAAE;YACrB,IAAI,CAAC,IAAI,CAACnF,gBAAgB,EAAE;cACxB,IAAI,CAAC,IAAI,CAACD,cAAc,EAAE;gBACtB,IAAI,CAAC8N,mBAAmB,CAAC,IAAI,CAAC;gBAC9B,KAAK,IAAI8C,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAClR,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACqB,MAAM,EAAE2M,CAAC,EAAE,EAAE;kBAC9D,IAAI,IAAI,CAAClR,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACgO,CAAC,CAAC,CAACtB,WAAW,EAAE;oBACjD,IAAI,CAAC5P,MAAM,CAACsP,YAAY,CAACpM,OAAO,CAACiB,MAAM,CAAC+M,CAAC,EAAE,CAAC,CAAC;oBAC7CA,CAAC,EAAE;kBACP;gBACJ;gBACA,KAAK,IAAIjI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAChJ,aAAa,CAACiD,OAAO,CAACqB,MAAM,EAAE0E,CAAC,EAAE,EAAE;kBACxD,IAAI,CAACkG,OAAO,GAAG,IAAI,CAAClP,aAAa,CAACiD,OAAO,CAAC+F,CAAC,CAAC;kBAC5C,IAAIZ,GAAG,GAAG,IAAI,CAACrI,MAAM,CAACuB,gBAAgB,CAAC,IAAI,CAAC4N,OAAO,CAAC;kBACpD9G,GAAG,CAACsD,OAAO,GAAG,IAAI,CAAC3L,MAAM,CAACC,aAAa,CAACiP,iBAAiB;kBACzD,IAAI,CAACM,oBAAoB,CAAC,IAAI,CAACL,OAAO,CAAC;kBACvC,IAAIlG,CAAC,GAAG,IAAI,CAAChJ,aAAa,CAACiD,OAAO,CAACqB,MAAM,GAAG,CAAC,EAAE;oBAC3C,IAAI,CAACE,iBAAiB,CAAC,IAAI,CAACxE,aAAa,CAACiD,OAAO,CAAC+F,CAAC,CAAC,CAAC;kBACzD;gBACJ;cACJ;cACAgE,IAAI,GAAG;gBACH1H,UAAU,EAAE,IAAI,CAAC4J,OAAO;gBAAEjC,WAAW,EAAEnM,CAAC,CAACiQ,UAAU,CAACC,IAAI,CAAC,CAAC1M,MAAM,GAAG,UAAU,GAAG,YAAY;gBAC5FkL,IAAI,EAAE/P,MAAM,CAACyR;cACjB,CAAC;YACL,CAAC,MACI;cACDlE,IAAI,GAAG;gBAAE1H,UAAU,EAAE,IAAI,CAAC4J,OAAO;gBAAEjC,WAAW,EAAE,YAAY;gBAAEuC,IAAI,EAAE/P,MAAM,CAACyR;cAAY,CAAC;YAC5F;YACA,IAAI,CAAC,IAAI,CAAClR,aAAa,CAACiP,iBAAiB,EAAE;cACvC,IAAIhM,OAAO,GAAGnC,CAAC,CAACqQ,aAAa,CAACH,IAAI,CAAC;cACnC,KAAK,IAAIhI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG/F,OAAO,CAACqB,MAAM,EAAE0E,CAAC,EAAE,EAAE;gBACrC,IAAIlI,CAAC,CAACiQ,UAAU,CAACC,IAAI,CAAC,CAAC9N,OAAO,CAACD,OAAO,CAAC+F,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;kBAC/C,IAAI,CAACjJ,MAAM,CAACuB,gBAAgB,CAAC2B,OAAO,CAAC+F,CAAC,CAAC,CAAC,CAAC0C,OAAO,GAAG,IAAI;gBAC3D;cACJ;YACJ;YACA,IAAI,CAAC3L,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC2R,YAAY,EAAEpE,IAAI,CAAC;UACjD;UACA;QACJ,KAAK,cAAc;UACf,IAAI,CAACmB,mBAAmB,CAAC,CAAC;UAC1B,IAAI,IAAI,CAACnO,aAAa,CAACsO,YAAY,EAAE;YACjC,IAAI,CAACpN,OAAO,CAACQ,KAAK,CAACiK,OAAO,GAAG,EAAE;UACnC,CAAC,MACI;YACD,IAAI,CAACzK,OAAO,CAACQ,KAAK,CAACiK,OAAO,GAAG,MAAM;UACvC;UACA;QACJ,KAAK,mBAAmB;UACpB,IAAI,CAAC0F,mBAAmB,CAAC,IAAI,CAACrR,aAAa,CAACiP,iBAAiB,CAAC;UAC9D,IAAI,CAAClP,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC2R,YAAY,EAAE;YAAEnE,WAAW,EAAE;UAAU,CAAC,CAAC;UACnE;QACJ,KAAK,mBAAmB;UACpB,IAAI,CAACqE,sBAAsB,CAAC,IAAI,CAACtR,aAAa,CAACmQ,iBAAiB,EAAE,iBAAiB,CAAC;UACpF;QACJ,KAAK,kBAAkB;UACnB,IAAI,CAACmB,sBAAsB,CAAC,IAAI,CAACtR,aAAa,CAACgK,gBAAgB,EAAE,sBAAsB,CAAC;UACxF,IAAI,CAACjK,MAAM,CAACwR,aAAa,CAAC,CAAC;UAC3B;QACJ,KAAK,mBAAmB;UACpB,IAAI,CAACxR,MAAM,CAACyR,aAAa,CAAC,CAAC;UAC3B;MACR;IACJ;EACJ,CAAC;EACD1R,KAAK,CAACgG,SAAS,CAACuL,mBAAmB,GAAG,UAAUI,SAAS,EAAE;IACvD,KAAK,IAAIzI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,IAAI,CAAChJ,aAAa,CAACiD,OAAO,CAACqB,MAAM,EAAE0E,CAAC,EAAE,EAAE;MACxD,IAAI,CAACjJ,MAAM,CAACuB,gBAAgB,CAAC,IAAI,CAACtB,aAAa,CAACiD,OAAO,CAAC+F,CAAC,CAAC,CAAC,CAAC0C,OAAO,GAAG+F,SAAS;IACnF;EACJ,CAAC;EACD3R,KAAK,CAACgG,SAAS,CAACwL,sBAAsB,GAAG,UAAUG,SAAS,EAAEhR,SAAS,EAAE;IACrE,IAAIwJ,OAAO,GAAG,EAAE,CAAC1G,KAAK,CAACC,IAAI,CAAC,IAAI,CAACtC,OAAO,CAACuC,sBAAsB,CAAChD,SAAS,CAAC,CAAC;IAC3E,KAAK,IAAIuI,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGiB,OAAO,CAAC3F,MAAM,EAAE0E,CAAC,EAAE,EAAE;MACrCiB,OAAO,CAACjB,CAAC,CAAC,CAACtH,KAAK,CAACiK,OAAO,GAAG8F,SAAS,GAAG,EAAE,GAAG,MAAM;IACtD;EACJ,CAAC;EACD3R,KAAK,CAACgG,SAAS,CAACW,iBAAiB,GAAG,UAAU3F,CAAC,EAAE;IAC7C,IAAIA,CAAC,CAAC8P,MAAM,KAAK,IAAI,CAACvL,aAAa,CAAC,CAAC,IAAIvE,CAAC,CAAC4Q,MAAM,EAAE;MAC/C,IAAI,CAAChK,MAAM,CAAC,CAAC;IACjB;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACI5H,KAAK,CAACgG,SAAS,CAAC+B,OAAO,GAAG,YAAY;IAClC,IAAI8J,WAAW,GAAG,IAAI,CAAC5R,MAAM,CAACmB,OAAO;IACrC,IAAI,CAACyQ,WAAW,IAAK,CAACA,WAAW,CAACpP,aAAa,CAAC,GAAG,GAAG1C,QAAQ,CAAC+R,UAAU,CAAC,IAAI,CAACD,WAAW,CAACpP,aAAa,CAAC,GAAG,GAAG1C,QAAQ,CAAC8C,WAAW,CAAE,EAAE;MACnI;IACJ;IACA;IACA,IAAI,CAAC,IAAI,CAAC5C,MAAM,CAACuG,WAAW,IAAI,CAAC,IAAI,CAACvG,MAAM,CAACkF,aAAa,KAAK,CAAC,IAAI,CAAClF,MAAM,CAAC8R,UAAU,EAAE;MACpF,IAAI,CAACC,aAAa,CAAC,CAAC;IACxB;IACA,IAAI,CAAC/J,mBAAmB,CAAC,CAAC;IAC1B,IAAI,CAACkG,gBAAgB,CAAC,IAAI,CAAC;IAC3B,IAAI,IAAI,CAAC/M,OAAO,CAAC6Q,UAAU,EAAE;MACzBlT,MAAM,CAAC,IAAI,CAACqC,OAAO,CAAC;IACxB;IACA;EACJ,CAAC;EACD;AACJ;AACA;AACA;AACA;EACIpB,KAAK,CAACgG,SAAS,CAACgM,aAAa,GAAG,YAAY;IACxC,IAAInO,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,SAAS,CAAC,IAAI,CAAC9D,aAAa,CAACiD,OAAO,CAAC,CAAC;IACjE,IAAI,CAACwC,cAAc,GAAG,KAAK;IAC3B,KAAK,IAAIuD,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAGjK,IAAI,CAACW,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;MAC7C,IAAIA,CAAC,KAAM4E,GAAG,GAAG,CAAE,EAAE;QACjB,IAAI,CAACnI,cAAc,GAAG,IAAI;MAC9B;MACA,IAAI,CAACtC,aAAa,CAACQ,IAAI,CAACqF,CAAC,CAAC,CAAC;IAC/B;IACA,IAAI,CAACvD,cAAc,GAAG,IAAI;EAC9B,CAAC;EACD;AACJ;AACA;AACA;AACA;AACA;EACI3F,KAAK,CAACgG,SAAS,CAACT,aAAa,GAAG,YAAY;IACxC,OAAO,OAAO;EAClB,CAAC;EACDvF,KAAK,CAACgG,SAAS,CAACqB,gBAAgB,GAAG,YAAY;IAC3C,IAAIpG,IAAI,GAAG,IAAI,CAAChB,MAAM;IACtB,IAAIiS,MAAM;IACV,IAAIrO,IAAI,GAAG5C,IAAI,CAACsO,YAAY,CAACpM,OAAO;IACpC,IAAIgP,KAAK,GAAGlR,IAAI,CAACf,aAAa,CAACiD,OAAO;IACtC,IAAIiP,UAAU,GAAG,IAAI,CAACnS,MAAM,CAACkI,UAAU,CAAC,CAAC,CAACvE,GAAG,CAAC,UAAUa,CAAC,EAAE;MAAE,OAAOA,CAAC,CAACxB,KAAK;IAAE,CAAC,CAAC;IAC/E,IAAI,CAACkL,gBAAgB,CAAC,CAAC;IACvB,KAAK,IAAIjF,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAGjK,IAAI,CAACW,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;MAC7C,IAAIkJ,UAAU,CAAChP,OAAO,CAACS,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,KAAK,CAAC,CAAC,EAAE;QAC1C;MACJ;MACAiP,MAAM,GAAGjR,IAAI,CAACoJ,sBAAsB,CAACxG,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC;MACnD,IAAI,CAAChC,IAAI,CAACmJ,YAAY,KAAK,IAAI,CAACjK,aAAa,CAACiD,OAAO,CAACS,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,GAAG,CAAC,CAAC,IACrE,IAAI,CAAC/C,aAAa,CAACiD,OAAO,CAACC,OAAO,CAACS,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;QACzDjE,SAAS,CAACkT,MAAM,CAACzP,aAAa,CAAC,kBAAkB,CAAC,EAAE,CAAC,aAAa,EAAE,kBAAkB,CAAC,EAAE,EAAE,CAAC;QAC5F,IAAIoB,IAAI,CAACW,MAAM,GAAG,CAAC,EAAE;UACjB0N,MAAM,CAACzP,aAAa,CAAC,kBAAkB,CAAC,CAACN,WAAW,CAAC,IAAI,CAAClC,MAAM,CAACpB,aAAa,CAAC,MAAM,EAAE;YAAE8B,SAAS,EAAE,cAAc;YAAE4D,SAAS,EAAE,CAAC2E,CAAC,GAAG,CAAC,EAAEsH,QAAQ,CAAC;UAAE,CAAC,CAAC,CAAC;QACzJ;MACJ,CAAC,MACI,IAAI,IAAI,CAACI,cAAc,CAAC/M,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,IAAI,IAAI,CAAC2N,cAAc,CAAC/M,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,CAACU,sBAAsB,CAAC,aAAa,CAAC,CAACa,MAAM,EAAE;QAC5H,IAAIX,IAAI,CAACqF,CAAC,CAAC,CAAC0G,SAAS,KAAK,WAAW,EAAE;UACnC5Q,SAAS,CAAC,IAAI,CAAC4R,cAAc,CAAC/M,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,CAACR,aAAa,CAAC,cAAc,CAAC,EAAE,CAAC,aAAa,EAAE,kBAAkB,CAAC,EAAE,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC;QAC3J,CAAC,MACI;UACDzD,SAAS,CAAC,IAAI,CAAC4R,cAAc,CAAC/M,IAAI,CAACqF,CAAC,CAAC,CAACjG,KAAK,CAAC,CAACR,aAAa,CAAC,cAAc,CAAC,EAAE,CAAC,cAAc,EAAE,mBAAmB,CAAC,EAAE,CAAC,aAAa,EAAE,kBAAkB,CAAC,CAAC;QAC3J;MACJ;IACJ;IACA,KAAK,IAAIyG,CAAC,GAAG,CAAC,EAAE4E,GAAG,GAAGqE,KAAK,CAAC3N,MAAM,EAAE0E,CAAC,GAAG4E,GAAG,EAAE5E,CAAC,EAAE,EAAE;MAC9C,IAAIkJ,UAAU,CAAChP,OAAO,CAAC+O,KAAK,CAACjJ,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE;QACrC;MACJ;MACAjI,IAAI,CAACoJ,sBAAsB,CAAC8H,KAAK,CAACjJ,CAAC,CAAC,CAAC,CAACjH,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC;IAC9E;EACJ,CAAC;EACDjC,KAAK,CAACgG,SAAS,CAAC4K,cAAc,GAAG,UAAU3N,KAAK,EAAE;IAC9C,IAAI,IAAI,CAAC7B,OAAO,IAAI,IAAI,CAACA,OAAO,CAACqB,aAAa,CAAC,mBAAmB,GAAGQ,KAAK,GAAG,IAAI,CAAC,EAAE;MAChF,OAAO,IAAI,CAAC7B,OAAO,CAACqB,aAAa,CAAC,mBAAmB,GAAGQ,KAAK,GAAG,IAAI,CAAC,CAAC0G,aAAa;IACvF;IACA,OAAO,IAAI;EACf,CAAC;EACD3J,KAAK,CAACgG,SAAS,CAAC8B,iBAAiB,GAAG,UAAUuK,UAAU,EAAE;IACtD,IAAIC,UAAU,GAAG,IAAI,CAACC,sBAAsB,CAACF,UAAU,CAAC;IACxD,IAAIG,OAAO,GAAG,IAAI,CAACzM,cAAc,CAAC0M,YAAY,CAACH,UAAU,EAAE,CAAC,CAAC,CAAC;IAC9D,IAAII,WAAW,GAAG,IAAI,CAACzS,MAAM,CAACuL,aAAa,CAAC,CAAC,CAAC8D,MAAM,CAAC,UAAUlG,GAAG,EAAE;MAAE,OAAO,CAACA,GAAG,CAAC2C,SAAS;IAAE,CAAC,CAAC;IAC/F,IAAI4G,iBAAiB,GAAGH,OAAO,CAAClD,MAAM,CAAC,UAAUsD,IAAI,EAAE;MAAE,OAAO,CAACA,IAAI,CAAC7G,SAAS;IAAE,CAAC,CAAC;IACnF,IAAI,IAAI,CAAC9L,MAAM,CAAC4S,OAAO,IAAI,IAAI,CAAC5S,MAAM,CAAC6S,KAAK,EAAE;MAC1C,IAAI,CAAC7S,MAAM,CAAC8S,eAAe,CAAC,CAAC,qBAAqB,EAAE,sBAAsB,EAAE,gBAAgB,CAAC,CAAC;IAClG;IACA,KAAK,IAAI7J,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGyJ,iBAAiB,CAACnO,MAAM,EAAE0E,CAAC,EAAE,EAAE;MAC/C,IAAIE,GAAG,GAAGuJ,iBAAiB,CAACzJ,CAAC,CAAC;MAC9B,IAAIgD,KAAK,GAAG9C,GAAG,CAAC8C,KAAK,CAACoD,MAAM,CAAC,UAAUlD,IAAI,EAAE;QAAE,OAAOA,IAAI,CAACC,UAAU;MAAE,CAAC,CAAC;MACzE,IAAIa,IAAI,GAAG;QAAEhB,KAAK,EAAEA,KAAK;QAAE0G,IAAI,EAAExJ,GAAG,CAACwJ,IAAI;QAAEI,OAAO,EAAEN,WAAW,CAACxJ,CAAC,CAAC,GAAGwJ,WAAW,CAACxJ,CAAC,CAAC,CAAChH,GAAG,GAAG;MAAG,CAAC;MAC9F,IAAI,CAACjC,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAACsT,oBAAoB,EAAE/F,IAAI,CAAC;IACzD;EACJ,CAAC;EACDlN,KAAK,CAACgG,SAAS,CAACuM,sBAAsB,GAAG,UAAUF,UAAU,EAAE;IAC3D,IAAIa,WAAW,GAAGb,UAAU,YAAYc,KAAK,GAAGd,UAAU,GAAG,EAAE;IAC/D,IAAI1J,IAAI,GAAG,IAAI,CAAC1I,MAAM,CAACuL,aAAa,CAAC,CAAC;IACtC,IAAI4H,QAAQ,GAAG,IAAI,CAACnT,MAAM,CAACoT,qBAAqB,CAAC,CAAC;IAClD,IAAIC,WAAW,GAAG,EAAE;IACpB,IAAIC,QAAQ,GAAG5K,IAAI,CAAC/E,GAAG,CAAC,UAAUwF,GAAG,EAAE;MACnC,IAAIA,GAAG,CAACoK,IAAI,KAAK,QAAQ,EAAE;QACvBF,WAAW,CAAChP,IAAI,CAAC8E,GAAG,CAACwJ,IAAI,CAAC;MAC9B;MACA,OAAOxJ,GAAG,CAACqK,OAAO,YAAY1C,MAAM,GAAG3H,GAAG,CAACqK,OAAO,GAAGrK,GAAG,CAACwJ,IAAI;IACjE,CAAC,CAAC;IACF,IAAI3P,KAAK,GAAG,IAAI,CAAChD,MAAM,CAACyT,uBAAuB,CAAC,CAAC,CAAC,CAAC,CAAC;IACpDH,QAAQ,GAAGL,WAAW,CAAC1O,MAAM,KAAK,CAAC,GAAG+O,QAAQ,GAAGL,WAAW;IAC5D,IAAIS,SAAS,GAAGP,QAAQ,CAACxP,GAAG,CAAC,UAAUgQ,IAAI,EAAE;MACzC,IAAIC,OAAO,GAAG/T,QAAQ,CAACgU,SAAS,CAAC7Q,KAAK,EAAE2Q,IAAI,CAAC;MAC7C,IAAIG,KAAK;MACT,IAAIC,MAAM,GAAGT,QAAQ,CAACpH,IAAI,CAAC,UAAU8H,KAAK,EAAE;QACxCF,KAAK,GAAGE,KAAK;QACb,OAAOJ,OAAO,KAAK/T,QAAQ,CAACgU,SAAS,CAAC7Q,KAAK,EAAEgR,KAAK,CAAC;MACvD,CAAC,CAAC;MACF,OAAOD,MAAM,GAAGD,KAAK,GAAGH,IAAI;IAChC,CAAC,CAAC;IACF,IAAIM,KAAK,GAAG7B,UAAU;IACtB,IAAI,EAAE6B,KAAK,CAACxE,IAAI,IAAIwE,KAAK,CAACxE,IAAI,KAAK,QAAQ,CAAC,IAAI4D,WAAW,CAAC9O,MAAM,GAAG,CAAC,EAAE;MACpE,KAAK,IAAI0E,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGoK,WAAW,CAAC9O,MAAM,EAAE0E,CAAC,EAAE,EAAE;QACzC,IAAIqH,KAAK,GAAGoD,SAAS,CAACvQ,OAAO,CAACkQ,WAAW,CAACpK,CAAC,CAAC,CAAC;QAC7CyK,SAAS,CAACvP,MAAM,CAACmM,KAAK,EAAE,CAAC,CAAC;MAC9B;IACJ;IACA,IAAI+B,UAAU,GAAG,EAAE;IACnB,IAAI6B,aAAa,GAAG,IAAI,CAAClU,MAAM,CAACqS,UAAU;IAC1C,KAAK,IAAInB,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGgD,aAAa,CAAC3P,MAAM,EAAE2M,CAAC,EAAE,EAAE;MAC3C,IAAI/H,GAAG,GAAG+K,aAAa,CAAChD,CAAC,CAAC;MAC1B,KAAK,IAAIiD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGhL,GAAG,CAACjG,OAAO,CAACqB,MAAM,EAAE4P,CAAC,EAAE,EAAE;QACzC,IAAIC,IAAI,GAAG,CAAC,CAAC;QACb,IAAI3E,IAAI,GAAGtG,GAAG,CAACjG,OAAO,CAACiR,CAAC,CAAC,CAAC1E,IAAI,CAACc,QAAQ,CAAC,CAAC;QACzC6D,IAAI,GAAG;UAAE3E,IAAI,EAAEA,IAAI,CAACU,WAAW,CAAC,CAAC;UAAEnN,KAAK,EAAEmG,GAAG,CAACjG,OAAO,CAACiR,CAAC,CAAC,CAACnR;QAAM,CAAC;QAChEqP,UAAU,CAAChO,IAAI,CAAC+P,IAAI,CAAC;MACzB;IACJ;IACA,IAAIC,MAAM;IACV,IAAIC,MAAM;IACV,IAAIC,WAAW,GAAG,IAAI,CAACvU,MAAM,CAACC,aAAa,CAACiD,OAAO;IACnD,KAAK,IAAIsR,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,WAAW,CAAChQ,MAAM,EAAEiQ,CAAC,EAAE,EAAE;MACzCF,MAAM,GAAGD,MAAM,GAAGA,MAAM,GAAGX,SAAS;MACpCW,MAAM,GAAGxU,QAAQ,CAAC4U,KAAK,CAACH,MAAM,EAAEC,WAAW,CAACC,CAAC,CAAC,EAAEnC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC;IAC3E;IACA,OAAOgC,MAAM;EACjB,CAAC;EACDtU,KAAK,CAACgG,SAAS,CAACgC,YAAY,GAAG,UAAUkF,IAAI,EAAE;IAC3C,IAAIhL,GAAG,GAAGgL,IAAI,CAAChL,GAAG;IAClB,IAAI8I,QAAQ,GAAGkC,IAAI,CAAClC,QAAQ;IAC5B,IAAIrC,IAAI,GAAG,IAAI,CAAC1I,MAAM,CAACuL,aAAa,CAAC,CAAC;IACtC,KAAK,IAAItC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGP,IAAI,CAACnE,MAAM,EAAE0E,CAAC,EAAE,EAAE;MAClC,IAAIE,GAAG,GAAGT,IAAI,CAACO,CAAC,CAAC;MACjB,IAAIE,GAAG,CAAClH,GAAG,KAAKA,GAAG,IAAI/C,iBAAiB,CAAC+C,GAAG,CAAC,EAAE;QAC3CkH,GAAG,CAAC4B,QAAQ,GAAGA,QAAQ;QACvB,IAAI2J,OAAO,GAAG,SAAAA,CAAUxD,CAAC,EAAE;UACvB,IAAIyD,QAAQ,GAAGjM,IAAI,CAACwI,CAAC,CAAC;UACtB,IAAI0D,aAAa,GAAG,KAAK,CAAC;UAC1B,IAAID,QAAQ,CAAC9I,SAAS,KAAK1C,GAAG,CAAClH,GAAG,EAAE;YAChC2S,aAAa,GAAGlM,IAAI,CAAC2G,MAAM,CAAC,UAAUwF,CAAC,EAAE;cAAE,OAAOA,CAAC,CAAC5S,GAAG,KAAK0S,QAAQ,CAAC9I,SAAS;YAAE,CAAC,CAAC,CAAC,CAAC,CAAC;UACzF;UACA,IAAI8I,QAAQ,CAAC9I,SAAS,KAAK1C,GAAG,CAAClH,GAAG,EAAE;YAChC0S,QAAQ,CAAChJ,OAAO,GAAGxC,GAAG,CAAC4B,QAAQ;UACnC,CAAC,MACI,IAAI,CAAC7L,iBAAiB,CAAC0V,aAAa,CAAC,IAAID,QAAQ,CAAC9I,SAAS,KAAK+I,aAAa,CAAC3S,GAAG,EAAE;YACpF,IAAI2S,aAAa,CAAC7J,QAAQ,IAAI6J,aAAa,CAACjJ,OAAO,KAAK,IAAI,EAAE;cAC1DgJ,QAAQ,CAAChJ,OAAO,GAAG,IAAI;YAC3B,CAAC,MACI,IAAIiJ,aAAa,CAAC7J,QAAQ,IAAI6J,aAAa,CAACjJ,OAAO,KAAK,KAAK,EAAE;cAChEgJ,QAAQ,CAAChJ,OAAO,GAAG,KAAK;YAC5B;UACJ;UACA,IAAIzM,iBAAiB,CAAC+C,GAAG,CAAC,EAAE;YACxB,OAAO,OAAO;UAClB;QACJ,CAAC;QACD,KAAK,IAAIiP,CAAC,GAAGjI,CAAC,GAAG,CAAC,EAAEiI,CAAC,GAAGxI,IAAI,CAACnE,MAAM,EAAE2M,CAAC,EAAE,EAAE;UACtC,IAAI4D,OAAO,GAAGJ,OAAO,CAACxD,CAAC,CAAC;UACxB,IAAI4D,OAAO,KAAK,OAAO,EACnB;QACR;MACJ;IACJ;IACA,IAAI,CAAC9U,MAAM,CAACqM,MAAM,CAAC3M,MAAM,CAAC8H,YAAY,EAAE;MAAEkB,IAAI,EAAEA,IAAI;MAAEuE,IAAI,EAAE;QAAE8H,QAAQ,EAAE,KAAK;QAAErM,IAAI,EAAEA;MAAK;IAAE,CAAC,CAAC;EAClG,CAAC;EACD,OAAO3I,KAAK;AAChB,CAAC,CAAC,CAAE;AACJ,SAASA,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}