{"ast":null,"code":"import { Draggable, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { remove, closest as closestElement, classList, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, removeElement, getPosition, addRemoveActiveClasses, isActionPrevent } from '../base/util';\nimport { setRowsInTbody, resetRowIndex } from '../base/util';\nimport * as events from '../base/constant';\nimport { Scroll } from '../actions/scroll';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * Reorder module is used to handle row reordering.\n *\n * @hidden\n */\nvar RowDD = /** @class */function () {\n  /**\n   * Constructor for the Grid print module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @hidden\n   */\n  function RowDD(parent) {\n    var _this = this;\n    this.selectedRows = [];\n    this.isOverflowBorder = true;\n    this.selectedRowColls = [];\n    this.isRefresh = true;\n    this.isReplaceDragEle = true;\n    this.istargetGrid = false;\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    this.helper = function (e) {\n      var gObj = _this.parent;\n      var target = _this.draggable.currentStateTarget;\n      var visualElement = _this.parent.createElement('div', {\n        className: 'e-cloneproperties e-draganddrop e-grid e-dragclone',\n        styles: 'height:\"auto\", z-index:2, width:' + gObj.element.offsetWidth\n      });\n      var table = _this.parent.createElement('table', {\n        styles: 'width:' + gObj.element.offsetWidth\n      });\n      var tbody = _this.parent.createElement(literals.tbody);\n      if (document.getElementsByClassName('e-griddragarea').length || gObj.rowDropSettings.targetID && (!target.classList.contains('e-selectionbackground') && gObj.selectionSettings.type !== 'Single' || !parentsUntil(target, 'e-rowcell')) || !gObj.rowDropSettings.targetID && !parentsUntil(target, 'e-rowdragdrop')) {\n        return false;\n      }\n      if (gObj.rowDropSettings.targetID && gObj.selectionSettings.mode === 'Row' && gObj.selectionSettings.type === 'Single') {\n        gObj.selectRow(parseInt(_this.draggable.currentStateTarget.parentElement.getAttribute(literals.ariaRowIndex), 10));\n      }\n      _this.startedRow = closestElement(target, 'tr').cloneNode(true);\n      var frzCols = _this.parent.isFrozenGrid();\n      if (frzCols) {\n        var rowIndex = parseInt(closestElement(target, 'tr').getAttribute(literals.ariaRowIndex), 10);\n        _this.startedRow.innerHTML = '';\n        _this.startedRow.innerHTML += gObj.getRowByIndex(rowIndex).innerHTML;\n        _this.startedRow.innerHTML += gObj.getMovableRowByIndex(rowIndex).innerHTML;\n        if (gObj.getFrozenMode() === literals.leftRight) {\n          _this.startedRow.innerHTML += gObj.getFrozenRightRowByIndex(rowIndex).innerHTML;\n        }\n      }\n      _this.processArgs(target);\n      var args = {\n        selectedRow: _this.rows,\n        dragelement: target,\n        cloneElement: visualElement,\n        cancel: false,\n        data: _this.rowData\n      };\n      var selectedRows = gObj.getSelectedRows();\n      gObj.trigger(events.rowDragStartHelper, args);\n      var cancel = 'cancel';\n      if (args[cancel]) {\n        return false;\n      }\n      removeElement(_this.startedRow, '.e-indentcell');\n      removeElement(_this.startedRow, '.e-detailrowcollapse');\n      removeElement(_this.startedRow, '.e-detailrowexpand');\n      _this.removeCell(_this.startedRow, literals.gridChkBox);\n      var exp = new RegExp('e-active', 'g'); //high contrast issue\n      _this.startedRow.innerHTML = _this.startedRow.innerHTML.replace(exp, '');\n      tbody.appendChild(_this.startedRow);\n      if (gObj.getSelectedRowIndexes().length > 1 && _this.startedRow.hasAttribute('aria-selected')) {\n        var index = gObj.getFrozenMode() === literals.leftRight ? 3 : 2;\n        var dropCountEle = _this.parent.createElement('span', {\n          className: 'e-dropitemscount',\n          innerHTML: frzCols ? '' + selectedRows.length / index : '' + selectedRows.length\n        });\n        visualElement.appendChild(dropCountEle);\n      }\n      var ele = closestElement(target, 'tr').querySelector('.e-icon-rowdragicon');\n      if (ele) {\n        ele.classList.add('e-dragstartrow');\n      }\n      table.appendChild(tbody);\n      visualElement.appendChild(table);\n      gObj.element.appendChild(visualElement);\n      return visualElement;\n    };\n    this.dragStart = function (e) {\n      var gObj = _this.parent;\n      document.body.classList.add('e-prevent-select');\n      if (document.getElementsByClassName('e-griddragarea').length) {\n        return;\n      }\n      var target = e.target;\n      var spanCssEle = _this.parent.element.querySelector('.e-dropitemscount');\n      if (_this.parent.getSelectedRecords().length > 1 && spanCssEle) {\n        spanCssEle.style.left = _this.parent.element.querySelector('.e-cloneproperties table').offsetWidth - 5 + 'px';\n      }\n      _this.processArgs(target);\n      gObj.trigger(events.rowDragStart, {\n        rows: _this.rows,\n        target: e.target,\n        draggableType: 'rows',\n        fromIndex: parseInt(_this.rows[0].getAttribute(literals.ariaRowIndex), 10),\n        data: Object.keys(_this.rowData[0]).length > 0 ? _this.rowData : _this.currentViewData()\n      });\n      _this.dragStartData = _this.rowData;\n      var dropElem = document.getElementById(gObj.rowDropSettings.targetID);\n      if (gObj.rowDropSettings.targetID && dropElem && dropElem.ej2_instances && dropElem.ej2_instances[0].getModuleName() === 'grid') {\n        dropElem.ej2_instances[0].getContent().classList.add('e-allowRowDrop');\n      }\n    };\n    this.drag = function (e) {\n      var gObj = _this.parent;\n      _this.isDropGrid = _this.parent;\n      _this.istargetGrid = false;\n      if (_this.parent.rowDropSettings.targetID) {\n        var dropElement = document.getElementById(gObj.rowDropSettings.targetID);\n        _this.isDropGrid = dropElement.ej2_instances[0];\n        if (parentsUntil(e.target, 'e-grid')) {\n          _this.istargetGrid = _this.parent.rowDropSettings.targetID === parentsUntil(e.target, 'e-grid').id;\n        }\n      }\n      var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n      var target = _this.getElementFromPosition(cloneElement, e.event);\n      classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur', 'e-movecur', 'e-grabcur']);\n      _this.isOverflowBorder = true;\n      _this.hoverState = gObj.enableHover;\n      var trElement = parentsUntil(target, 'e-grid') ? closestElement(e.target, 'tr') : null;\n      if (!e.target) {\n        return;\n      }\n      _this.processArgs(target);\n      var args = {\n        rows: _this.rows,\n        target: target,\n        draggableType: 'rows',\n        data: _this.rowData,\n        originalEvent: e,\n        cancel: false\n      };\n      gObj.trigger(events.rowDrag, args);\n      _this.stopTimer();\n      if (args.cancel) {\n        return;\n      }\n      gObj.element.classList.add('e-rowdrag');\n      _this.dragTarget = trElement && parentsUntil(target, 'e-grid').id === cloneElement.parentElement.id ? parseInt(trElement.getAttribute(literals.ariaRowIndex), 10) : parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n      if (gObj.rowDropSettings.targetID) {\n        if (!parentsUntil(target, 'e-grid') || parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(target, 'e-grid').id) {\n          classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n        } else {\n          classList(cloneElement, ['e-grabcur'], ['e-notallowedcur']);\n        }\n      } else {\n        var elem = parentsUntil(target, 'e-grid');\n        if (elem && elem.id === cloneElement.parentElement.id) {\n          classList(cloneElement, ['e-movecur'], ['e-defaultcur']);\n        } else {\n          classList(cloneElement, ['e-notallowedcur'], ['e-movecur']);\n        }\n      }\n      if (parentsUntil(_this.isDropGrid.element, 'e-grid')) {\n        if ((!_this.isDropGrid.groupSettings.columns.length || e.target.classList.contains('e-selectionbackground')) && !_this.isDropGrid.element.querySelector('.e-emptyrow')) {\n          if (parentsUntil(target, 'e-grid') && parentsUntil(target, 'e-grid').id === _this.isDropGrid.element.id) {\n            _this.updateScrollPostion(e.event);\n          }\n          if ((_this.isOverflowBorder || _this.parent.frozenRows > _this.dragTarget) && (parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10) !== _this.dragTarget || _this.istargetGrid) || _this.istargetGrid && trElement && _this.isDropGrid.getRowByIndex(_this.isDropGrid.getCurrentViewRecords().length - 1).getAttribute('data-uid') === trElement.getAttribute('data-uid')) {\n            _this.moveDragRows(e, _this.startedRow, trElement);\n          } else {\n            var islastRowIndex = void 0;\n            if (_this.parent.enableVirtualization) {\n              islastRowIndex = trElement && parseInt(trElement.getAttribute(literals.ariaRowIndex), 10) === _this.parent.renderModule.data.dataManager.dataSource.json.length - 1;\n            } else {\n              var lastRowUid = _this.parent.getRowByIndex(_this.parent.getCurrentViewRecords().length - 1).getAttribute('data-uid');\n              islastRowIndex = trElement && lastRowUid === trElement.getAttribute('data-uid') && lastRowUid !== _this.startedRow.getAttribute('data-uid');\n            }\n            if (islastRowIndex && !_this.parent.rowDropSettings.targetID) {\n              var bottomborder = _this.parent.createElement('div', {\n                className: 'e-lastrow-dragborder'\n              });\n              var gridcontentEle = _this.parent.getContent();\n              bottomborder.style.width = _this.parent.element.offsetWidth - _this.getScrollWidth() + 'px';\n              if (_this.parent.enableVirtualization) {\n                bottomborder.style.zIndex = '1';\n              }\n              if (!gridcontentEle.getElementsByClassName('e-lastrow-dragborder').length) {\n                gridcontentEle.classList.add('e-grid-relative');\n                gridcontentEle.appendChild(bottomborder);\n                bottomborder.style.bottom = _this.getScrollWidth() + 'px';\n              }\n            }\n            _this.removeBorder(trElement);\n          }\n        }\n        if (target && target.classList.contains(literals.content) && !_this.isDropGrid.element.querySelector('.e-emptyrow') && _this.istargetGrid) {\n          _this.removeBorder(trElement);\n          var rowIndex = _this.isDropGrid.getCurrentViewRecords().length - 1;\n          var selector = '.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse';\n          var rowElement = [];\n          rowElement = [].slice.call(_this.isDropGrid.getRowByIndex(rowIndex).querySelectorAll(selector));\n          if (_this.isDropGrid.isFrozenGrid()) {\n            rowElement = _this.borderRowElement(rowIndex, selector);\n          }\n          if (rowElement.length > 0) {\n            addRemoveActiveClasses(rowElement, true, 'e-dragborder');\n          }\n        }\n      }\n    };\n    this.dragStop = function (e) {\n      document.body.classList.remove('e-prevent-select');\n      if (isActionPrevent(_this.parent)) {\n        _this.parent.notify(events.preventBatch, {\n          instance: _this,\n          handler: _this.processDragStop,\n          arg1: e\n        });\n      } else {\n        _this.processDragStop(e);\n      }\n    };\n    this.processDragStop = function (e) {\n      var gObj = _this.parent;\n      if (_this.parent.isDestroyed) {\n        return;\n      }\n      var targetEle = _this.getElementFromPosition(e.helper, e.event);\n      var target = targetEle && !targetEle.classList.contains('e-dlg-overlay') ? targetEle : e.target;\n      gObj.element.classList.remove('e-rowdrag');\n      var dropElement = document.getElementById(gObj.rowDropSettings.targetID);\n      if (gObj.rowDropSettings.targetID && dropElement && dropElement.ej2_instances && dropElement.ej2_instances[0].getModuleName() === 'grid') {\n        dropElement.ej2_instances[0].getContent().classList.remove('e-allowRowDrop');\n      }\n      if (parentsUntil(_this.isDropGrid.element, 'e-grid')) {\n        _this.stopTimer();\n        _this.isDropGrid.enableHover = _this.hoverState;\n        _this.isDropGrid.getContent().classList.remove('e-grid-relative');\n        _this.removeBorder(targetEle);\n        var stRow = _this.isDropGrid.element.querySelector('.e-dragstartrow');\n        if (stRow) {\n          stRow.classList.remove('e-dragstartrow');\n        }\n      }\n      _this.processArgs(target);\n      var args = {\n        target: target,\n        draggableType: 'rows',\n        cancel: false,\n        fromIndex: parseInt(_this.rows[0].getAttribute(literals.ariaRowIndex), 10),\n        dropIndex: _this.dragTarget,\n        rows: _this.rows,\n        data: Object.keys(_this.dragStartData[0]).length > 0 ? _this.dragStartData : _this.currentViewData()\n      };\n      gObj.trigger(events.rowDrop, args, function () {\n        if (!(parentsUntil(target, literals.row) || parentsUntil(target, 'e-emptyrow') || parentsUntil(target, literals.gridContent)) || args.cancel) {\n          _this.dragTarget = null;\n          remove(e.helper);\n          return;\n        }\n        _this.isRefresh = false;\n        var selectedIndexes = _this.parent.getSelectedRowIndexes();\n        if (gObj.isRowDragable()) {\n          if (!_this.parent.rowDropSettings.targetID && _this.startedRow.querySelector('td.e-selectionbackground') && selectedIndexes.length > 1 && selectedIndexes.length !== _this.parent.getCurrentViewRecords().length) {\n            _this.reorderRows(selectedIndexes, args.dropIndex);\n          } else {\n            _this.reorderRows([parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10)], _this.dragTarget);\n          }\n          _this.dragTarget = null;\n          if (!gObj.rowDropSettings.targetID) {\n            remove(e.helper);\n            if (gObj.enableVirtualization) {\n              gObj.refresh();\n            } else {\n              _this.rowOrder(args);\n            }\n          }\n        }\n        _this.isRefresh = true;\n      });\n    };\n    this.removeCell = function (targetRow, className) {\n      return [].slice.call(targetRow.querySelectorAll('td')).filter(function (cell) {\n        if (cell.classList.contains(className)) {\n          targetRow.deleteCell(cell.cellIndex);\n        }\n      });\n    };\n    this.parent = parent;\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.initialEnd, this.initializeDrag, this);\n    this.parent.on(events.columnDrop, this.columnDrop, this);\n    this.parent.on(events.rowDragAndDropComplete, this.onActionComplete, this);\n    this.onDataBoundFn = this.onDataBound.bind(this);\n    this.parent.addEventListener(events.dataBound, this.onDataBoundFn);\n    this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n    this.parent.on(events.destroy, this.destroy, this);\n  }\n  RowDD.prototype.refreshRow = function (args, tbody, mtbody, frTbody, target, mTarget, frTarget) {\n    var gObj = this.parent;\n    var frzCols = gObj.isFrozenGrid();\n    var isLeftRight = gObj.getFrozenMode() === literals.leftRight;\n    var tbodyMovableHeader;\n    var tbodyMovableContent;\n    var frHdr;\n    var frCnt;\n    var tbodyContent = gObj.getContentTable().querySelector(literals.tbody);\n    var tbodyHeader = gObj.getHeaderTable().querySelector(literals.tbody);\n    if (frzCols) {\n      tbodyMovableHeader = gObj.getMovableHeaderTbody();\n      tbodyMovableContent = gObj.getMovableContentTbody();\n      if (isLeftRight) {\n        frHdr = gObj.getFrozenRightHeaderTbody();\n        frCnt = gObj.getFrozenRightContentTbody();\n      }\n    }\n    var index = gObj.getFrozenMode() === literals.leftRight ? 3 : 2;\n    for (var i = 0, len = args.rows.length; i < len; i++) {\n      if (frzCols) {\n        if (i % index === 0) {\n          tbody.insertBefore(args.rows[i], target);\n        } else if (i % index === 1) {\n          mtbody.insertBefore(args.rows[i], mTarget);\n        } else {\n          frTbody.insertBefore(args.rows[i], frTarget);\n        }\n      } else {\n        tbody.insertBefore(args.rows[i], target);\n      }\n    }\n    var tr = [].slice.call(tbody.getElementsByClassName(literals.row));\n    var mtr;\n    var frTr;\n    if (frzCols) {\n      mtr = [].slice.call(mtbody.getElementsByClassName(literals.row));\n      if (isLeftRight) {\n        frTr = [].slice.call(frTbody.getElementsByClassName(literals.row));\n      }\n    }\n    this.refreshData(tr, mtr, frTr);\n    if (this.parent.frozenRows) {\n      var _loop_1 = function (i, len) {\n        if (i < this_1.parent.frozenRows) {\n          setRowsInTbody(tbodyHeader, tbodyMovableHeader, frHdr, tr, mtr, frTr, function (tbody, rows) {\n            tbody.appendChild(rows[i]);\n          });\n        } else {\n          setRowsInTbody(tbodyContent, tbodyMovableContent, frCnt, tr, mtr, frTr, function (tbody, rows) {\n            tbody.appendChild(rows[i]);\n          });\n        }\n      };\n      var this_1 = this;\n      for (var i = 0, len = tr.length; i < len; i++) {\n        _loop_1(i, len);\n      }\n    }\n  };\n  RowDD.prototype.updateFrozenRowreOrder = function (args) {\n    var gObj = this.parent;\n    var tbodyMovH;\n    var tbodyMovC;\n    var tbodyFrH;\n    var tbodyFrC;\n    var frzCols = this.parent.isFrozenGrid();\n    var isLeftRight = gObj.getFrozenMode() === literals.leftRight;\n    var tbodyC = gObj.getContentTable().querySelector(literals.tbody);\n    var tbodyH = gObj.getHeaderTable().querySelector(literals.tbody);\n    if (frzCols) {\n      tbodyMovH = gObj.getMovableHeaderTbody();\n      tbodyMovC = gObj.getMovableContentTbody();\n      if (isLeftRight) {\n        tbodyFrH = gObj.getFrozenRightHeaderTbody();\n        tbodyFrC = gObj.getFrozenRightContentTbody();\n      }\n    }\n    var tr = [].slice.call(tbodyH.getElementsByClassName(literals.row)).concat([].slice.call(tbodyC.getElementsByClassName(literals.row)));\n    var mtr;\n    var frTr;\n    if (frzCols) {\n      mtr = [].slice.call(tbodyMovH.getElementsByClassName(literals.row)).concat([].slice.call(tbodyMovC.getElementsByClassName(literals.row)));\n      if (isLeftRight) {\n        frTr = [].slice.call(tbodyFrH.getElementsByClassName(literals.row)).concat([].slice.call(tbodyFrC.getElementsByClassName(literals.row)));\n      }\n    }\n    var tbody = gObj.createElement(literals.tbody);\n    var mtbody = gObj.createElement(literals.tbody);\n    var frTbody = gObj.createElement(literals.tbody);\n    this.parent.clearSelection();\n    var targetRows = this.refreshRowTarget(args);\n    for (var i = 0, len = tr.length; i < len; i++) {\n      tbody.appendChild(tr[i]);\n      if (frzCols) {\n        mtbody.appendChild(mtr[i]);\n        if (isLeftRight) {\n          frTbody.appendChild(frTr[i]);\n        }\n      }\n    }\n    this.refreshRow(args, tbody, mtbody, frTbody, targetRows.target, targetRows.mTarget, targetRows.frTarget);\n  };\n  RowDD.prototype.refreshRowTarget = function (args) {\n    var gObj = this.parent;\n    var mTr;\n    var frTr;\n    var targetIdx = parseInt(args.target.parentElement.getAttribute(literals.ariaRowIndex), 10);\n    if (args.fromIndex < args.dropIndex || args.fromIndex === args.dropIndex) {\n      targetIdx = targetIdx + 1;\n    }\n    var tr = gObj.getRowByIndex(targetIdx);\n    if (gObj.isFrozenGrid()) {\n      mTr = gObj.getMovableRowByIndex(targetIdx);\n      if (gObj.getFrozenMode() === literals.leftRight) {\n        frTr = gObj.getFrozenRightRowByIndex(targetIdx);\n      }\n    }\n    var rows = {\n      target: tr,\n      mTarget: mTr,\n      frTarget: frTr\n    };\n    return rows;\n  };\n  RowDD.prototype.updateFrozenColumnreOrder = function (args) {\n    var gObj = this.parent;\n    var mtbody;\n    var frTbody;\n    var frzCols = this.parent.isFrozenGrid();\n    var tbody = gObj.getContentTable().querySelector(literals.tbody);\n    if (frzCols) {\n      mtbody = gObj.getMovableContentTbody();\n      if (gObj.getFrozenMode() === literals.leftRight) {\n        frTbody = gObj.getFrozenRightContentTbody();\n      }\n    }\n    this.parent.clearSelection();\n    var targetRows = this.refreshRowTarget(args);\n    this.refreshRow(args, tbody, mtbody, frTbody, targetRows.target, targetRows.mTarget, targetRows.frTarget);\n  };\n  RowDD.prototype.refreshData = function (tr, mtr, frTr) {\n    var rowObj = {};\n    var movobj = {};\n    var frObj = {};\n    var recordobj = {};\n    var rowObjects = this.parent.getRowsObject();\n    var movbObject = this.parent.getMovableRowsObject();\n    var frRightObject = this.parent.getFrozenRightRowsObject();\n    var currentViewData = this.parent.getCurrentViewRecords();\n    for (var i = 0, len = tr.length; i < len; i++) {\n      var index = parseInt(tr[i].getAttribute(literals.ariaRowIndex), 10);\n      rowObj[i] = rowObjects[index];\n      recordobj[i] = currentViewData[index];\n      if (this.parent.isFrozenGrid()) {\n        movobj[i] = movbObject[index];\n        if (frTr) {\n          frObj[i] = frRightObject[index];\n        }\n      }\n    }\n    var rows = this.parent.getRows();\n    var movbRows;\n    var frRightRows;\n    if (this.parent.isFrozenGrid()) {\n      movbRows = this.parent.getMovableRows();\n      if (frTr) {\n        frRightRows = this.parent.getFrozenRightRows();\n      }\n    }\n    for (var i = 0, len = tr.length; i < len; i++) {\n      rows[i] = tr[i];\n      rowObjects[i] = rowObj[i];\n      currentViewData[i] = recordobj[i];\n      if (this.parent.isFrozenGrid()) {\n        movbRows[i] = mtr[i];\n        movbObject[i] = movobj[i];\n        if (frTr) {\n          frRightRows[i] = frTr[i];\n          frRightObject[i] = frObj[i];\n        }\n      }\n    }\n    resetRowIndex(this.parent, rowObjects, tr);\n    if (this.parent.isFrozenGrid()) {\n      resetRowIndex(this.parent, movbObject, mtr);\n      if (frTr) {\n        resetRowIndex(this.parent, frRightObject, frTr);\n      }\n    }\n  };\n  RowDD.prototype.rowOrder = function (args) {\n    if (args.dropIndex === args.fromIndex || isNaN(args.dropIndex)) {\n      return;\n    }\n    if (this.parent.isDetail()) {\n      this.parent.detailCollapseAll();\n      var rows = [].slice.call(this.parent.getContentTable().querySelector(literals.tbody).children);\n      var rowObjects = this.parent.getRowsObject();\n      rows.filter(function (row) {\n        if (row.classList.contains('e-detailrow')) {\n          row.remove();\n        }\n      });\n      for (var i = 0, len = rowObjects.length; i < len; i++) {\n        if (!rowObjects[i]) {\n          break;\n        }\n        if (rowObjects[i].isDetailRow) {\n          this.parent.getRowsObject().splice(i, 1);\n          i--;\n        }\n      }\n    }\n    if (args.target.classList.contains('e-rowcelldrag')) {\n      args.target = args.target.parentElement;\n    }\n    if (this.parent.frozenRows) {\n      this.updateFrozenRowreOrder(args);\n    } else {\n      this.updateFrozenColumnreOrder(args);\n    }\n    if (this.selectedRowColls.length > 0) {\n      this.parent.selectRows(this.selectedRowColls);\n      var indexes = [];\n      if (this.parent.filterSettings.columns.length || this.parent.sortSettings.columns.length) {\n        for (var i = 0, len = args.rows.length; i < len; i++) {\n          indexes.push(parseInt(args.rows[i].getAttribute(literals.ariaRowIndex), 10));\n        }\n        this.selectedRowColls = indexes;\n      }\n      this.selectedRowColls = [];\n    }\n  };\n  RowDD.prototype.currentViewData = function () {\n    var selectedIndexes = this.parent.getSelectedRowIndexes();\n    var currentVdata = [];\n    var fromIdx = parseInt(this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n    for (var i = 0, n = selectedIndexes.length; i < n; i++) {\n      var currentV = 'currentViewData';\n      currentVdata[i] = this.parent[currentV][selectedIndexes[i]];\n    }\n    if (!this.parent.rowDropSettings.targetID && selectedIndexes.length === 0) {\n      currentVdata[0] = this.parent.currentViewData[fromIdx];\n    }\n    return currentVdata;\n  };\n  RowDD.prototype.saveChange = function (changeRecords, query) {\n    var _this = this;\n    this.parent.getDataModule().saveChanges(changeRecords, this.parent.getPrimaryKeyFieldNames()[0], {}, query).then(function () {\n      _this.parent.notify(events.modelChanged, {\n        type: events.actionBegin,\n        requestType: 'rowdraganddrop'\n      });\n    }).catch(function (e) {\n      var error = 'error';\n      var message = 'message';\n      if (!isNullOrUndefined(e[error]) && !isNullOrUndefined(e[error][message])) {\n        e[error] = e[error][message];\n      }\n      _this.parent.trigger(events.actionFailure, e);\n    });\n  };\n  RowDD.prototype.reorderRows = function (fromIndexes, toIndex) {\n    var selectedIndexes = this.parent.getSelectedRowIndexes();\n    var selectedRecords = [];\n    var draggedRecords = [];\n    var currentViewData = this.parent.renderModule.data.dataManager.dataSource.json;\n    var skip = this.parent.allowPaging ? this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize - this.parent.pageSettings.pageSize : 0;\n    var dropIdx = toIndex + skip;\n    var actualIdx = fromIndexes[0] + skip;\n    for (var i = 0, len = fromIndexes.length; i < len; i++) {\n      draggedRecords[i] = currentViewData[fromIndexes[i] + skip];\n    }\n    for (var i = 0, len = selectedIndexes.length; i < len; i++) {\n      selectedRecords[i] = currentViewData[selectedIndexes[i] + skip];\n    }\n    for (var i = 0, len = draggedRecords.length; i < len; i++) {\n      if (i !== 0) {\n        for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n          if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) === JSON.stringify(draggedRecords[i])) {\n            actualIdx = j;\n            break;\n          }\n        }\n        for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n          if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) === JSON.stringify(draggedRecords[i - 1])) {\n            if (actualIdx > j) {\n              dropIdx = j + 1;\n            }\n            break;\n          }\n        }\n      }\n      this.reorderRow(actualIdx - skip, dropIdx - skip);\n    }\n    if (this.isRefresh) {\n      this.parent.notify(events.modelChanged, {\n        type: events.actionBegin,\n        requestType: 'rowdraganddrop'\n      });\n    }\n    for (var i = 0, len = selectedRecords.length; i < len; i++) {\n      for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n        if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) === JSON.stringify(selectedRecords[i])) {\n          selectedIndexes[i] = j - skip;\n          break;\n        }\n      }\n    }\n    this.selectedRowColls = selectedIndexes;\n  };\n  RowDD.prototype.stopTimer = function () {\n    window.clearInterval(this.timer);\n  };\n  /**\n  * To trigger action complete event.\n  *\n  * @param {NotifyArgs} e - specifies the NotifyArgs\n  * @returns {void}\n  * @hidden\n  */\n  RowDD.prototype.onActionComplete = function (e) {\n    this.parent.trigger(events.actionComplete, extend(e, {\n      type: events.actionComplete,\n      requestType: 'rowdraganddrop'\n    }));\n  };\n  RowDD.prototype.initializeDrag = function () {\n    var gObj = this.parent;\n    this.draggable = new Draggable(gObj.element, {\n      dragTarget: '.e-rowcelldrag, .e-rowdragdrop, .e-rowcell',\n      distance: 5,\n      helper: this.helper,\n      dragStart: this.dragStart,\n      drag: this.drag,\n      dragStop: this.dragStop,\n      isReplaceDragEle: this.isReplaceDragEle,\n      isPreventSelect: false\n    });\n  };\n  RowDD.prototype.updateScrollPostion = function (e) {\n    var _this = this;\n    var y = getPosition(e).y;\n    var cliRect = this.isDropGrid.getContent().getBoundingClientRect();\n    var rowHeight = this.isDropGrid.getRowHeight() - 15;\n    var scrollElem = this.isDropGrid.getContent().firstElementChild;\n    var virtualScrollbtm = this.parent.enableVirtualization ? 20 : 0;\n    if (cliRect.top >= y) {\n      var scrollPixel_1 = -this.isDropGrid.getRowHeight();\n      this.isOverflowBorder = false;\n      this.timer = window.setInterval(function () {\n        _this.setScrollDown(scrollElem, scrollPixel_1);\n      }, 200);\n    } else if (cliRect.top + this.isDropGrid.getContent().clientHeight - rowHeight - 33 - virtualScrollbtm <= y) {\n      var scrollPixel_2 = this.isDropGrid.getRowHeight();\n      this.isOverflowBorder = false;\n      this.timer = window.setInterval(function () {\n        _this.setScrollDown(scrollElem, scrollPixel_2);\n      }, 200);\n    }\n  };\n  RowDD.prototype.setScrollDown = function (scrollElem, scrollPixel) {\n    scrollElem.scrollTop = scrollElem.scrollTop + scrollPixel;\n  };\n  RowDD.prototype.moveDragRows = function (e, startedRow, targetRow) {\n    var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n    var element = closestElement(e.target, 'tr');\n    if (parentsUntil(element, 'e-grid') && (parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(element, 'e-grid').id || this.istargetGrid)) {\n      var targetElement = element ? element : this.startedRow;\n      this.setBorder(targetElement, e.event, startedRow, targetRow);\n    }\n  };\n  RowDD.prototype.setBorder = function (element, event, startedRow, targetRow) {\n    var node = this.parent.element;\n    if (this.istargetGrid) {\n      node = this.isDropGrid.element;\n    }\n    var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n    this.removeFirstRowBorder(element);\n    this.removeLastRowBorder(element);\n    if (parentsUntil(element, 'e-grid') && element.classList.contains(literals.row) && (!this.parent.rowDropSettings.targetID && parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(element, 'e-grid').id || this.istargetGrid)) {\n      removeClass(node.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'), ['e-dragborder']);\n      var rowElement = [];\n      var targetRowIndex = parseInt(targetRow.getAttribute(literals.ariaRowIndex), 10);\n      if (targetRow && targetRowIndex === 0) {\n        var div = this.parent.createElement('div', {\n          className: 'e-firstrow-dragborder'\n        });\n        var gridheaderEle = this.isDropGrid.getHeaderContent();\n        gridheaderEle.classList.add('e-grid-relative');\n        div.style.width = node.offsetWidth - this.getScrollWidth() + 'px';\n        if (!gridheaderEle.getElementsByClassName('e-firstrow-dragborder').length) {\n          gridheaderEle.appendChild(div);\n        }\n      } else if (this.parent.rowDropSettings.targetID && targetRow) {\n        element = this.isDropGrid.getRowByIndex(targetRowIndex - 1);\n        rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n      } else if (targetRow && parseInt(startedRow.getAttribute(literals.ariaRowIndex), 10) > targetRowIndex) {\n        element = this.parent.getRowByIndex(targetRowIndex - 1);\n        rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n      } else {\n        rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n      }\n      var frzCols = this.parent.isFrozenGrid();\n      if (targetRow && targetRowIndex !== 0 && frzCols) {\n        var rowIndex = parseInt(element.getAttribute(literals.ariaRowIndex), 10);\n        var selector = '.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse';\n        rowElement = this.borderRowElement(rowIndex, selector);\n      }\n      if (rowElement.length > 0) {\n        addRemoveActiveClasses(rowElement, true, 'e-dragborder');\n      }\n    }\n  };\n  RowDD.prototype.borderRowElement = function (rowIndex, selector) {\n    var lastRow = [];\n    lastRow = [].slice.call(this.isDropGrid.getRowByIndex(rowIndex).querySelectorAll(selector)).concat([].slice.call(this.isDropGrid.getMovableRowByIndex(rowIndex).querySelectorAll(selector)));\n    if (this.isDropGrid.getFrozenMode() === literals.leftRight) {\n      lastRow = lastRow.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(rowIndex).querySelectorAll(selector)));\n    }\n    return lastRow;\n  };\n  RowDD.prototype.getScrollWidth = function () {\n    var scrollElem = this.parent.getContent().firstElementChild;\n    return scrollElem.scrollWidth > scrollElem.offsetWidth ? Scroll.getScrollBarWidth() : 0;\n  };\n  RowDD.prototype.removeFirstRowBorder = function (element) {\n    if (this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder').length > 0 && element && element.rowIndex !== 0) {\n      remove(this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder')[0]);\n    }\n  };\n  RowDD.prototype.removeLastRowBorder = function (element) {\n    var islastRowIndex;\n    if (this.parent.enableVirtualization) {\n      islastRowIndex = element && parseInt(element.getAttribute(literals.ariaRowIndex), 10) !== this.parent.renderModule.data.dataManager.dataSource.json.length - 1;\n    } else {\n      islastRowIndex = element && this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length - 1).getAttribute('data-uid') !== element.getAttribute('data-uid');\n    }\n    if (this.parent.element.getElementsByClassName('e-lastrow-dragborder').length > 0 && element && islastRowIndex) {\n      remove(this.parent.element.getElementsByClassName('e-lastrow-dragborder')[0]);\n    }\n  };\n  RowDD.prototype.removeBorder = function (element) {\n    this.removeFirstRowBorder(element);\n    if (!this.parent.rowDropSettings.targetID) {\n      this.removeLastRowBorder(element);\n    }\n    element = (this.isDropGrid.isFrozenGrid() ? this.isDropGrid.getMovableRows() : this.isDropGrid.getRows()).filter(function (row) {\n      return row.querySelector('td.e-dragborder');\n    })[0];\n    if (element) {\n      var rowElement = [].slice.call(element.getElementsByClassName('e-dragborder'));\n      if (this.parent.isFrozenGrid()) {\n        var rowIndex = parseInt(element.getAttribute(literals.ariaRowIndex), 10);\n        var selector = '.e-dragborder';\n        rowElement = this.borderRowElement(rowIndex, selector);\n      }\n      addRemoveActiveClasses(rowElement, false, 'e-dragborder');\n    }\n  };\n  RowDD.prototype.getElementFromPosition = function (element, event) {\n    var position = getPosition(event);\n    element.style.display = 'none';\n    var target = document.elementFromPoint(position.x, position.y);\n    element.style.display = '';\n    return target;\n  };\n  RowDD.prototype.onDataBound = function () {\n    if (this.selectedRowColls.length > 0 && this.parent.enableVirtualization) {\n      this.parent.selectRows(this.selectedRowColls);\n      this.selectedRowColls = [];\n    }\n  };\n  RowDD.prototype.getTargetIdx = function (targetRow) {\n    return targetRow ? parseInt(targetRow.getAttribute(literals.ariaRowIndex), 10) : 0;\n  };\n  RowDD.prototype.singleRowDrop = function (e) {\n    var targetRow = closestElement(e.target, 'tr');\n    var srcControl = e.droppedElement.parentElement.ej2_instances[0];\n    var currentIndex = targetRow ? targetRow.rowIndex : srcControl.currentViewData.length - 1;\n    this.reorderRow(this.startedRowIndex, currentIndex);\n  };\n  RowDD.prototype.columnDrop = function (e) {\n    var gObj = this.parent;\n    if (e.droppedElement.getAttribute('action') !== 'grouping' && (parentsUntil(e.target, literals.row) || parentsUntil(e.target, 'e-emptyrow') || parentsUntil(e.target, literals.gridContent))) {\n      var targetRow = closestElement(e.target, 'tr');\n      var srcControl = void 0;\n      var currentIndex = void 0;\n      if (e.droppedElement.querySelector('tr').getAttribute('single-dragrow') !== 'true' && e.droppedElement.parentElement.id === gObj.element.id || e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true' && e.droppedElement.parentElement.id !== gObj.element.id) {\n        return;\n      }\n      if (e.droppedElement.parentElement.id !== gObj.element.id) {\n        srcControl = e.droppedElement.parentElement.ej2_instances[0];\n      } else if (this.isSingleRowDragDrop || e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true') {\n        this.singleRowDrop(e);\n        return;\n      }\n      if (srcControl.element.id !== gObj.element.id && srcControl.rowDropSettings.targetID !== gObj.element.id) {\n        return;\n      }\n      var records = srcControl.getSelectedRecords();\n      var targetIndex = currentIndex = this.getTargetIdx(targetRow);\n      if (isNaN(targetIndex)) {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        targetIndex = currentIndex = 0;\n      }\n      if (gObj.allowPaging) {\n        targetIndex = targetIndex + gObj.pageSettings.currentPage * gObj.pageSettings.pageSize - gObj.pageSettings.pageSize;\n      }\n      //Todo: drag and drop mapper & BatchChanges\n      gObj.notify(events.rowsAdded, {\n        toIndex: targetIndex,\n        records: records\n      });\n      gObj.notify(events.modelChanged, {\n        type: events.actionBegin,\n        requestType: 'rowdraganddrop'\n      });\n      var selectedRows = srcControl.getSelectedRowIndexes();\n      var skip = srcControl.allowPaging ? srcControl.pageSettings.currentPage * srcControl.pageSettings.pageSize - srcControl.pageSettings.pageSize : 0;\n      this.selectedRows = [];\n      for (var i = 0, len = records.length; i < len; i++) {\n        this.selectedRows.push(skip + selectedRows[i]);\n      }\n      srcControl.notify(events.rowsRemoved, {\n        indexes: this.selectedRows,\n        records: records\n      });\n      srcControl.notify(events.modelChanged, {\n        type: events.actionBegin,\n        requestType: 'rowdraganddrop'\n      });\n    }\n  };\n  RowDD.prototype.reorderRow = function (fromIndexes, toIndex) {\n    var gObj = this.parent;\n    if (!gObj.sortSettings.columns.length && !gObj.groupSettings.columns.length && !gObj.filterSettings.columns.length) {\n      //Todo: drag and drop mapper & BatchChanges\n      var skip = gObj.allowPaging ? gObj.pageSettings.currentPage * gObj.pageSettings.pageSize - gObj.pageSettings.pageSize : 0;\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      var fromIndex = fromIndexes;\n      toIndex = toIndex + skip;\n      this.selectedRows = gObj.getSelectedRowIndexes();\n      gObj.notify(events.rowPositionChanged, {\n        fromIndex: fromIndexes + skip,\n        toIndex: toIndex\n      });\n    }\n  };\n  RowDD.prototype.enableAfterRender = function (e) {\n    if (e.module === this.getModuleName() && e.enable) {\n      this.initializeDrag();\n    }\n  };\n  /**\n   * To destroy the print\n   *\n   * @returns {void}\n   * @hidden\n   */\n  RowDD.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (this.parent.isDestroyed || !gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n    this.draggable.destroy();\n    this.parent.off(events.initialEnd, this.initializeDrag);\n    this.parent.off(events.columnDrop, this.columnDrop);\n    this.parent.off(events.rowDragAndDropComplete, this.onActionComplete);\n    this.parent.removeEventListener(events.dataBound, this.onDataBoundFn);\n    this.parent.off(events.uiUpdate, this.enableAfterRender);\n    this.parent.off(events.destroy, this.destroy);\n    //destory ejdrag and drop\n  };\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  RowDD.prototype.getModuleName = function () {\n    return 'rowDragAndDrop';\n  };\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  RowDD.prototype.processArgs = function (target) {\n    var gObj = this.parent;\n    var dragIdx = parseInt(this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n    if (gObj.getSelectedRecords().length > 0 && this.startedRow.cells[0].classList.contains('e-selectionbackground') === false || gObj.getSelectedRecords().length === 0) {\n      if (this.parent.enableVirtualization) {\n        this.rows = [this.startedRow];\n      } else {\n        this.rows = [this.parent.getRowByIndex(dragIdx)];\n        if (gObj.isFrozenGrid()) {\n          this.rows = [gObj.getRowByIndex(dragIdx), gObj.getMovableRowByIndex(dragIdx)];\n          if (gObj.getFrozenMode() === literals.leftRight) {\n            this.rows = [gObj.getRowByIndex(dragIdx), gObj.getMovableRowByIndex(dragIdx), gObj.getFrozenRightRowByIndex(dragIdx)];\n          }\n        }\n      }\n      this.rowData = [this.parent.getRowInfo(this.startedRow.querySelector('.' + literals.rowCell)).rowData];\n    } else {\n      this.rows = gObj.getSelectedRows();\n      this.rowData = gObj.getSelectedRecords();\n    }\n  };\n  return RowDD;\n}();\nexport { RowDD };","map":{"version":3,"names":["Draggable","isNullOrUndefined","removeClass","remove","closest","closestElement","classList","extend","parentsUntil","removeElement","getPosition","addRemoveActiveClasses","isActionPrevent","setRowsInTbody","resetRowIndex","events","Scroll","literals","RowDD","parent","_this","selectedRows","isOverflowBorder","selectedRowColls","isRefresh","isReplaceDragEle","istargetGrid","helper","e","gObj","target","draggable","currentStateTarget","visualElement","createElement","className","styles","element","offsetWidth","table","tbody","document","getElementsByClassName","length","rowDropSettings","targetID","contains","selectionSettings","type","mode","selectRow","parseInt","parentElement","getAttribute","ariaRowIndex","startedRow","cloneNode","frzCols","isFrozenGrid","rowIndex","innerHTML","getRowByIndex","getMovableRowByIndex","getFrozenMode","leftRight","getFrozenRightRowByIndex","processArgs","args","selectedRow","rows","dragelement","cloneElement","cancel","data","rowData","getSelectedRows","trigger","rowDragStartHelper","removeCell","gridChkBox","exp","RegExp","replace","appendChild","getSelectedRowIndexes","hasAttribute","index","dropCountEle","ele","querySelector","add","dragStart","body","spanCssEle","getSelectedRecords","style","left","rowDragStart","draggableType","fromIndex","Object","keys","currentViewData","dragStartData","dropElem","getElementById","ej2_instances","getModuleName","getContent","drag","isDropGrid","dropElement","id","getElementFromPosition","event","hoverState","enableHover","trElement","originalEvent","rowDrag","stopTimer","dragTarget","elem","groupSettings","columns","updateScrollPostion","frozenRows","getCurrentViewRecords","moveDragRows","islastRowIndex","enableVirtualization","renderModule","dataManager","dataSource","json","lastRowUid","bottomborder","gridcontentEle","width","getScrollWidth","zIndex","bottom","removeBorder","content","selector","rowElement","slice","call","querySelectorAll","borderRowElement","dragStop","notify","preventBatch","instance","handler","processDragStop","arg1","isDestroyed","targetEle","stRow","dropIndex","rowDrop","row","gridContent","selectedIndexes","isRowDragable","reorderRows","refresh","rowOrder","targetRow","filter","cell","deleteCell","cellIndex","on","initialEnd","initializeDrag","columnDrop","rowDragAndDropComplete","onActionComplete","onDataBoundFn","onDataBound","bind","addEventListener","dataBound","uiUpdate","enableAfterRender","destroy","prototype","refreshRow","mtbody","frTbody","mTarget","frTarget","isLeftRight","tbodyMovableHeader","tbodyMovableContent","frHdr","frCnt","tbodyContent","getContentTable","tbodyHeader","getHeaderTable","getMovableHeaderTbody","getMovableContentTbody","getFrozenRightHeaderTbody","getFrozenRightContentTbody","i","len","insertBefore","tr","mtr","frTr","refreshData","_loop_1","this_1","updateFrozenRowreOrder","tbodyMovH","tbodyMovC","tbodyFrH","tbodyFrC","tbodyC","tbodyH","concat","clearSelection","targetRows","refreshRowTarget","mTr","targetIdx","updateFrozenColumnreOrder","rowObj","movobj","frObj","recordobj","rowObjects","getRowsObject","movbObject","getMovableRowsObject","frRightObject","getFrozenRightRowsObject","getRows","movbRows","frRightRows","getMovableRows","getFrozenRightRows","isNaN","isDetail","detailCollapseAll","children","isDetailRow","splice","selectRows","indexes","filterSettings","sortSettings","push","currentVdata","fromIdx","n","currentV","saveChange","changeRecords","query","getDataModule","saveChanges","getPrimaryKeyFieldNames","then","modelChanged","actionBegin","requestType","catch","error","message","actionFailure","fromIndexes","toIndex","selectedRecords","draggedRecords","skip","allowPaging","pageSettings","currentPage","pageSize","dropIdx","actualIdx","j","len1","JSON","stringify","reorderRow","window","clearInterval","timer","actionComplete","distance","isPreventSelect","y","cliRect","getBoundingClientRect","rowHeight","getRowHeight","scrollElem","firstElementChild","virtualScrollbtm","top","scrollPixel_1","setInterval","setScrollDown","clientHeight","scrollPixel_2","scrollPixel","scrollTop","targetElement","setBorder","node","removeFirstRowBorder","removeLastRowBorder","targetRowIndex","div","gridheaderEle","getHeaderContent","lastRow","scrollWidth","getScrollBarWidth","position","display","elementFromPoint","x","getTargetIdx","singleRowDrop","srcControl","droppedElement","currentIndex","startedRowIndex","isSingleRowDragDrop","records","targetIndex","rowsAdded","rowsRemoved","rowPositionChanged","module","enable","gridElement","gridHeader","off","removeEventListener","dragIdx","cells","getRowInfo","rowCell"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/actions/row-reorder.js"],"sourcesContent":["import { Draggable, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { removeClass } from '@syncfusion/ej2-base';\nimport { remove, closest as closestElement, classList, extend } from '@syncfusion/ej2-base';\nimport { parentsUntil, removeElement, getPosition, addRemoveActiveClasses, isActionPrevent } from '../base/util';\nimport { setRowsInTbody, resetRowIndex } from '../base/util';\nimport * as events from '../base/constant';\nimport { Scroll } from '../actions/scroll';\nimport * as literals from '../base/string-literals';\n// eslint-disable-next-line valid-jsdoc\n/**\n *\n * Reorder module is used to handle row reordering.\n *\n * @hidden\n */\nvar RowDD = /** @class */ (function () {\n    /**\n     * Constructor for the Grid print module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @hidden\n     */\n    function RowDD(parent) {\n        var _this = this;\n        this.selectedRows = [];\n        this.isOverflowBorder = true;\n        this.selectedRowColls = [];\n        this.isRefresh = true;\n        this.isReplaceDragEle = true;\n        this.istargetGrid = false;\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        this.helper = function (e) {\n            var gObj = _this.parent;\n            var target = _this.draggable.currentStateTarget;\n            var visualElement = _this.parent.createElement('div', {\n                className: 'e-cloneproperties e-draganddrop e-grid e-dragclone',\n                styles: 'height:\"auto\", z-index:2, width:' + gObj.element.offsetWidth\n            });\n            var table = _this.parent.createElement('table', { styles: 'width:' + gObj.element.offsetWidth });\n            var tbody = _this.parent.createElement(literals.tbody);\n            if (document.getElementsByClassName('e-griddragarea').length ||\n                (gObj.rowDropSettings.targetID && ((!target.classList.contains('e-selectionbackground')\n                    && gObj.selectionSettings.type !== 'Single') || !parentsUntil(target, 'e-rowcell'))) ||\n                (!gObj.rowDropSettings.targetID && !parentsUntil(target, 'e-rowdragdrop'))) {\n                return false;\n            }\n            if (gObj.rowDropSettings.targetID &&\n                gObj.selectionSettings.mode === 'Row' && gObj.selectionSettings.type === 'Single') {\n                gObj.selectRow(parseInt(_this.draggable.currentStateTarget.parentElement.getAttribute(literals.ariaRowIndex), 10));\n            }\n            _this.startedRow = closestElement(target, 'tr').cloneNode(true);\n            var frzCols = _this.parent.isFrozenGrid();\n            if (frzCols) {\n                var rowIndex = parseInt(closestElement(target, 'tr').getAttribute(literals.ariaRowIndex), 10);\n                _this.startedRow.innerHTML = '';\n                _this.startedRow.innerHTML += gObj.getRowByIndex(rowIndex).innerHTML;\n                _this.startedRow.innerHTML += gObj.getMovableRowByIndex(rowIndex).innerHTML;\n                if (gObj.getFrozenMode() === literals.leftRight) {\n                    _this.startedRow.innerHTML += gObj.getFrozenRightRowByIndex(rowIndex).innerHTML;\n                }\n            }\n            _this.processArgs(target);\n            var args = {\n                selectedRow: _this.rows, dragelement: target,\n                cloneElement: visualElement, cancel: false, data: _this.rowData\n            };\n            var selectedRows = gObj.getSelectedRows();\n            gObj.trigger(events.rowDragStartHelper, args);\n            var cancel = 'cancel';\n            if (args[cancel]) {\n                return false;\n            }\n            removeElement(_this.startedRow, '.e-indentcell');\n            removeElement(_this.startedRow, '.e-detailrowcollapse');\n            removeElement(_this.startedRow, '.e-detailrowexpand');\n            _this.removeCell(_this.startedRow, literals.gridChkBox);\n            var exp = new RegExp('e-active', 'g'); //high contrast issue\n            _this.startedRow.innerHTML = _this.startedRow.innerHTML.replace(exp, '');\n            tbody.appendChild(_this.startedRow);\n            if (gObj.getSelectedRowIndexes().length > 1 && _this.startedRow.hasAttribute('aria-selected')) {\n                var index = gObj.getFrozenMode() === literals.leftRight ? 3 : 2;\n                var dropCountEle = _this.parent.createElement('span', {\n                    className: 'e-dropitemscount', innerHTML: frzCols ? '' + selectedRows.length / index : '' + selectedRows.length\n                });\n                visualElement.appendChild(dropCountEle);\n            }\n            var ele = closestElement(target, 'tr').querySelector('.e-icon-rowdragicon');\n            if (ele) {\n                ele.classList.add('e-dragstartrow');\n            }\n            table.appendChild(tbody);\n            visualElement.appendChild(table);\n            gObj.element.appendChild(visualElement);\n            return visualElement;\n        };\n        this.dragStart = function (e) {\n            var gObj = _this.parent;\n            document.body.classList.add('e-prevent-select');\n            if (document.getElementsByClassName('e-griddragarea').length) {\n                return;\n            }\n            var target = e.target;\n            var spanCssEle = _this.parent.element.querySelector('.e-dropitemscount');\n            if (_this.parent.getSelectedRecords().length > 1 && spanCssEle) {\n                spanCssEle.style.left = _this.parent.element.querySelector('.e-cloneproperties table')\n                    .offsetWidth - 5 + 'px';\n            }\n            _this.processArgs(target);\n            gObj.trigger(events.rowDragStart, {\n                rows: _this.rows, target: e.target,\n                draggableType: 'rows', fromIndex: parseInt(_this.rows[0].getAttribute(literals.ariaRowIndex), 10),\n                data: (Object.keys(_this.rowData[0]).length > 0) ? _this.rowData : _this.currentViewData()\n            });\n            _this.dragStartData = _this.rowData;\n            var dropElem = document.getElementById(gObj.rowDropSettings.targetID);\n            if (gObj.rowDropSettings.targetID && dropElem && dropElem.ej2_instances &&\n                dropElem.ej2_instances[0].getModuleName() === 'grid') {\n                dropElem.ej2_instances[0].getContent().classList.add('e-allowRowDrop');\n            }\n        };\n        this.drag = function (e) {\n            var gObj = _this.parent;\n            _this.isDropGrid = _this.parent;\n            _this.istargetGrid = false;\n            if (_this.parent.rowDropSettings.targetID) {\n                var dropElement = document.getElementById(gObj.rowDropSettings.targetID);\n                _this.isDropGrid = dropElement.ej2_instances[0];\n                if (parentsUntil(e.target, 'e-grid')) {\n                    _this.istargetGrid = _this.parent.rowDropSettings.targetID === parentsUntil(e.target, 'e-grid').id;\n                }\n            }\n            var cloneElement = _this.parent.element.querySelector('.e-cloneproperties');\n            var target = _this.getElementFromPosition(cloneElement, e.event);\n            classList(cloneElement, ['e-defaultcur'], ['e-notallowedcur', 'e-movecur', 'e-grabcur']);\n            _this.isOverflowBorder = true;\n            _this.hoverState = gObj.enableHover;\n            var trElement = parentsUntil(target, 'e-grid') ? closestElement(e.target, 'tr') : null;\n            if (!e.target) {\n                return;\n            }\n            _this.processArgs(target);\n            var args = {\n                rows: _this.rows, target: target, draggableType: 'rows',\n                data: _this.rowData, originalEvent: e, cancel: false\n            };\n            gObj.trigger(events.rowDrag, args);\n            _this.stopTimer();\n            if (args.cancel) {\n                return;\n            }\n            gObj.element.classList.add('e-rowdrag');\n            _this.dragTarget = trElement && parentsUntil(target, 'e-grid').id === cloneElement.parentElement.id ?\n                parseInt(trElement.getAttribute(literals.ariaRowIndex), 10) : parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n            if (gObj.rowDropSettings.targetID) {\n                if (!parentsUntil(target, 'e-grid') ||\n                    parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(target, 'e-grid').id) {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-defaultcur']);\n                }\n                else {\n                    classList(cloneElement, ['e-grabcur'], ['e-notallowedcur']);\n                }\n            }\n            else {\n                var elem = parentsUntil(target, 'e-grid');\n                if (elem && elem.id === cloneElement.parentElement.id) {\n                    classList(cloneElement, ['e-movecur'], ['e-defaultcur']);\n                }\n                else {\n                    classList(cloneElement, ['e-notallowedcur'], ['e-movecur']);\n                }\n            }\n            if (parentsUntil(_this.isDropGrid.element, 'e-grid')) {\n                if ((!_this.isDropGrid.groupSettings.columns.length || e.target.classList.contains('e-selectionbackground')) &&\n                    !_this.isDropGrid.element.querySelector('.e-emptyrow')) {\n                    if (parentsUntil(target, 'e-grid') && parentsUntil(target, 'e-grid').id === _this.isDropGrid.element.id) {\n                        _this.updateScrollPostion(e.event);\n                    }\n                    if (((_this.isOverflowBorder || _this.parent.frozenRows > _this.dragTarget) &&\n                        (parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10) !== _this.dragTarget || _this.istargetGrid))\n                        || (_this.istargetGrid && trElement && _this.isDropGrid.getRowByIndex(_this.isDropGrid.getCurrentViewRecords().length - 1).\n                            getAttribute('data-uid') === trElement.getAttribute('data-uid'))) {\n                        _this.moveDragRows(e, _this.startedRow, trElement);\n                    }\n                    else {\n                        var islastRowIndex = void 0;\n                        if (_this.parent.enableVirtualization) {\n                            islastRowIndex = trElement && parseInt(trElement.getAttribute(literals.ariaRowIndex), 10) ===\n                                _this.parent.renderModule.data.dataManager.dataSource.json.length - 1;\n                        }\n                        else {\n                            var lastRowUid = _this.parent.getRowByIndex(_this.parent.getCurrentViewRecords().length - 1).\n                                getAttribute('data-uid');\n                            islastRowIndex = trElement && lastRowUid === trElement.getAttribute('data-uid') && lastRowUid !==\n                                _this.startedRow.getAttribute('data-uid');\n                        }\n                        if (islastRowIndex && !_this.parent.rowDropSettings.targetID) {\n                            var bottomborder = _this.parent.createElement('div', { className: 'e-lastrow-dragborder' });\n                            var gridcontentEle = _this.parent.getContent();\n                            bottomborder.style.width = _this.parent.element.offsetWidth - _this.getScrollWidth() + 'px';\n                            if (_this.parent.enableVirtualization) {\n                                bottomborder.style.zIndex = '1';\n                            }\n                            if (!gridcontentEle.getElementsByClassName('e-lastrow-dragborder').length) {\n                                gridcontentEle.classList.add('e-grid-relative');\n                                gridcontentEle.appendChild(bottomborder);\n                                bottomborder.style.bottom = _this.getScrollWidth() + 'px';\n                            }\n                        }\n                        _this.removeBorder(trElement);\n                    }\n                }\n                if (target && target.classList.contains(literals.content)\n                    && !_this.isDropGrid.element.querySelector('.e-emptyrow') && _this.istargetGrid) {\n                    _this.removeBorder(trElement);\n                    var rowIndex = _this.isDropGrid.getCurrentViewRecords().length - 1;\n                    var selector = '.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse';\n                    var rowElement = [];\n                    rowElement = [].slice.call(_this.isDropGrid.getRowByIndex(rowIndex).querySelectorAll(selector));\n                    if (_this.isDropGrid.isFrozenGrid()) {\n                        rowElement = _this.borderRowElement(rowIndex, selector);\n                    }\n                    if (rowElement.length > 0) {\n                        addRemoveActiveClasses(rowElement, true, 'e-dragborder');\n                    }\n                }\n            }\n        };\n        this.dragStop = function (e) {\n            document.body.classList.remove('e-prevent-select');\n            if (isActionPrevent(_this.parent)) {\n                _this.parent.notify(events.preventBatch, {\n                    instance: _this, handler: _this.processDragStop, arg1: e\n                });\n            }\n            else {\n                _this.processDragStop(e);\n            }\n        };\n        this.processDragStop = function (e) {\n            var gObj = _this.parent;\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            var targetEle = _this.getElementFromPosition(e.helper, e.event);\n            var target = targetEle && !targetEle.classList.contains('e-dlg-overlay') ?\n                targetEle : e.target;\n            gObj.element.classList.remove('e-rowdrag');\n            var dropElement = document.getElementById(gObj.rowDropSettings.targetID);\n            if (gObj.rowDropSettings.targetID && dropElement && dropElement.ej2_instances &&\n                dropElement.ej2_instances[0].getModuleName() === 'grid') {\n                dropElement.ej2_instances[0].getContent().classList.remove('e-allowRowDrop');\n            }\n            if (parentsUntil(_this.isDropGrid.element, 'e-grid')) {\n                _this.stopTimer();\n                _this.isDropGrid.enableHover = _this.hoverState;\n                _this.isDropGrid.getContent().classList.remove('e-grid-relative');\n                _this.removeBorder(targetEle);\n                var stRow = _this.isDropGrid.element.querySelector('.e-dragstartrow');\n                if (stRow) {\n                    stRow.classList.remove('e-dragstartrow');\n                }\n            }\n            _this.processArgs(target);\n            var args = {\n                target: target, draggableType: 'rows',\n                cancel: false,\n                fromIndex: parseInt(_this.rows[0].getAttribute(literals.ariaRowIndex), 10),\n                dropIndex: _this.dragTarget, rows: _this.rows,\n                data: (Object.keys(_this.dragStartData[0]).length > 0) ? _this.dragStartData : _this.currentViewData()\n            };\n            gObj.trigger(events.rowDrop, args, function () {\n                if (!(parentsUntil(target, literals.row) || parentsUntil(target, 'e-emptyrow')\n                    || parentsUntil(target, literals.gridContent)) || args.cancel) {\n                    _this.dragTarget = null;\n                    remove(e.helper);\n                    return;\n                }\n                _this.isRefresh = false;\n                var selectedIndexes = _this.parent.getSelectedRowIndexes();\n                if (gObj.isRowDragable()) {\n                    if (!_this.parent.rowDropSettings.targetID &&\n                        _this.startedRow.querySelector('td.e-selectionbackground') && selectedIndexes.length > 1 &&\n                        selectedIndexes.length !== _this.parent.getCurrentViewRecords().length) {\n                        _this.reorderRows(selectedIndexes, args.dropIndex);\n                    }\n                    else {\n                        _this.reorderRows([parseInt(_this.startedRow.getAttribute(literals.ariaRowIndex), 10)], _this.dragTarget);\n                    }\n                    _this.dragTarget = null;\n                    if (!gObj.rowDropSettings.targetID) {\n                        remove(e.helper);\n                        if (gObj.enableVirtualization) {\n                            gObj.refresh();\n                        }\n                        else {\n                            _this.rowOrder(args);\n                        }\n                    }\n                }\n                _this.isRefresh = true;\n            });\n        };\n        this.removeCell = function (targetRow, className) {\n            return [].slice.call(targetRow.querySelectorAll('td')).filter(function (cell) {\n                if (cell.classList.contains(className)) {\n                    targetRow.deleteCell(cell.cellIndex);\n                }\n            });\n        };\n        this.parent = parent;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initialEnd, this.initializeDrag, this);\n        this.parent.on(events.columnDrop, this.columnDrop, this);\n        this.parent.on(events.rowDragAndDropComplete, this.onActionComplete, this);\n        this.onDataBoundFn = this.onDataBound.bind(this);\n        this.parent.addEventListener(events.dataBound, this.onDataBoundFn);\n        this.parent.on(events.uiUpdate, this.enableAfterRender, this);\n        this.parent.on(events.destroy, this.destroy, this);\n    }\n    RowDD.prototype.refreshRow = function (args, tbody, mtbody, frTbody, target, mTarget, frTarget) {\n        var gObj = this.parent;\n        var frzCols = gObj.isFrozenGrid();\n        var isLeftRight = gObj.getFrozenMode() === literals.leftRight;\n        var tbodyMovableHeader;\n        var tbodyMovableContent;\n        var frHdr;\n        var frCnt;\n        var tbodyContent = gObj.getContentTable().querySelector(literals.tbody);\n        var tbodyHeader = gObj.getHeaderTable().querySelector(literals.tbody);\n        if (frzCols) {\n            tbodyMovableHeader = gObj.getMovableHeaderTbody();\n            tbodyMovableContent = gObj.getMovableContentTbody();\n            if (isLeftRight) {\n                frHdr = gObj.getFrozenRightHeaderTbody();\n                frCnt = gObj.getFrozenRightContentTbody();\n            }\n        }\n        var index = gObj.getFrozenMode() === literals.leftRight ? 3 : 2;\n        for (var i = 0, len = args.rows.length; i < len; i++) {\n            if (frzCols) {\n                if (i % index === 0) {\n                    tbody.insertBefore(args.rows[i], target);\n                }\n                else if (i % index === 1) {\n                    mtbody.insertBefore(args.rows[i], mTarget);\n                }\n                else {\n                    frTbody.insertBefore(args.rows[i], frTarget);\n                }\n            }\n            else {\n                tbody.insertBefore(args.rows[i], target);\n            }\n        }\n        var tr = [].slice.call(tbody.getElementsByClassName(literals.row));\n        var mtr;\n        var frTr;\n        if (frzCols) {\n            mtr = [].slice.call(mtbody.getElementsByClassName(literals.row));\n            if (isLeftRight) {\n                frTr = [].slice.call(frTbody.getElementsByClassName(literals.row));\n            }\n        }\n        this.refreshData(tr, mtr, frTr);\n        if (this.parent.frozenRows) {\n            var _loop_1 = function (i, len) {\n                if (i < this_1.parent.frozenRows) {\n                    setRowsInTbody(tbodyHeader, tbodyMovableHeader, frHdr, tr, mtr, frTr, function (tbody, rows) {\n                        tbody.appendChild(rows[i]);\n                    });\n                }\n                else {\n                    setRowsInTbody(tbodyContent, tbodyMovableContent, frCnt, tr, mtr, frTr, function (tbody, rows) {\n                        tbody.appendChild(rows[i]);\n                    });\n                }\n            };\n            var this_1 = this;\n            for (var i = 0, len = tr.length; i < len; i++) {\n                _loop_1(i, len);\n            }\n        }\n    };\n    RowDD.prototype.updateFrozenRowreOrder = function (args) {\n        var gObj = this.parent;\n        var tbodyMovH;\n        var tbodyMovC;\n        var tbodyFrH;\n        var tbodyFrC;\n        var frzCols = this.parent.isFrozenGrid();\n        var isLeftRight = gObj.getFrozenMode() === literals.leftRight;\n        var tbodyC = gObj.getContentTable().querySelector(literals.tbody);\n        var tbodyH = gObj.getHeaderTable().querySelector(literals.tbody);\n        if (frzCols) {\n            tbodyMovH = gObj.getMovableHeaderTbody();\n            tbodyMovC = gObj.getMovableContentTbody();\n            if (isLeftRight) {\n                tbodyFrH = gObj.getFrozenRightHeaderTbody();\n                tbodyFrC = gObj.getFrozenRightContentTbody();\n            }\n        }\n        var tr = [].slice.call(tbodyH.getElementsByClassName(literals.row)).concat([].slice.call(tbodyC.getElementsByClassName(literals.row)));\n        var mtr;\n        var frTr;\n        if (frzCols) {\n            mtr = [].slice.call(tbodyMovH.getElementsByClassName(literals.row))\n                .concat([].slice.call(tbodyMovC.getElementsByClassName(literals.row)));\n            if (isLeftRight) {\n                frTr = [].slice.call(tbodyFrH.getElementsByClassName(literals.row))\n                    .concat([].slice.call(tbodyFrC.getElementsByClassName(literals.row)));\n            }\n        }\n        var tbody = gObj.createElement(literals.tbody);\n        var mtbody = gObj.createElement(literals.tbody);\n        var frTbody = gObj.createElement(literals.tbody);\n        this.parent.clearSelection();\n        var targetRows = this.refreshRowTarget(args);\n        for (var i = 0, len = tr.length; i < len; i++) {\n            tbody.appendChild(tr[i]);\n            if (frzCols) {\n                mtbody.appendChild(mtr[i]);\n                if (isLeftRight) {\n                    frTbody.appendChild(frTr[i]);\n                }\n            }\n        }\n        this.refreshRow(args, tbody, mtbody, frTbody, targetRows.target, targetRows.mTarget, targetRows.frTarget);\n    };\n    RowDD.prototype.refreshRowTarget = function (args) {\n        var gObj = this.parent;\n        var mTr;\n        var frTr;\n        var targetIdx = parseInt(args.target.parentElement.getAttribute(literals.ariaRowIndex), 10);\n        if (args.fromIndex < args.dropIndex || args.fromIndex === args.dropIndex) {\n            targetIdx = targetIdx + 1;\n        }\n        var tr = gObj.getRowByIndex(targetIdx);\n        if (gObj.isFrozenGrid()) {\n            mTr = gObj.getMovableRowByIndex(targetIdx);\n            if (gObj.getFrozenMode() === literals.leftRight) {\n                frTr = gObj.getFrozenRightRowByIndex(targetIdx);\n            }\n        }\n        var rows = {\n            target: tr, mTarget: mTr, frTarget: frTr\n        };\n        return rows;\n    };\n    RowDD.prototype.updateFrozenColumnreOrder = function (args) {\n        var gObj = this.parent;\n        var mtbody;\n        var frTbody;\n        var frzCols = this.parent.isFrozenGrid();\n        var tbody = gObj.getContentTable().querySelector(literals.tbody);\n        if (frzCols) {\n            mtbody = gObj.getMovableContentTbody();\n            if (gObj.getFrozenMode() === literals.leftRight) {\n                frTbody = gObj.getFrozenRightContentTbody();\n            }\n        }\n        this.parent.clearSelection();\n        var targetRows = this.refreshRowTarget(args);\n        this.refreshRow(args, tbody, mtbody, frTbody, targetRows.target, targetRows.mTarget, targetRows.frTarget);\n    };\n    RowDD.prototype.refreshData = function (tr, mtr, frTr) {\n        var rowObj = {};\n        var movobj = {};\n        var frObj = {};\n        var recordobj = {};\n        var rowObjects = this.parent.getRowsObject();\n        var movbObject = this.parent.getMovableRowsObject();\n        var frRightObject = this.parent.getFrozenRightRowsObject();\n        var currentViewData = this.parent.getCurrentViewRecords();\n        for (var i = 0, len = tr.length; i < len; i++) {\n            var index = parseInt(tr[i].getAttribute(literals.ariaRowIndex), 10);\n            rowObj[i] = rowObjects[index];\n            recordobj[i] = currentViewData[index];\n            if (this.parent.isFrozenGrid()) {\n                movobj[i] = movbObject[index];\n                if (frTr) {\n                    frObj[i] = frRightObject[index];\n                }\n            }\n        }\n        var rows = this.parent.getRows();\n        var movbRows;\n        var frRightRows;\n        if (this.parent.isFrozenGrid()) {\n            movbRows = this.parent.getMovableRows();\n            if (frTr) {\n                frRightRows = this.parent.getFrozenRightRows();\n            }\n        }\n        for (var i = 0, len = tr.length; i < len; i++) {\n            rows[i] = tr[i];\n            rowObjects[i] = rowObj[i];\n            currentViewData[i] = recordobj[i];\n            if (this.parent.isFrozenGrid()) {\n                movbRows[i] = mtr[i];\n                movbObject[i] = movobj[i];\n                if (frTr) {\n                    frRightRows[i] = frTr[i];\n                    frRightObject[i] = frObj[i];\n                }\n            }\n        }\n        resetRowIndex(this.parent, rowObjects, tr);\n        if (this.parent.isFrozenGrid()) {\n            resetRowIndex(this.parent, movbObject, mtr);\n            if (frTr) {\n                resetRowIndex(this.parent, frRightObject, frTr);\n            }\n        }\n    };\n    RowDD.prototype.rowOrder = function (args) {\n        if (args.dropIndex === args.fromIndex || isNaN(args.dropIndex)) {\n            return;\n        }\n        if (this.parent.isDetail()) {\n            this.parent.detailCollapseAll();\n            var rows = [].slice.call(this.parent.getContentTable().querySelector(literals.tbody).children);\n            var rowObjects = this.parent.getRowsObject();\n            rows.filter(function (row) {\n                if (row.classList.contains('e-detailrow')) {\n                    row.remove();\n                }\n            });\n            for (var i = 0, len = rowObjects.length; i < len; i++) {\n                if (!rowObjects[i]) {\n                    break;\n                }\n                if (rowObjects[i].isDetailRow) {\n                    this.parent.getRowsObject().splice(i, 1);\n                    i--;\n                }\n            }\n        }\n        if (args.target.classList.contains('e-rowcelldrag')) {\n            args.target = args.target.parentElement;\n        }\n        if (this.parent.frozenRows) {\n            this.updateFrozenRowreOrder(args);\n        }\n        else {\n            this.updateFrozenColumnreOrder(args);\n        }\n        if (this.selectedRowColls.length > 0) {\n            this.parent.selectRows(this.selectedRowColls);\n            var indexes = [];\n            if (this.parent.filterSettings.columns.length || this.parent.sortSettings.columns.length) {\n                for (var i = 0, len = args.rows.length; i < len; i++) {\n                    indexes.push(parseInt(args.rows[i].getAttribute(literals.ariaRowIndex), 10));\n                }\n                this.selectedRowColls = indexes;\n            }\n            this.selectedRowColls = [];\n        }\n    };\n    RowDD.prototype.currentViewData = function () {\n        var selectedIndexes = this.parent.getSelectedRowIndexes();\n        var currentVdata = [];\n        var fromIdx = parseInt(this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n        for (var i = 0, n = selectedIndexes.length; i < n; i++) {\n            var currentV = 'currentViewData';\n            currentVdata[i] = this.parent[currentV][selectedIndexes[i]];\n        }\n        if (!this.parent.rowDropSettings.targetID && selectedIndexes.length === 0) {\n            currentVdata[0] = this.parent.currentViewData[fromIdx];\n        }\n        return currentVdata;\n    };\n    RowDD.prototype.saveChange = function (changeRecords, query) {\n        var _this = this;\n        this.parent.getDataModule().saveChanges(changeRecords, this.parent.getPrimaryKeyFieldNames()[0], {}, query)\n            .then(function () {\n            _this.parent.notify(events.modelChanged, {\n                type: events.actionBegin, requestType: 'rowdraganddrop'\n            });\n        }).catch(function (e) {\n            var error = 'error';\n            var message = 'message';\n            if (!isNullOrUndefined(e[error]) && !isNullOrUndefined(e[error][message])) {\n                e[error] = e[error][message];\n            }\n            _this.parent.trigger(events.actionFailure, e);\n        });\n    };\n    RowDD.prototype.reorderRows = function (fromIndexes, toIndex) {\n        var selectedIndexes = this.parent.getSelectedRowIndexes();\n        var selectedRecords = [];\n        var draggedRecords = [];\n        var currentViewData = this.parent.renderModule.data.dataManager.dataSource.json;\n        var skip = this.parent.allowPaging ?\n            (this.parent.pageSettings.currentPage * this.parent.pageSettings.pageSize) - this.parent.pageSettings.pageSize : 0;\n        var dropIdx = toIndex + skip;\n        var actualIdx = fromIndexes[0] + skip;\n        for (var i = 0, len = fromIndexes.length; i < len; i++) {\n            draggedRecords[i] = currentViewData[fromIndexes[i] + skip];\n        }\n        for (var i = 0, len = selectedIndexes.length; i < len; i++) {\n            selectedRecords[i] = currentViewData[selectedIndexes[i] + skip];\n        }\n        for (var i = 0, len = draggedRecords.length; i < len; i++) {\n            if (i !== 0) {\n                for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n                    if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) ===\n                        JSON.stringify(draggedRecords[i])) {\n                        actualIdx = j;\n                        break;\n                    }\n                }\n                for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n                    if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) === JSON.stringify(draggedRecords[i - 1])) {\n                        if (actualIdx > j) {\n                            dropIdx = j + 1;\n                        }\n                        break;\n                    }\n                }\n            }\n            this.reorderRow(actualIdx - skip, dropIdx - skip);\n        }\n        if (this.isRefresh) {\n            this.parent.notify(events.modelChanged, {\n                type: events.actionBegin, requestType: 'rowdraganddrop'\n            });\n        }\n        for (var i = 0, len = selectedRecords.length; i < len; i++) {\n            for (var j = 0, len1 = currentViewData.length; j < len1; j++) {\n                if (JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[j]) === JSON.stringify(selectedRecords[i])) {\n                    selectedIndexes[i] = j - skip;\n                    break;\n                }\n            }\n        }\n        this.selectedRowColls = selectedIndexes;\n    };\n    RowDD.prototype.stopTimer = function () {\n        window.clearInterval(this.timer);\n    };\n    /**\n    * To trigger action complete event.\n    *\n    * @param {NotifyArgs} e - specifies the NotifyArgs\n    * @returns {void}\n    * @hidden\n    */\n    RowDD.prototype.onActionComplete = function (e) {\n        this.parent.trigger(events.actionComplete, extend(e, { type: events.actionComplete, requestType: 'rowdraganddrop' }));\n    };\n    RowDD.prototype.initializeDrag = function () {\n        var gObj = this.parent;\n        this.draggable = new Draggable(gObj.element, {\n            dragTarget: '.e-rowcelldrag, .e-rowdragdrop, .e-rowcell',\n            distance: 5,\n            helper: this.helper,\n            dragStart: this.dragStart,\n            drag: this.drag,\n            dragStop: this.dragStop,\n            isReplaceDragEle: this.isReplaceDragEle,\n            isPreventSelect: false\n        });\n    };\n    RowDD.prototype.updateScrollPostion = function (e) {\n        var _this = this;\n        var y = getPosition(e).y;\n        var cliRect = this.isDropGrid.getContent().getBoundingClientRect();\n        var rowHeight = this.isDropGrid.getRowHeight() - 15;\n        var scrollElem = this.isDropGrid.getContent().firstElementChild;\n        var virtualScrollbtm = this.parent.enableVirtualization ? 20 : 0;\n        if (cliRect.top >= y) {\n            var scrollPixel_1 = -(this.isDropGrid.getRowHeight());\n            this.isOverflowBorder = false;\n            this.timer = window.setInterval(function () { _this.setScrollDown(scrollElem, scrollPixel_1); }, 200);\n        }\n        else if (cliRect.top + this.isDropGrid.getContent().clientHeight - rowHeight - 33 - virtualScrollbtm <= y) {\n            var scrollPixel_2 = (this.isDropGrid.getRowHeight());\n            this.isOverflowBorder = false;\n            this.timer = window.setInterval(function () { _this.setScrollDown(scrollElem, scrollPixel_2); }, 200);\n        }\n    };\n    RowDD.prototype.setScrollDown = function (scrollElem, scrollPixel) {\n        scrollElem.scrollTop = scrollElem.scrollTop + scrollPixel;\n    };\n    RowDD.prototype.moveDragRows = function (e, startedRow, targetRow) {\n        var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n        var element = closestElement(e.target, 'tr');\n        if (parentsUntil(element, 'e-grid') &&\n            (parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(element, 'e-grid').id || this.istargetGrid)) {\n            var targetElement = element ?\n                element : this.startedRow;\n            this.setBorder(targetElement, e.event, startedRow, targetRow);\n        }\n    };\n    RowDD.prototype.setBorder = function (element, event, startedRow, targetRow) {\n        var node = this.parent.element;\n        if (this.istargetGrid) {\n            node = this.isDropGrid.element;\n        }\n        var cloneElement = this.parent.element.querySelector('.e-cloneproperties');\n        this.removeFirstRowBorder(element);\n        this.removeLastRowBorder(element);\n        if (parentsUntil(element, 'e-grid') && element.classList.contains(literals.row) && ((!this.parent.rowDropSettings.targetID &&\n            parentsUntil(cloneElement.parentElement, 'e-grid').id === parentsUntil(element, 'e-grid').id) || this.istargetGrid)) {\n            removeClass(node.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'), ['e-dragborder']);\n            var rowElement = [];\n            var targetRowIndex = parseInt(targetRow.getAttribute(literals.ariaRowIndex), 10);\n            if (targetRow && targetRowIndex === 0) {\n                var div = this.parent.createElement('div', { className: 'e-firstrow-dragborder' });\n                var gridheaderEle = this.isDropGrid.getHeaderContent();\n                gridheaderEle.classList.add('e-grid-relative');\n                div.style.width = node.offsetWidth - this.getScrollWidth() + 'px';\n                if (!gridheaderEle.getElementsByClassName('e-firstrow-dragborder').length) {\n                    gridheaderEle.appendChild(div);\n                }\n            }\n            else if (this.parent.rowDropSettings.targetID && targetRow) {\n                element = this.isDropGrid.getRowByIndex(targetRowIndex - 1);\n                rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n            }\n            else if (targetRow && parseInt(startedRow.getAttribute(literals.ariaRowIndex), 10) > targetRowIndex) {\n                element = this.parent.getRowByIndex(targetRowIndex - 1);\n                rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n            }\n            else {\n                rowElement = [].slice.call(element.querySelectorAll('.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse'));\n            }\n            var frzCols = this.parent.isFrozenGrid();\n            if (targetRow && targetRowIndex !== 0 && frzCols) {\n                var rowIndex = parseInt(element.getAttribute(literals.ariaRowIndex), 10);\n                var selector = '.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse';\n                rowElement = this.borderRowElement(rowIndex, selector);\n            }\n            if (rowElement.length > 0) {\n                addRemoveActiveClasses(rowElement, true, 'e-dragborder');\n            }\n        }\n    };\n    RowDD.prototype.borderRowElement = function (rowIndex, selector) {\n        var lastRow = [];\n        lastRow = [].slice.call(this.isDropGrid.getRowByIndex(rowIndex).querySelectorAll(selector)).\n            concat([].slice.call(this.isDropGrid.getMovableRowByIndex(rowIndex).querySelectorAll(selector)));\n        if (this.isDropGrid.getFrozenMode() === literals.leftRight) {\n            lastRow = lastRow.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(rowIndex).querySelectorAll(selector)));\n        }\n        return lastRow;\n    };\n    RowDD.prototype.getScrollWidth = function () {\n        var scrollElem = this.parent.getContent().firstElementChild;\n        return scrollElem.scrollWidth > scrollElem.offsetWidth ? Scroll.getScrollBarWidth() : 0;\n    };\n    RowDD.prototype.removeFirstRowBorder = function (element) {\n        if (this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder').length > 0 && element &&\n            element.rowIndex !== 0) {\n            remove(this.isDropGrid.element.getElementsByClassName('e-firstrow-dragborder')[0]);\n        }\n    };\n    RowDD.prototype.removeLastRowBorder = function (element) {\n        var islastRowIndex;\n        if (this.parent.enableVirtualization) {\n            islastRowIndex = element && parseInt(element.getAttribute(literals.ariaRowIndex), 10) !==\n                this.parent.renderModule.data.dataManager.dataSource.json.length - 1;\n        }\n        else {\n            islastRowIndex = element &&\n                this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length - 1).getAttribute('data-uid') !==\n                    element.getAttribute('data-uid');\n        }\n        if (this.parent.element.getElementsByClassName('e-lastrow-dragborder').length > 0 && element && islastRowIndex) {\n            remove(this.parent.element.getElementsByClassName('e-lastrow-dragborder')[0]);\n        }\n    };\n    RowDD.prototype.removeBorder = function (element) {\n        this.removeFirstRowBorder(element);\n        if (!this.parent.rowDropSettings.targetID) {\n            this.removeLastRowBorder(element);\n        }\n        element = (this.isDropGrid.isFrozenGrid() ? this.isDropGrid.getMovableRows() : this.isDropGrid.getRows()).filter(function (row) {\n            return row.querySelector('td.e-dragborder');\n        })[0];\n        if (element) {\n            var rowElement = [].slice.call(element.getElementsByClassName('e-dragborder'));\n            if (this.parent.isFrozenGrid()) {\n                var rowIndex = parseInt(element.getAttribute(literals.ariaRowIndex), 10);\n                var selector = '.e-dragborder';\n                rowElement = this.borderRowElement(rowIndex, selector);\n            }\n            addRemoveActiveClasses(rowElement, false, 'e-dragborder');\n        }\n    };\n    RowDD.prototype.getElementFromPosition = function (element, event) {\n        var position = getPosition(event);\n        element.style.display = 'none';\n        var target = document.elementFromPoint(position.x, position.y);\n        element.style.display = '';\n        return target;\n    };\n    RowDD.prototype.onDataBound = function () {\n        if (this.selectedRowColls.length > 0 && this.parent.enableVirtualization) {\n            this.parent.selectRows(this.selectedRowColls);\n            this.selectedRowColls = [];\n        }\n    };\n    RowDD.prototype.getTargetIdx = function (targetRow) {\n        return targetRow ? parseInt(targetRow.getAttribute(literals.ariaRowIndex), 10) : 0;\n    };\n    RowDD.prototype.singleRowDrop = function (e) {\n        var targetRow = closestElement(e.target, 'tr');\n        var srcControl = e.droppedElement.parentElement.ej2_instances[0];\n        var currentIndex = targetRow ? targetRow.rowIndex : srcControl.currentViewData.length - 1;\n        this.reorderRow(this.startedRowIndex, currentIndex);\n    };\n    RowDD.prototype.columnDrop = function (e) {\n        var gObj = this.parent;\n        if (e.droppedElement.getAttribute('action') !== 'grouping' &&\n            (parentsUntil(e.target, literals.row) || parentsUntil(e.target, 'e-emptyrow') || parentsUntil(e.target, literals.gridContent))) {\n            var targetRow = closestElement(e.target, 'tr');\n            var srcControl = void 0;\n            var currentIndex = void 0;\n            if ((e.droppedElement.querySelector('tr').getAttribute('single-dragrow') !== 'true' &&\n                e.droppedElement.parentElement.id === gObj.element.id)\n                || (e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true' &&\n                    e.droppedElement.parentElement.id !== gObj.element.id)) {\n                return;\n            }\n            if (e.droppedElement.parentElement.id !== gObj.element.id) {\n                srcControl = e.droppedElement.parentElement.ej2_instances[0];\n            }\n            else if (this.isSingleRowDragDrop || e.droppedElement.querySelector('tr').getAttribute('single-dragrow') === 'true') {\n                this.singleRowDrop(e);\n                return;\n            }\n            if (srcControl.element.id !== gObj.element.id && srcControl.rowDropSettings.targetID !== gObj.element.id) {\n                return;\n            }\n            var records = srcControl.getSelectedRecords();\n            var targetIndex = currentIndex = this.getTargetIdx(targetRow);\n            if (isNaN(targetIndex)) {\n                // eslint-disable-next-line @typescript-eslint/no-unused-vars\n                targetIndex = currentIndex = 0;\n            }\n            if (gObj.allowPaging) {\n                targetIndex = targetIndex + (gObj.pageSettings.currentPage * gObj.pageSettings.pageSize) - gObj.pageSettings.pageSize;\n            }\n            //Todo: drag and drop mapper & BatchChanges\n            gObj.notify(events.rowsAdded, { toIndex: targetIndex, records: records });\n            gObj.notify(events.modelChanged, {\n                type: events.actionBegin, requestType: 'rowdraganddrop'\n            });\n            var selectedRows = srcControl.getSelectedRowIndexes();\n            var skip = srcControl.allowPaging ?\n                (srcControl.pageSettings.currentPage * srcControl.pageSettings.pageSize) - srcControl.pageSettings.pageSize : 0;\n            this.selectedRows = [];\n            for (var i = 0, len = records.length; i < len; i++) {\n                this.selectedRows.push(skip + selectedRows[i]);\n            }\n            srcControl.notify(events.rowsRemoved, { indexes: this.selectedRows, records: records });\n            srcControl.notify(events.modelChanged, {\n                type: events.actionBegin, requestType: 'rowdraganddrop'\n            });\n        }\n    };\n    RowDD.prototype.reorderRow = function (fromIndexes, toIndex) {\n        var gObj = this.parent;\n        if (!gObj.sortSettings.columns.length && !gObj.groupSettings.columns.length && !gObj.filterSettings.columns.length) {\n            //Todo: drag and drop mapper & BatchChanges\n            var skip = gObj.allowPaging ?\n                (gObj.pageSettings.currentPage * gObj.pageSettings.pageSize) - gObj.pageSettings.pageSize : 0;\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            var fromIndex = fromIndexes;\n            toIndex = toIndex + skip;\n            this.selectedRows = gObj.getSelectedRowIndexes();\n            gObj.notify(events.rowPositionChanged, {\n                fromIndex: fromIndexes + skip,\n                toIndex: toIndex\n            });\n        }\n    };\n    RowDD.prototype.enableAfterRender = function (e) {\n        if (e.module === this.getModuleName() && e.enable) {\n            this.initializeDrag();\n        }\n    };\n    /**\n     * To destroy the print\n     *\n     * @returns {void}\n     * @hidden\n     */\n    RowDD.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (this.parent.isDestroyed || !gridElement || (!gridElement.querySelector('.' + literals.gridHeader) &&\n            !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        this.draggable.destroy();\n        this.parent.off(events.initialEnd, this.initializeDrag);\n        this.parent.off(events.columnDrop, this.columnDrop);\n        this.parent.off(events.rowDragAndDropComplete, this.onActionComplete);\n        this.parent.removeEventListener(events.dataBound, this.onDataBoundFn);\n        this.parent.off(events.uiUpdate, this.enableAfterRender);\n        this.parent.off(events.destroy, this.destroy);\n        //destory ejdrag and drop\n    };\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    RowDD.prototype.getModuleName = function () {\n        return 'rowDragAndDrop';\n    };\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    RowDD.prototype.processArgs = function (target) {\n        var gObj = this.parent;\n        var dragIdx = parseInt(this.startedRow.getAttribute(literals.ariaRowIndex), 10);\n        if ((gObj.getSelectedRecords().length > 0 && this.startedRow.cells[0].classList.contains('e-selectionbackground') === false)\n            || gObj.getSelectedRecords().length === 0) {\n            if (this.parent.enableVirtualization) {\n                this.rows = [this.startedRow];\n            }\n            else {\n                this.rows = [this.parent.getRowByIndex(dragIdx)];\n                if (gObj.isFrozenGrid()) {\n                    this.rows = [gObj.getRowByIndex(dragIdx), gObj.getMovableRowByIndex(dragIdx)];\n                    if (gObj.getFrozenMode() === literals.leftRight) {\n                        this.rows = [\n                            gObj.getRowByIndex(dragIdx), gObj.getMovableRowByIndex(dragIdx), gObj.getFrozenRightRowByIndex(dragIdx)\n                        ];\n                    }\n                }\n            }\n            this.rowData = [this.parent.getRowInfo((this.startedRow).querySelector('.' + literals.rowCell)).rowData];\n        }\n        else {\n            this.rows = gObj.getSelectedRows();\n            this.rowData = gObj.getSelectedRecords();\n        }\n    };\n    return RowDD;\n}());\nexport { RowDD };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}