{"ast":null,"code":"import { extend, addClass, removeClass, setValue, closest, select } from '@syncfusion/ej2-base';\nimport { remove, classList } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { parentsUntil, inArray, refreshForeignData, getObject, alignFrozenEditForm, gridActionHandler, addRemoveEventListener } from '../base/util';\nimport { splitFrozenRowObjectCells, getGridRowElements } from '../base/util';\nimport { sliceElements, getCellByColAndRowIndex, getMovableTbody, getFrozenRightTbody } from '../base/util';\nimport { getGridRowObjects } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n/**\n * `BatchEdit` module is used to handle batch editing actions.\n *\n * @hidden\n */\nvar BatchEdit = /** @class */function () {\n  function BatchEdit(parent, serviceLocator, renderer) {\n    this.cellDetails = {};\n    this.originalCell = {};\n    this.cloneCell = {};\n    this.editNext = false;\n    this.preventSaveCell = false;\n    this.parent = parent;\n    this.serviceLocator = serviceLocator;\n    this.renderer = renderer;\n    this.focus = serviceLocator.getService('focus');\n    this.addEventListener();\n  }\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.evtHandlers = [{\n      event: events.click,\n      handler: this.clickHandler\n    }, {\n      event: events.dblclick,\n      handler: this.dblClickHandler\n    }, {\n      event: events.beforeCellFocused,\n      handler: this.onBeforeCellFocused\n    }, {\n      event: events.cellFocused,\n      handler: this.onCellFocused\n    }, {\n      event: events.doubleTap,\n      handler: this.dblClickHandler\n    }, {\n      event: events.keyPressed,\n      handler: this.keyDownHandler\n    }, {\n      event: events.editNextValCell,\n      handler: this.editNextValCell\n    }, {\n      event: events.closeBatch,\n      handler: this.closeForm\n    }, {\n      event: events.destroy,\n      handler: this.destroy\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    this.dataBoundFunction = this.dataBound.bind(this);\n    this.batchCancelFunction = this.batchCancel.bind(this);\n    this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n    this.parent.addEventListener(events.batchCancel, this.batchCancelFunction);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n    this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n    this.parent.removeEventListener(events.batchCancel, this.batchCancelFunction);\n  };\n  BatchEdit.prototype.batchCancel = function () {\n    this.parent.focusModule.restoreFocus();\n  };\n  BatchEdit.prototype.dataBound = function () {\n    this.parent.notify(events.toolbarRefresh, {});\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.destroy = function () {\n    this.removeEventListener();\n  };\n  BatchEdit.prototype.clickHandler = function (e) {\n    if (!parentsUntil(e.target, this.parent.element.id + '_add', true)) {\n      if (this.parent.isEdit && closest(this.form, 'td') !== closest(e.target, 'td')) {\n        this.saveCell();\n        this.editNextValCell();\n      }\n      if (parentsUntil(e.target, literals.rowCell) && !this.parent.isEdit) {\n        this.setCellIdx(e.target);\n      }\n    }\n  };\n  BatchEdit.prototype.dblClickHandler = function (e) {\n    var target = parentsUntil(e.target, literals.rowCell);\n    var tr = parentsUntil(e.target, literals.row);\n    var rowIndex = tr && parseInt(tr.getAttribute(literals.ariaRowIndex), 10);\n    var colIndex = target && parseInt(target.getAttribute(literals.ariaColIndex), 10);\n    if (!isNullOrUndefined(target) && !isNullOrUndefined(rowIndex) && !isNaN(colIndex) && !target.parentElement.classList.contains(literals.editedRow)) {\n      this.editCell(rowIndex, this.parent.getColumns()[colIndex].field, this.isAddRow(rowIndex));\n    }\n  };\n  BatchEdit.prototype.onBeforeCellFocused = function (e) {\n    if (this.parent.isEdit && this.validateFormObj() && (e.byClick || ['tab', 'shiftTab', 'enter', 'shiftEnter'].indexOf(e.keyArgs.action) > -1)) {\n      e.cancel = true;\n      if (e.byClick) {\n        e.clickArgs.preventDefault();\n      } else {\n        e.keyArgs.preventDefault();\n      }\n    }\n  };\n  BatchEdit.prototype.onCellFocused = function (e) {\n    var frzCols = this.parent.getFrozenLeftCount();\n    var frzRightCols = this.parent.getFrozenRightColumnsCount();\n    var mCont = this.parent.getContent().querySelector('.' + literals.movableContent);\n    var mHdr = this.parent.getHeaderContent().querySelector('.' + literals.movableHeader);\n    var clear = (!e.container.isContent || !e.container.isDataCell) && !(this.parent.frozenRows && e.container.isHeader);\n    if (!e.byKey || clear) {\n      if (this.parent.isEdit && clear) {\n        this.saveCell();\n      }\n      return;\n    }\n    var _a = e.container.indexes,\n      rowIndex = _a[0],\n      cellIndex = _a[1];\n    if (frzCols && (mCont.contains(e.element) || this.parent.frozenRows && mHdr.contains(e.element))) {\n      cellIndex += frzCols;\n    }\n    if (frzRightCols) {\n      var frHdr = this.parent.getHeaderContent().querySelector('.e-frozen-right-header');\n      var frCont = this.parent.getContent().querySelector('.e-frozen-right-content');\n      if (frCont.contains(e.element) || this.parent.frozenRows && frHdr.contains(e.element)) {\n        cellIndex += frzCols + this.parent.getMovableColumnsCount();\n      }\n    }\n    if (this.parent.frozenRows && e.container.isContent) {\n      rowIndex += this.parent.frozenRows;\n    }\n    var isEdit = this.parent.isEdit;\n    if (!this.parent.element.getElementsByClassName('e-popup-open').length) {\n      isEdit = isEdit && !this.validateFormObj();\n      switch (e.keyArgs.action) {\n        case 'tab':\n        case 'shiftTab':\n          // eslint-disable-next-line no-case-declarations\n          var col = this.parent.getColumns()[e.indexes[1]];\n          if (col && !this.parent.isEdit) {\n            this.editCell(e.indexes[0], col.field);\n          }\n          if (isEdit || this.parent.isLastCellPrimaryKey) {\n            this.editCellFromIndex(rowIndex, cellIndex);\n          }\n          break;\n        case 'enter':\n        case 'shiftEnter':\n          e.keyArgs.preventDefault();\n          // eslint-disable-next-line no-case-declarations\n          var args = {\n            cancel: false,\n            keyArgs: e.keyArgs\n          };\n          this.parent.notify('beforeFocusCellEdit', args);\n          if (!args.cancel && isEdit) {\n            this.editCell(rowIndex, this.cellDetails.column.field);\n          }\n          break;\n        case 'f2':\n          this.editCellFromIndex(rowIndex, cellIndex);\n          this.focus.focus();\n          break;\n      }\n    }\n  };\n  BatchEdit.prototype.isAddRow = function (index) {\n    return this.parent.getDataRows()[index].classList.contains('e-insertedrow');\n  };\n  BatchEdit.prototype.editCellFromIndex = function (rowIdx, cellIdx) {\n    this.cellDetails.rowIndex = rowIdx;\n    this.cellDetails.cellIndex = cellIdx;\n    this.editCell(rowIdx, this.parent.getColumns()[cellIdx].field, this.isAddRow(rowIdx));\n  };\n  BatchEdit.prototype.closeEdit = function () {\n    var _this = this;\n    var gObj = this.parent;\n    var rows = this.parent.getRowsObject();\n    var argument = {\n      cancel: false,\n      batchChanges: this.getBatchChanges()\n    };\n    gObj.notify(events.beforeBatchCancel, argument);\n    if (argument.cancel) {\n      return;\n    }\n    if (gObj.isEdit) {\n      this.saveCell(true);\n    }\n    this.isAdded = false;\n    gObj.clearSelection();\n    var allRows = getGridRowObjects(this.parent);\n    var _loop_1 = function (i) {\n      var isInsert = false;\n      var isDirty = rows[i].isDirty;\n      gridActionHandler(this_1.parent, function (tableName, rows) {\n        isInsert = _this.removeBatchElementChanges(rows[i], isDirty);\n        if (isInsert) {\n          rows.splice(i, 1);\n        }\n      }, allRows);\n      if (isInsert) {\n        i--;\n      }\n      out_i_1 = i;\n    };\n    var this_1 = this,\n      out_i_1;\n    for (var i = 0; i < rows.length; i++) {\n      _loop_1(i);\n      i = out_i_1;\n    }\n    if (!gObj.getContentTable().querySelector('tr.e-row')) {\n      gObj.renderModule.renderEmptyRow();\n    }\n    var args = {\n      requestType: 'batchCancel',\n      rows: this.parent.getRowsObject()\n    };\n    gObj.notify(events.batchCancel, {\n      rows: this.parent.getRowsObject().length ? this.parent.getRowsObject() : [new Row({\n        isDataRow: true,\n        cells: [new Cell({\n          isDataCell: true,\n          visible: true\n        })]\n      })]\n    });\n    gObj.selectRow(this.cellDetails.rowIndex);\n    this.refreshRowIdx();\n    gObj.notify(events.toolbarRefresh, {});\n    this.parent.notify(events.tooltipDestroy, {});\n    args = {\n      requestType: 'batchCancel',\n      rows: this.parent.getRowsObject()\n    };\n    gObj.trigger(events.batchCancel, args);\n  };\n  BatchEdit.prototype.removeBatchElementChanges = function (row, isDirty) {\n    var gObj = this.parent;\n    var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n    var isInstertedRemoved = false;\n    if (isDirty) {\n      row.isDirty = isDirty;\n      var tr = gObj.getRowElementByUID(row.uid);\n      if (tr) {\n        if (tr.classList.contains('e-insertedrow')) {\n          remove(tr);\n          isInstertedRemoved = true;\n        } else {\n          refreshForeignData(row, this.parent.getForeignKeyColumns(), row.data);\n          delete row.changes;\n          delete row.edit;\n          row.isDirty = false;\n          classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n          rowRenderer.refresh(row, gObj.getColumns(), false);\n        }\n        if (this.parent.aggregates.length > 0) {\n          var type = 'type';\n          var editType = [];\n          editType[type] = 'cancel';\n          this.parent.notify(events.refreshFooterRenderer, editType);\n          if (this.parent.groupSettings.columns.length > 0) {\n            this.parent.notify(events.groupAggregates, editType);\n          }\n        }\n      }\n    }\n    return isInstertedRemoved;\n  };\n  BatchEdit.prototype.removeHideAndSelection = function (tr) {\n    if (tr.classList.contains('e-hiddenrow')) {\n      tr.removeAttribute('aria-selected');\n      var tdElements = [].slice.call(tr.getElementsByClassName('e-selectionbackground'));\n      for (var i = 0; i < tdElements.length; i++) {\n        removeClass([tdElements[i]], ['e-selectionbackground', 'e-active']);\n      }\n    }\n    classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n  };\n  BatchEdit.prototype.deleteRecord = function (fieldname, data) {\n    this.saveCell();\n    if (this.validateFormObj()) {\n      this.saveCell(true);\n    }\n    this.isAdded = false;\n    this.bulkDelete(fieldname, data);\n    if (this.parent.aggregates.length > 0) {\n      this.parent.notify(events.refreshFooterRenderer, {});\n      if (this.parent.groupSettings.columns.length > 0) {\n        this.parent.notify(events.groupAggregates, {});\n      }\n    }\n  };\n  BatchEdit.prototype.addRecord = function (data) {\n    this.bulkAddRow(data);\n  };\n  BatchEdit.prototype.endEdit = function () {\n    if (this.parent.isEdit && this.validateFormObj()) {\n      return;\n    }\n    this.batchSave();\n  };\n  BatchEdit.prototype.closeForm = function () {\n    for (var i = 0; i < Object.keys(this.originalCell).length; i++) {\n      for (var j = 0; j < Object.keys(this.cloneCell).length; j++) {\n        if (Object.keys(this.originalCell)[i] === Object.keys(this.cloneCell)[j]) {\n          this.cloneCell[Object.keys(this.cloneCell)[j]].replaceWith(this.originalCell[Object.keys(this.originalCell)[i]]);\n          if (this.originalCell[Object.keys(this.originalCell)[i]].classList.contains('e-selectionbackground')) {\n            this.originalCell[Object.keys(this.originalCell)[i]].classList.remove('e-selectionbackground', 'e-cellselectionbackground', 'e-active');\n          }\n        }\n      }\n    }\n    this.cloneCell = {};\n    this.originalCell = {};\n  };\n  BatchEdit.prototype.validateFormObj = function () {\n    return this.parent.editModule.formObj && !this.parent.editModule.formObj.validate();\n  };\n  BatchEdit.prototype.batchSave = function () {\n    var gObj = this.parent;\n    var deletedRecords = 'deletedRecords';\n    if (gObj.isCheckBoxSelection) {\n      var checkAllBox = gObj.element.querySelector('.e-checkselectall').parentElement;\n      if (checkAllBox.classList.contains('e-checkbox-disabled') && gObj.pageSettings.totalRecordsCount > gObj.currentViewData.length) {\n        removeClass([checkAllBox], ['e-checkbox-disabled']);\n      }\n    }\n    this.saveCell();\n    if (gObj.isEdit || this.editNextValCell() || gObj.isEdit) {\n      return;\n    }\n    var changes = this.getBatchChanges();\n    if (this.parent.selectionSettings.type === 'Multiple' && changes[deletedRecords].length && this.parent.selectionSettings.persistSelection) {\n      changes[deletedRecords] = this.removeSelectedData;\n      this.removeSelectedData = [];\n    }\n    var original = {\n      changedRecords: this.parent.getRowsObject().filter(function (row) {\n        return row.isDirty && ['add', 'delete'].indexOf(row.edit) === -1;\n      }).map(function (row) {\n        return row.data;\n      })\n    };\n    var args = {\n      batchChanges: changes,\n      cancel: false\n    };\n    gObj.trigger(events.beforeBatchSave, args, function (beforeBatchSaveArgs) {\n      if (beforeBatchSaveArgs.cancel) {\n        return;\n      }\n      gObj.showSpinner();\n      gObj.notify(events.bulkSave, {\n        changes: changes,\n        original: original\n      });\n    });\n  };\n  BatchEdit.prototype.getBatchChanges = function () {\n    var changes = {\n      addedRecords: [],\n      deletedRecords: [],\n      changedRecords: []\n    };\n    var rows = this.parent.getRowsObject();\n    for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n      var row = rows_1[_i];\n      if (row.isDirty) {\n        switch (row.edit) {\n          case 'add':\n            changes.addedRecords.push(row.changes);\n            break;\n          case 'delete':\n            changes.deletedRecords.push(row.data);\n            break;\n          default:\n            changes.changedRecords.push(row.changes);\n        }\n      }\n    }\n    return changes;\n  };\n  /**\n   * @param {string} uid - specifes the uid\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.removeRowObjectFromUID = function (uid) {\n    var rows = this.parent.getRowsObject();\n    var i = 0;\n    for (var len = rows.length; i < len; i++) {\n      if (rows[i].uid === uid) {\n        break;\n      }\n    }\n    gridActionHandler(this.parent, function (tableName, rows) {\n      rows.splice(i, 1);\n    }, getGridRowObjects(this.parent));\n  };\n  /**\n   * @param {Row<Column>} row - specifies the row object\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addRowObject = function (row) {\n    var gObj = this.parent;\n    var isTop = gObj.editSettings.newRowPosition === 'Top';\n    gridActionHandler(this.parent, function (tableName, rows) {\n      var rowClone = row.clone();\n      rowClone.cells = splitFrozenRowObjectCells(gObj, rowClone.cells, tableName);\n      if (isTop) {\n        rows.unshift(rowClone);\n      } else {\n        rows.push(rowClone);\n      }\n    }, getGridRowObjects(this.parent), true);\n  };\n  // tslint:disable-next-line:max-func-body-length\n  BatchEdit.prototype.bulkDelete = function (fieldname, data) {\n    var _this = this;\n    this.removeSelectedData = [];\n    var gObj = this.parent;\n    var index = gObj.selectedRowIndex;\n    var selectedRows = gObj.getSelectedRows();\n    var args = {\n      primaryKey: this.parent.getPrimaryKeyFieldNames(),\n      rowIndex: index,\n      rowData: data ? data : gObj.getSelectedRecords()[0],\n      cancel: false\n    };\n    if (data) {\n      args.row = gObj.editModule.deleteRowUid ? gObj.getRowElementByUID(gObj.editModule.deleteRowUid) : gObj.getRows()[gObj.getCurrentViewRecords().indexOf(data)];\n    } else {\n      args.row = data ? gObj.getRows()[index] : selectedRows[0];\n    }\n    if (!args.row) {\n      return;\n    }\n    // tslint:disable-next-line:max-func-body-length\n    gObj.trigger(events.beforeBatchDelete, args, function (beforeBatchDeleteArgs) {\n      if (beforeBatchDeleteArgs.cancel) {\n        return;\n      }\n      _this.removeSelectedData = gObj.getSelectedRecords();\n      gObj.clearSelection();\n      beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row ? beforeBatchDeleteArgs.row : data ? gObj.getRows()[index] : selectedRows[0];\n      if (_this.parent.isFrozenGrid()) {\n        if (data) {\n          index = parseInt(beforeBatchDeleteArgs.row.getAttribute(literals.ariaRowIndex), 10);\n          selectedRows = [];\n          selectedRows.push(gObj.getRowByIndex(index));\n          selectedRows.push(gObj.getMovableRowByIndex(index));\n          if (gObj.getFrozenMode() === literals.leftRight) {\n            selectedRows.push(gObj.getFrozenRightRowByIndex(index));\n          }\n        }\n        for (var i = 0; i < selectedRows.length; i++) {\n          var uid = selectedRows[i].getAttribute('data-uid');\n          if (selectedRows[i].classList.contains('e-insertedrow')) {\n            _this.removeRowObjectFromUID(uid);\n            remove(selectedRows[i]);\n          } else {\n            var rowObj = gObj.getRowObjectFromUID(uid);\n            rowObj.isDirty = true;\n            rowObj.edit = 'delete';\n            classList(selectedRows[i], ['e-hiddenrow', 'e-updatedtd'], []);\n            if (gObj.frozenRows && index < gObj.frozenRows && gObj.getMovableDataRows().length >= gObj.frozenRows) {\n              gObj.getMovableHeaderTbody().appendChild(gObj.getMovableRowByIndex(gObj.frozenRows - 1));\n              gObj.getFrozenHeaderTbody().appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n              if (gObj.getFrozenMode() === literals.leftRight) {\n                gObj.getFrozenRightHeaderTbody().appendChild(gObj.getFrozenRightRowByIndex(gObj.frozenRows - 1));\n              }\n            }\n            if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n              gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n            }\n          }\n          delete selectedRows[i];\n        }\n      } else if (!_this.parent.isFrozenGrid() && (selectedRows.length === 1 || data)) {\n        var uid = beforeBatchDeleteArgs.row.getAttribute('data-uid');\n        uid = data && _this.parent.editModule.deleteRowUid ? uid = _this.parent.editModule.deleteRowUid : uid;\n        if (beforeBatchDeleteArgs.row.classList.contains('e-insertedrow')) {\n          _this.removeRowObjectFromUID(uid);\n          remove(beforeBatchDeleteArgs.row);\n        } else {\n          var rowObj = gObj.getRowObjectFromUID(uid);\n          rowObj.isDirty = true;\n          rowObj.edit = 'delete';\n          classList(beforeBatchDeleteArgs.row, ['e-hiddenrow', 'e-updatedtd'], []);\n        }\n        delete beforeBatchDeleteArgs.row;\n      } else {\n        for (var i = 0; i < selectedRows.length; i++) {\n          var uniqueid = selectedRows[i].getAttribute('data-uid');\n          if (selectedRows[i].classList.contains('e-insertedrow')) {\n            _this.removeRowObjectFromUID(uniqueid);\n            remove(selectedRows[i]);\n          } else {\n            classList(selectedRows[i], ['e-hiddenrow', 'e-updatedtd'], []);\n            var selectedRow = gObj.getRowObjectFromUID(uniqueid);\n            selectedRow.isDirty = true;\n            selectedRow.edit = 'delete';\n            delete selectedRows[i];\n          }\n        }\n      }\n      _this.refreshRowIdx();\n      if (data) {\n        gObj.editModule.deleteRowUid = undefined;\n        if (gObj.getSelectedRows().length) {\n          index = parseInt(gObj.getSelectedRows()[0].getAttribute(literals.ariaRowIndex), 10);\n        }\n      }\n      if (!gObj.isCheckBoxSelection) {\n        gObj.selectRow(index);\n      }\n      gObj.trigger(events.batchDelete, beforeBatchDeleteArgs);\n      gObj.notify(events.batchDelete, {\n        rows: _this.parent.getRowsObject()\n      });\n      gObj.notify(events.toolbarRefresh, {});\n    });\n  };\n  BatchEdit.prototype.refreshRowIdx = function () {\n    var gObj = this.parent;\n    var rows = gObj.getAllDataRows(true);\n    var dataRows = getGridRowElements(this.parent);\n    var dataObjects = getGridRowObjects(this.parent);\n    var _loop_2 = function (i, j, len) {\n      if (rows[i].classList.contains(literals.row) && !rows[i].classList.contains('e-hiddenrow')) {\n        gridActionHandler(this_2.parent, function (tableName, rowElements, rowObjects) {\n          rowElements[i].setAttribute(literals.ariaRowIndex, j.toString());\n          rowObjects[i].index = j;\n        }, dataRows, null, dataObjects);\n        j++;\n      } else {\n        gridActionHandler(this_2.parent, function (tableName, rowElements, rowObjects) {\n          rowElements[i].removeAttribute(literals.ariaRowIndex);\n          rowObjects[i].index = -1;\n        }, dataRows, null, dataObjects);\n      }\n      out_j_1 = j;\n    };\n    var this_2 = this,\n      out_j_1;\n    for (var i = 0, j = 0, len = rows.length; i < len; i++) {\n      _loop_2(i, j, len);\n      j = out_j_1;\n    }\n  };\n  BatchEdit.prototype.getIndexFromData = function (data) {\n    return inArray(data, this.parent.getCurrentViewRecords());\n  };\n  BatchEdit.prototype.bulkAddRow = function (data) {\n    var _this = this;\n    var gObj = this.parent;\n    if (!gObj.editSettings.allowAdding) {\n      return;\n    }\n    if (gObj.isEdit) {\n      this.saveCell();\n      this.parent.notify(events.editNextValCell, {});\n    }\n    if (gObj.isEdit) {\n      return;\n    }\n    this.parent.element.classList.add('e-editing');\n    var defaultData = data ? data : this.getDefaultData();\n    var args = {\n      defaultData: defaultData,\n      primaryKey: gObj.getPrimaryKeyFieldNames(),\n      cancel: false\n    };\n    gObj.trigger(events.beforeBatchAdd, args, function (beforeBatchAddArgs) {\n      if (beforeBatchAddArgs.cancel) {\n        return;\n      }\n      _this.isAdded = true;\n      gObj.clearSelection();\n      var mTr;\n      var frTr;\n      var row = new RowRenderer(_this.serviceLocator, null, _this.parent);\n      var model = new RowModelGenerator(_this.parent);\n      var modelData = model.generateRows([beforeBatchAddArgs.defaultData]);\n      var tr = row.render(modelData[0], gObj.getColumns());\n      var col;\n      var index;\n      for (var i = 0; i < _this.parent.groupSettings.columns.length; i++) {\n        tr.insertBefore(_this.parent.createElement('td', {\n          className: 'e-indentcell'\n        }), tr.firstChild);\n        modelData[0].cells.unshift(new Cell({\n          cellType: CellType.Indent\n        }));\n      }\n      var tbody = gObj.getContentTable().querySelector(literals.tbody);\n      tr.classList.add('e-insertedrow');\n      if (tbody.querySelector('.e-emptyrow')) {\n        var emptyRow = tbody.querySelector('.e-emptyrow');\n        emptyRow.parentNode.removeChild(emptyRow);\n        _this.removeFrozenTbody();\n      }\n      if (gObj.isFrozenGrid()) {\n        frTr = tr.cloneNode(true);\n        mTr = _this.renderMovable(tr, frTr);\n        tr = gObj.getFrozenMode() === 'Right' ? frTr : tr;\n        _this.renderFrozenAddRow(tr, mTr, frTr);\n      }\n      if (gObj.frozenRows && gObj.editSettings.newRowPosition === 'Top') {\n        tbody = gObj.getHeaderTable().querySelector(literals.tbody);\n      } else {\n        tbody = gObj.getContentTable().querySelector(literals.tbody);\n      }\n      if (_this.parent.editSettings.newRowPosition === 'Top') {\n        tbody.insertBefore(tr, tbody.firstChild);\n      } else {\n        tbody.appendChild(tr);\n      }\n      addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n      modelData[0].isDirty = true;\n      modelData[0].changes = extend({}, {}, modelData[0].data, true);\n      modelData[0].edit = 'add';\n      _this.addRowObject(modelData[0]);\n      _this.refreshRowIdx();\n      _this.focus.forgetPrevious();\n      gObj.notify(events.batchAdd, {\n        rows: _this.parent.getRowsObject(),\n        args: {\n          isFrozen: _this.parent.isFrozenGrid()\n        }\n      });\n      var changes = _this.getBatchChanges();\n      var btmIdx = _this.getBottomIndex();\n      if (_this.parent.editSettings.newRowPosition === 'Top') {\n        gObj.selectRow(0);\n      } else {\n        gObj.selectRow(btmIdx);\n      }\n      if (!data) {\n        index = _this.findNextEditableCell(0, true);\n        col = gObj.getColumns()[index];\n        if (_this.parent.editSettings.newRowPosition === 'Top') {\n          _this.editCell(0, col.field, true);\n        } else {\n          _this.editCell(btmIdx, col.field, true);\n        }\n      }\n      if (_this.parent.aggregates.length > 0 && (data || changes[literals.addedRecords].length)) {\n        _this.parent.notify(events.refreshFooterRenderer, {});\n      }\n      var args1 = {\n        defaultData: beforeBatchAddArgs.defaultData,\n        row: tr,\n        columnObject: col,\n        columnIndex: index,\n        primaryKey: beforeBatchAddArgs.primaryKey,\n        cell: tr.cells[index]\n      };\n      gObj.trigger(events.batchAdd, args1);\n      if (gObj.isFrozenGrid()) {\n        alignFrozenEditForm(mTr.querySelector('td:not(.e-hide)'), tr.querySelector('td:not(.e-hide)'));\n      }\n    });\n  };\n  BatchEdit.prototype.renderFrozenAddRow = function (tr, mTr, frTr) {\n    var gObj = this.parent;\n    var mTbody = getMovableTbody(this.parent);\n    var frTbody = getFrozenRightTbody(this.parent);\n    if (gObj.editSettings.newRowPosition === 'Top') {\n      mTbody.insertBefore(mTr, mTbody.firstChild);\n    } else {\n      mTbody.appendChild(mTr);\n    }\n    addClass([].slice.call(mTr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n    if (frTbody && frTr) {\n      if (gObj.editSettings.newRowPosition === 'Top') {\n        frTbody.insertBefore(frTr, frTbody.firstChild);\n      } else {\n        frTbody.appendChild(frTr);\n      }\n      addClass([].slice.call(frTr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n      alignFrozenEditForm(frTr.querySelector('td:not(.e-hide)'), tr.querySelector('td:not(.e-hide)'));\n    }\n    if (gObj.height === 'auto') {\n      gObj.notify(events.frozenHeight, {});\n    }\n  };\n  BatchEdit.prototype.removeFrozenTbody = function () {\n    var gObj = this.parent;\n    if (gObj.isFrozenGrid()) {\n      var moveTbody = gObj.getContent().querySelector('.' + literals.movableContent).querySelector(literals.tbody);\n      moveTbody.firstElementChild.parentNode.removeChild(moveTbody.firstElementChild);\n      if (gObj.getFrozenMode() === literals.leftRight) {\n        var frTbody = gObj.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n        frTbody.firstElementChild.parentNode.removeChild(frTbody.firstElementChild);\n      }\n    }\n  };\n  BatchEdit.prototype.renderMovable = function (ele, rightEle) {\n    var mEle = ele.cloneNode(true);\n    var movable = this.parent.getMovableColumnsCount();\n    var left = this.parent.getFrozenLeftCount();\n    var right = this.parent.getFrozenRightColumnsCount();\n    sliceElements(ele, 0, left);\n    sliceElements(mEle, left, right ? mEle.children.length - right : mEle.children.length);\n    sliceElements(rightEle, left + movable, rightEle.children.length);\n    return mEle;\n  };\n  BatchEdit.prototype.findNextEditableCell = function (columnIndex, isAdd, isValOnly) {\n    var cols = this.parent.getColumns();\n    var endIndex = cols.length;\n    var validation;\n    for (var i = columnIndex; i < endIndex; i++) {\n      validation = isValOnly ? isNullOrUndefined(cols[i].validationRules) : false;\n      if (!isAdd && this.checkNPCell(cols[i])) {\n        return i;\n      } else if (isAdd && !cols[i].template && cols[i].visible && cols[i].allowEditing && !(cols[i].isIdentity && cols[i].isPrimaryKey) && !validation) {\n        return i;\n      }\n    }\n    return -1;\n  };\n  BatchEdit.prototype.checkNPCell = function (col) {\n    return !col.template && col.visible && !col.isPrimaryKey && !col.isIdentity && col.allowEditing;\n  };\n  BatchEdit.prototype.getDefaultData = function () {\n    var gObj = this.parent;\n    var data = {};\n    var dValues = {\n      'number': 0,\n      'string': null,\n      'boolean': false,\n      'date': null,\n      'datetime': null\n    };\n    for (var _i = 0, _a = gObj.columnModel; _i < _a.length; _i++) {\n      var col = _a[_i];\n      if (col.field) {\n        setValue(col.field, Object.keys(col).indexOf('defaultValue') >= 0 ? col.defaultValue : dValues[col.type], data);\n      }\n    }\n    return data;\n  };\n  BatchEdit.prototype.setCellIdx = function (target) {\n    var gLen = 0;\n    if (this.parent.allowGrouping) {\n      gLen = this.parent.groupSettings.columns.length;\n    }\n    this.cellDetails.cellIndex = target.cellIndex - gLen;\n    this.cellDetails.rowIndex = parseInt(target.getAttribute('index'), 10);\n  };\n  BatchEdit.prototype.editCell = function (index, field, isAdd) {\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    this.index = index;\n    this.field = field;\n    this.isAdd = isAdd;\n    var checkEdit = gObj.isEdit && !(this.cellDetails.column.field === field && this.cellDetails.rowIndex === index && this.parent.getDataRows().length - 1 !== index);\n    if (gObj.editSettings.allowEditing) {\n      if (!checkEdit && col.allowEditing) {\n        this.editCellExtend(index, field, isAdd);\n      } else if (checkEdit) {\n        this.editNext = true;\n        this.saveCell();\n      }\n    }\n  };\n  BatchEdit.prototype.editCellExtend = function (index, field, isAdd) {\n    var _this = this;\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    var keys = gObj.getPrimaryKeyFieldNames();\n    if (gObj.isEdit) {\n      return;\n    }\n    var row;\n    var mRowData;\n    var rowData = extend({}, {}, this.getDataByIndex(index), true);\n    if (col.getFreezeTableName() === 'movable' || col.getFreezeTableName() === literals.frozenRight) {\n      row = col.getFreezeTableName() === 'movable' ? gObj.getMovableDataRows()[index] : gObj.getFrozenRightDataRows()[index];\n      mRowData = this.parent.getRowObjectFromUID(row.getAttribute('data-uid'));\n      rowData = mRowData.changes ? extend({}, {}, mRowData.changes, true) : rowData;\n    } else {\n      row = gObj.getDataRows()[index];\n      rowData = extend({}, {}, this.getDataByIndex(index), true);\n    }\n    if (keys[0] === col.field && !row.classList.contains('e-insertedrow') || col.columns || col.isPrimaryKey && col.isIdentity) {\n      this.parent.isLastCellPrimaryKey = true;\n      return;\n    }\n    this.parent.isLastCellPrimaryKey = false;\n    this.parent.element.classList.add('e-editing');\n    var rowObj = gObj.getRowObjectFromUID(row.getAttribute('data-uid'));\n    var cells = [].slice.apply(row.cells);\n    var args = {\n      columnName: col.field,\n      isForeignKey: !isNullOrUndefined(col.foreignKeyValue),\n      primaryKey: keys,\n      rowData: rowData,\n      validationRules: extend({}, col.validationRules ? col.validationRules : {}),\n      value: getObject(col.field, rowData),\n      type: !isAdd ? 'edit' : 'add',\n      cancel: false,\n      foreignKeyData: rowObj && rowObj.foreignKeyData\n    };\n    args.cell = cells[this.getColIndex(cells, this.getCellIdx(col.uid))];\n    args.row = row;\n    args.columnObject = col;\n    if (!args.cell) {\n      return;\n    }\n    gObj.trigger(events.cellEdit, args, function (cellEditArgs) {\n      if (cellEditArgs.cancel) {\n        return;\n      }\n      cellEditArgs.cell = cellEditArgs.cell ? cellEditArgs.cell : cells[_this.getColIndex(cells, _this.getCellIdx(col.uid))];\n      cellEditArgs.row = cellEditArgs.row ? cellEditArgs.row : row;\n      cellEditArgs.columnObject = cellEditArgs.columnObject ? cellEditArgs.columnObject : col;\n      cellEditArgs.columnObject.index = isNullOrUndefined(cellEditArgs.columnObject.index) ? 0 : cellEditArgs.columnObject.index;\n      _this.cellDetails = {\n        rowData: rowData,\n        column: col,\n        value: cellEditArgs.value,\n        isForeignKey: cellEditArgs.isForeignKey,\n        rowIndex: index,\n        cellIndex: parseInt(cellEditArgs.cell.getAttribute(literals.ariaColIndex), 10),\n        foreignKeyData: cellEditArgs.foreignKeyData\n      };\n      if (cellEditArgs.cell.classList.contains('e-updatedtd')) {\n        _this.isColored = true;\n        cellEditArgs.cell.classList.remove('e-updatedtd');\n      }\n      gObj.isEdit = true;\n      gObj.clearSelection();\n      if (!gObj.isCheckBoxSelection || !gObj.isPersistSelection) {\n        gObj.selectRow(_this.cellDetails.rowIndex, true);\n      }\n      _this.renderer.update(cellEditArgs);\n      _this.parent.notify(events.batchEditFormRendered, cellEditArgs);\n      _this.form = select('#' + gObj.element.id + 'EditForm', gObj.element);\n      gObj.editModule.applyFormValidation([col]);\n      _this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n    });\n  };\n  BatchEdit.prototype.updateCell = function (rowIndex, field, value) {\n    var gObj = this.parent;\n    var col = gObj.getColumnByField(field);\n    var index = gObj.getColumnIndexByField(field);\n    if (col && !col.isPrimaryKey && col.allowEditing) {\n      var td = getCellByColAndRowIndex(this.parent, col, rowIndex, index);\n      var rowObj = col.getFreezeTableName() === 'movable' ? this.parent.getMovableRowsObject()[rowIndex] : col.getFreezeTableName() === literals.frozenRight ? gObj.getFrozenRightRowsObject()[rowIndex] : gObj.getRowObjectFromUID(td.parentElement.getAttribute('data-uid'));\n      this.refreshTD(td, col, rowObj, value);\n      this.parent.trigger(events.queryCellInfo, {\n        cell: this.newReactTd || td,\n        column: col,\n        data: rowObj.changes\n      });\n    }\n  };\n  BatchEdit.prototype.setChanges = function (rowObj, field, value) {\n    var currentRowObj;\n    if (!this.parent.isFrozenGrid()) {\n      if (!rowObj.changes) {\n        rowObj.changes = extend({}, {}, rowObj.data, true);\n      }\n      if (!isNullOrUndefined(field)) {\n        DataUtil.setValue(field, value, rowObj.changes);\n      }\n      if (rowObj.data[field] !== value) {\n        var type = this.parent.getColumnByField(field).type;\n        if (type === 'date' || type === 'datetime') {\n          if (new Date(rowObj.data[field]).toString() !== new Date(value).toString()) {\n            rowObj.isDirty = true;\n          }\n        } else {\n          rowObj.isDirty = true;\n        }\n      }\n    } else {\n      var rowEle = this.parent.getRowElementByUID(rowObj.uid);\n      var rowIndex = parseInt(rowEle.getAttribute(literals.ariaRowIndex), 10);\n      currentRowObj = this.parent.getRowsObject()[rowIndex];\n      if (!currentRowObj.changes) {\n        currentRowObj.changes = extend({}, {}, rowObj.data, true);\n      }\n      if (!isNullOrUndefined(field)) {\n        setValue(field, value, currentRowObj.changes);\n      }\n      var movableRowObject = this.parent.getMovableRowsObject()[rowIndex];\n      movableRowObject.changes = extend({}, {}, currentRowObj.changes, true);\n      if (rowObj.data[field] !== value) {\n        movableRowObject.isDirty = true;\n        currentRowObj.isDirty = true;\n      }\n      if (this.parent.getFrozenMode() === literals.leftRight) {\n        var frRowObject = this.parent.getFrozenRightRowsObject()[rowIndex];\n        frRowObject.changes = extend({}, {}, currentRowObj.changes, true);\n        if (rowObj.data[field] !== value) {\n          frRowObject.isDirty = true;\n        }\n      }\n    }\n  };\n  BatchEdit.prototype.updateRow = function (index, data) {\n    var keys = Object.keys(data);\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n      var col = keys_1[_i];\n      this.updateCell(index, col, data[col]);\n    }\n  };\n  BatchEdit.prototype.getCellIdx = function (uid) {\n    var cIdx = this.parent.getColumnIndexByUid(uid) + this.parent.groupSettings.columns.length;\n    if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n      cIdx++;\n    }\n    if (this.parent.isRowDragable()) {\n      cIdx++;\n    }\n    return cIdx;\n  };\n  BatchEdit.prototype.refreshTD = function (td, column, rowObj, value) {\n    var cell = new CellRenderer(this.parent, this.serviceLocator);\n    var rowcell;\n    value = column.type === 'number' && !isNullOrUndefined(value) ? parseFloat(value) : value;\n    this.setChanges(rowObj, column.field, value);\n    var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount() || this.parent.getFrozenRightColumnsCount();\n    frzCols = frzCols && this.parent.isRowDragable() ? frzCols + 1 : frzCols;\n    refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n    if (frzCols && column.getFreezeTableName() === 'movable' && this.parent.getColumns().length === rowObj.cells.length) {\n      rowcell = rowObj.cells.slice(frzCols, rowObj.cells.length);\n    } else {\n      rowcell = rowObj.cells;\n    }\n    var parentElement;\n    var cellIndex;\n    if (this.parent.isReact) {\n      parentElement = td.parentElement;\n      cellIndex = td.cellIndex;\n    }\n    var index = 0;\n    if (frzCols) {\n      index = column.getFreezeTableName() === 'movable' && this.parent.getFrozenMode() !== 'Right' ? frzCols : column.getFreezeTableName() === literals.frozenRight ? this.parent.getFrozenLeftColumnsCount() + this.parent.getMovableColumnsCount() : index;\n    }\n    cell.refreshTD(td, rowcell[this.getCellIdx(column.uid) - index], rowObj.changes, {\n      'index': this.getCellIdx(column.uid)\n    });\n    if (this.parent.isReact) {\n      this.newReactTd = parentElement.cells[cellIndex];\n      parentElement.cells[cellIndex].classList.add('e-updatedtd');\n    } else {\n      td.classList.add('e-updatedtd');\n    }\n    td.classList.add('e-updatedtd');\n    this.parent.notify(events.toolbarRefresh, {});\n  };\n  BatchEdit.prototype.getColIndex = function (cells, index) {\n    var cIdx = 0;\n    if (this.parent.allowGrouping && this.parent.groupSettings.columns) {\n      cIdx = this.parent.groupSettings.columns.length;\n    }\n    if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n      cIdx++;\n    }\n    if (this.parent.isRowDragable()) {\n      cIdx++;\n    }\n    for (var m = 0; m < cells.length; m++) {\n      var colIndex = parseInt(cells[m].getAttribute(literals.ariaColIndex), 10);\n      if (colIndex === index - cIdx) {\n        return m;\n      }\n    }\n    return -1;\n  };\n  BatchEdit.prototype.editNextValCell = function () {\n    var gObj = this.parent;\n    var btmIdx = this.getBottomIndex();\n    if (this.isAdded && !gObj.isEdit) {\n      for (var i = this.cellDetails.cellIndex; i < gObj.getColumns().length; i++) {\n        if (gObj.isEdit) {\n          return;\n        }\n        var index = this.findNextEditableCell(this.cellDetails.cellIndex + 1, true, true);\n        var col = gObj.getColumns()[index];\n        if (col) {\n          if (this.parent.editSettings.newRowPosition === 'Bottom') {\n            this.editCell(btmIdx, col.field, true);\n          } else {\n            var args = {\n              index: 0,\n              column: col\n            };\n            this.parent.notify(events.nextCellIndex, args);\n            this.editCell(args.index, col.field, true);\n          }\n          this.saveCell();\n        }\n      }\n      if (!gObj.isEdit) {\n        this.isAdded = false;\n      }\n    }\n  };\n  BatchEdit.prototype.escapeCellEdit = function () {\n    var args = this.generateCellArgs();\n    args.value = args.previousValue;\n    this.successCallBack(args, args.cell.parentElement, args.column, true)(args);\n  };\n  BatchEdit.prototype.generateCellArgs = function () {\n    var gObj = this.parent;\n    this.parent.element.classList.remove('e-editing');\n    var column = this.cellDetails.column;\n    var obj = {};\n    obj[column.field] = getObject(column.field, this.cellDetails.rowData);\n    var editedData = gObj.editModule.getCurrentEditedData(this.form, obj);\n    var cloneEditedData = extend({}, editedData);\n    editedData = extend({}, editedData, this.cellDetails.rowData);\n    var value = getObject(column.field, cloneEditedData);\n    if (!isNullOrUndefined(column.field) && !isUndefined(value)) {\n      setValue(column.field, value, editedData);\n    }\n    var args = {\n      columnName: column.field,\n      value: getObject(column.field, editedData),\n      rowData: this.cellDetails.rowData,\n      column: column,\n      previousValue: this.cellDetails.value,\n      isForeignKey: this.cellDetails.isForeignKey,\n      cancel: false\n    };\n    args.cell = this.form.parentElement;\n    args.columnObject = column;\n    return args;\n  };\n  BatchEdit.prototype.saveCell = function (isForceSave) {\n    if (this.preventSaveCell || !this.form) {\n      return;\n    }\n    var gObj = this.parent;\n    if (!isForceSave && (!gObj.isEdit || this.validateFormObj())) {\n      return;\n    }\n    this.preventSaveCell = true;\n    var args = this.generateCellArgs();\n    var tr = args.cell.parentElement;\n    var col = args.column;\n    if (!isForceSave) {\n      gObj.trigger(events.cellSave, args, this.successCallBack(args, tr, col));\n      gObj.notify(events.batchForm, {\n        formObj: this.form\n      });\n    } else {\n      this.successCallBack(args, tr, col)(args);\n    }\n  };\n  BatchEdit.prototype.successCallBack = function (cellSaveArgs, tr, column, isEscapeCellEdit) {\n    var _this = this;\n    return function (cellSaveArgs) {\n      var gObj = _this.parent;\n      cellSaveArgs.cell = cellSaveArgs.cell ? cellSaveArgs.cell : _this.form.parentElement;\n      cellSaveArgs.columnObject = cellSaveArgs.columnObject ? cellSaveArgs.columnObject : column;\n      cellSaveArgs.columnObject.index = isNullOrUndefined(cellSaveArgs.columnObject.index) ? 0 : cellSaveArgs.columnObject.index;\n      if (cellSaveArgs.cancel) {\n        _this.preventSaveCell = false;\n        if (_this.editNext) {\n          _this.editNext = false;\n          if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n            return;\n          }\n          _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n        }\n        return;\n      }\n      gObj.editModule.destroyWidgets([column]);\n      gObj.isEdit = false;\n      gObj.editModule.destroyForm();\n      _this.parent.notify(events.tooltipDestroy, {});\n      var rowObj = parentsUntil(cellSaveArgs.cell, literals.movableContent) || parentsUntil(cellSaveArgs.cell, literals.movableHeader) ? gObj.getRowObjectFromUID(tr.getAttribute('data-uid'), true) : gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n      if (gObj.getFrozenMode() === literals.leftRight && (parentsUntil(cellSaveArgs.cell, 'e-frozen-right-header') || parentsUntil(cellSaveArgs.cell, 'e-frozen-right-content'))) {\n        rowObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'), false, true);\n      }\n      _this.refreshTD(cellSaveArgs.cell, column, rowObj, cellSaveArgs.value);\n      if (_this.parent.isReact) {\n        cellSaveArgs.cell = _this.newReactTd;\n      }\n      removeClass([tr], [literals.editedRow, 'e-batchrow']);\n      removeClass([cellSaveArgs.cell], ['e-editedbatchcell', 'e-boolcell']);\n      if (!isNullOrUndefined(cellSaveArgs.value) && cellSaveArgs.value.toString() === (!isNullOrUndefined(_this.cellDetails.value) ? _this.cellDetails.value : '').toString() && !_this.isColored || isNullOrUndefined(cellSaveArgs.value) && isNullOrUndefined(rowObj.data[column.field]) && isNullOrUndefined(_this.cellDetails.value) && !cellSaveArgs.cell.parentElement.classList.contains('e-insertedrow')) {\n        cellSaveArgs.cell.classList.remove('e-updatedtd');\n      }\n      if (isNullOrUndefined(isEscapeCellEdit)) {\n        gObj.trigger(events.cellSaved, cellSaveArgs);\n      }\n      gObj.notify(events.toolbarRefresh, {});\n      _this.isColored = false;\n      if (_this.parent.aggregates.length > 0) {\n        _this.parent.notify(events.refreshFooterRenderer, {});\n        if (_this.parent.groupSettings.columns.length > 0 && !_this.isAddRow(_this.cellDetails.rowIndex)) {\n          _this.parent.notify(events.groupAggregates, {});\n        }\n      }\n      _this.preventSaveCell = false;\n      if (_this.editNext) {\n        _this.editNext = false;\n        if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n          return;\n        }\n        var col = gObj.getColumnByField(_this.field);\n        if (col && col.allowEditing) {\n          _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n        }\n      }\n      if (isEscapeCellEdit) {\n        gObj.notify(events.restoreFocus, {});\n      }\n    };\n  };\n  BatchEdit.prototype.getDataByIndex = function (index) {\n    var row = this.parent.getRowObjectFromUID(this.parent.getDataRows()[index].getAttribute('data-uid'));\n    return row.changes ? row.changes : row.data;\n  };\n  BatchEdit.prototype.keyDownHandler = function (e) {\n    if ((e.action === 'tab' || e.action === 'shiftTab') && this.parent.isEdit) {\n      var gObj = this.parent;\n      var btmIdx = this.getBottomIndex();\n      var rowcell = parentsUntil(e.target, literals.rowCell);\n      if (rowcell) {\n        var cell = rowcell.querySelector('.e-field');\n        if (cell) {\n          var visibleColumns = this.parent.getVisibleColumns();\n          var columnIndex = e.action === 'tab' ? visibleColumns.length - 1 : 0;\n          if (visibleColumns[columnIndex].field === cell.getAttribute('id').slice(this.parent.element.id.length)) {\n            if (this.cellDetails.rowIndex === btmIdx && e.action === 'tab') {\n              if (gObj.editSettings.newRowPosition === 'Top') {\n                gObj.editSettings.newRowPosition = 'Bottom';\n                this.addRecord();\n                gObj.editSettings.newRowPosition = 'Top';\n              } else {\n                this.addRecord();\n              }\n            } else {\n              this.saveCell();\n            }\n          }\n        }\n      }\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  BatchEdit.prototype.addCancelWhilePaging = function () {\n    if (this.validateFormObj()) {\n      this.parent.notify(events.destroyForm, {});\n      this.parent.isEdit = false;\n      this.isColored = false;\n    }\n  };\n  BatchEdit.prototype.getBottomIndex = function () {\n    var changes = this.getBatchChanges();\n    return this.parent.getCurrentViewRecords().length + changes[literals.addedRecords].length - changes[literals.deletedRecords].length - 1;\n  };\n  return BatchEdit;\n}();\nexport { BatchEdit };","map":{"version":3,"names":["extend","addClass","removeClass","setValue","closest","select","remove","classList","isNullOrUndefined","isUndefined","CellType","parentsUntil","inArray","refreshForeignData","getObject","alignFrozenEditForm","gridActionHandler","addRemoveEventListener","splitFrozenRowObjectCells","getGridRowElements","sliceElements","getCellByColAndRowIndex","getMovableTbody","getFrozenRightTbody","getGridRowObjects","events","RowRenderer","CellRenderer","Row","Cell","RowModelGenerator","DataUtil","literals","BatchEdit","parent","serviceLocator","renderer","cellDetails","originalCell","cloneCell","editNext","preventSaveCell","focus","getService","addEventListener","prototype","isDestroyed","evtHandlers","event","click","handler","clickHandler","dblclick","dblClickHandler","beforeCellFocused","onBeforeCellFocused","cellFocused","onCellFocused","doubleTap","keyPressed","keyDownHandler","editNextValCell","closeBatch","closeForm","destroy","dataBoundFunction","dataBound","bind","batchCancelFunction","batchCancel","removeEventListener","focusModule","restoreFocus","notify","toolbarRefresh","e","target","element","id","isEdit","form","saveCell","rowCell","setCellIdx","tr","row","rowIndex","parseInt","getAttribute","ariaRowIndex","colIndex","ariaColIndex","isNaN","parentElement","contains","editedRow","editCell","getColumns","field","isAddRow","validateFormObj","byClick","indexOf","keyArgs","action","cancel","clickArgs","preventDefault","frzCols","getFrozenLeftCount","frzRightCols","getFrozenRightColumnsCount","mCont","getContent","querySelector","movableContent","mHdr","getHeaderContent","movableHeader","clear","container","isContent","isDataCell","frozenRows","isHeader","byKey","_a","indexes","cellIndex","frHdr","frCont","getMovableColumnsCount","getElementsByClassName","length","col","isLastCellPrimaryKey","editCellFromIndex","args","column","index","getDataRows","rowIdx","cellIdx","closeEdit","_this","gObj","rows","getRowsObject","argument","batchChanges","getBatchChanges","beforeBatchCancel","isAdded","clearSelection","allRows","_loop_1","i","isInsert","isDirty","this_1","tableName","removeBatchElementChanges","splice","out_i_1","getContentTable","renderModule","renderEmptyRow","requestType","isDataRow","cells","visible","selectRow","refreshRowIdx","tooltipDestroy","trigger","rowRenderer","isInstertedRemoved","getRowElementByUID","uid","getForeignKeyColumns","data","changes","edit","refresh","aggregates","type","editType","refreshFooterRenderer","groupSettings","columns","groupAggregates","removeHideAndSelection","removeAttribute","tdElements","slice","call","deleteRecord","fieldname","bulkDelete","addRecord","bulkAddRow","endEdit","batchSave","Object","keys","j","replaceWith","editModule","formObj","validate","deletedRecords","isCheckBoxSelection","checkAllBox","pageSettings","totalRecordsCount","currentViewData","selectionSettings","persistSelection","removeSelectedData","original","changedRecords","filter","map","beforeBatchSave","beforeBatchSaveArgs","showSpinner","bulkSave","addedRecords","_i","rows_1","push","removeRowObjectFromUID","len","addRowObject","isTop","editSettings","newRowPosition","rowClone","clone","unshift","selectedRowIndex","selectedRows","getSelectedRows","primaryKey","getPrimaryKeyFieldNames","rowData","getSelectedRecords","deleteRowUid","getRows","getCurrentViewRecords","beforeBatchDelete","beforeBatchDeleteArgs","isFrozenGrid","getRowByIndex","getMovableRowByIndex","getFrozenMode","leftRight","getFrozenRightRowByIndex","rowObj","getRowObjectFromUID","getMovableDataRows","getMovableHeaderTbody","appendChild","getFrozenHeaderTbody","getFrozenRightHeaderTbody","getHeaderTable","tbody","uniqueid","selectedRow","undefined","batchDelete","getAllDataRows","dataRows","dataObjects","_loop_2","this_2","rowElements","rowObjects","setAttribute","toString","out_j_1","getIndexFromData","allowAdding","add","defaultData","getDefaultData","beforeBatchAdd","beforeBatchAddArgs","mTr","frTr","model","modelData","generateRows","render","insertBefore","createElement","className","firstChild","cellType","Indent","emptyRow","parentNode","removeChild","removeFrozenTbody","cloneNode","renderMovable","renderFrozenAddRow","forgetPrevious","batchAdd","isFrozen","btmIdx","getBottomIndex","findNextEditableCell","args1","columnObject","columnIndex","cell","mTbody","frTbody","height","frozenHeight","moveTbody","firstElementChild","ele","rightEle","mEle","movable","left","right","children","isAdd","isValOnly","cols","endIndex","validation","validationRules","checkNPCell","template","allowEditing","isIdentity","isPrimaryKey","dValues","columnModel","defaultValue","gLen","allowGrouping","getColumnByField","checkEdit","editCellExtend","mRowData","getDataByIndex","getFreezeTableName","frozenRight","getFrozenRightDataRows","apply","columnName","isForeignKey","foreignKeyValue","value","foreignKeyData","getColIndex","getCellIdx","cellEdit","cellEditArgs","isColored","isPersistSelection","update","batchEditFormRendered","applyFormValidation","style","display","updateCell","getColumnIndexByField","td","getMovableRowsObject","getFrozenRightRowsObject","refreshTD","queryCellInfo","newReactTd","setChanges","currentRowObj","Date","rowEle","movableRowObject","frRowObject","updateRow","keys_1","cIdx","getColumnIndexByUid","detailTemplate","childGrid","isRowDragable","rowcell","parseFloat","getFrozenColumns","getFrozenLeftColumnsCount","isReact","m","nextCellIndex","escapeCellEdit","generateCellArgs","previousValue","successCallBack","obj","editedData","getCurrentEditedData","cloneEditedData","isForceSave","cellSave","batchForm","cellSaveArgs","isEscapeCellEdit","destroyWidgets","destroyForm","cellSaved","visibleColumns","getVisibleColumns","addCancelWhilePaging"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/actions/batch-edit.js"],"sourcesContent":["import { extend, addClass, removeClass, setValue, closest, select } from '@syncfusion/ej2-base';\nimport { remove, classList } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, isUndefined } from '@syncfusion/ej2-base';\nimport { CellType } from '../base/enum';\nimport { parentsUntil, inArray, refreshForeignData, getObject, alignFrozenEditForm, gridActionHandler, addRemoveEventListener } from '../base/util';\nimport { splitFrozenRowObjectCells, getGridRowElements } from '../base/util';\nimport { sliceElements, getCellByColAndRowIndex, getMovableTbody, getFrozenRightTbody } from '../base/util';\nimport { getGridRowObjects } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport { RowModelGenerator } from '../services/row-model-generator';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport * as literals from '../base/string-literals';\n/**\n * `BatchEdit` module is used to handle batch editing actions.\n *\n * @hidden\n */\nvar BatchEdit = /** @class */ (function () {\n    function BatchEdit(parent, serviceLocator, renderer) {\n        this.cellDetails = {};\n        this.originalCell = {};\n        this.cloneCell = {};\n        this.editNext = false;\n        this.preventSaveCell = false;\n        this.parent = parent;\n        this.serviceLocator = serviceLocator;\n        this.renderer = renderer;\n        this.focus = serviceLocator.getService('focus');\n        this.addEventListener();\n    }\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: events.click, handler: this.clickHandler },\n            { event: events.dblclick, handler: this.dblClickHandler },\n            { event: events.beforeCellFocused, handler: this.onBeforeCellFocused },\n            { event: events.cellFocused, handler: this.onCellFocused },\n            { event: events.doubleTap, handler: this.dblClickHandler },\n            { event: events.keyPressed, handler: this.keyDownHandler },\n            { event: events.editNextValCell, handler: this.editNextValCell },\n            { event: events.closeBatch, handler: this.closeForm },\n            { event: events.destroy, handler: this.destroy }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n        this.dataBoundFunction = this.dataBound.bind(this);\n        this.batchCancelFunction = this.batchCancel.bind(this);\n        this.parent.addEventListener(events.dataBound, this.dataBoundFunction);\n        this.parent.addEventListener(events.batchCancel, this.batchCancelFunction);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n        this.parent.removeEventListener(events.dataBound, this.dataBoundFunction);\n        this.parent.removeEventListener(events.batchCancel, this.batchCancelFunction);\n    };\n    BatchEdit.prototype.batchCancel = function () {\n        this.parent.focusModule.restoreFocus();\n    };\n    BatchEdit.prototype.dataBound = function () {\n        this.parent.notify(events.toolbarRefresh, {});\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.destroy = function () {\n        this.removeEventListener();\n    };\n    BatchEdit.prototype.clickHandler = function (e) {\n        if (!parentsUntil(e.target, this.parent.element.id + '_add', true)) {\n            if (this.parent.isEdit && closest(this.form, 'td') !== closest(e.target, 'td')) {\n                this.saveCell();\n                this.editNextValCell();\n            }\n            if (parentsUntil(e.target, literals.rowCell) && !this.parent.isEdit) {\n                this.setCellIdx(e.target);\n            }\n        }\n    };\n    BatchEdit.prototype.dblClickHandler = function (e) {\n        var target = parentsUntil(e.target, literals.rowCell);\n        var tr = parentsUntil(e.target, literals.row);\n        var rowIndex = tr && parseInt(tr.getAttribute(literals.ariaRowIndex), 10);\n        var colIndex = target && parseInt(target.getAttribute(literals.ariaColIndex), 10);\n        if (!isNullOrUndefined(target) && !isNullOrUndefined(rowIndex) && !isNaN(colIndex)\n            && !target.parentElement.classList.contains(literals.editedRow)) {\n            this.editCell(rowIndex, this.parent.getColumns()[colIndex].field, this.isAddRow(rowIndex));\n        }\n    };\n    BatchEdit.prototype.onBeforeCellFocused = function (e) {\n        if (this.parent.isEdit && this.validateFormObj() &&\n            (e.byClick || (['tab', 'shiftTab', 'enter', 'shiftEnter'].indexOf(e.keyArgs.action) > -1))) {\n            e.cancel = true;\n            if (e.byClick) {\n                e.clickArgs.preventDefault();\n            }\n            else {\n                e.keyArgs.preventDefault();\n            }\n        }\n    };\n    BatchEdit.prototype.onCellFocused = function (e) {\n        var frzCols = this.parent.getFrozenLeftCount();\n        var frzRightCols = this.parent.getFrozenRightColumnsCount();\n        var mCont = this.parent.getContent().querySelector('.' + literals.movableContent);\n        var mHdr = this.parent.getHeaderContent().querySelector('.' + literals.movableHeader);\n        var clear = (!e.container.isContent || !e.container.isDataCell) && !(this.parent.frozenRows && e.container.isHeader);\n        if (!e.byKey || clear) {\n            if (this.parent.isEdit && clear) {\n                this.saveCell();\n            }\n            return;\n        }\n        var _a = e.container.indexes, rowIndex = _a[0], cellIndex = _a[1];\n        if (frzCols && (mCont.contains(e.element) || (this.parent.frozenRows && mHdr.contains(e.element)))) {\n            cellIndex += frzCols;\n        }\n        if (frzRightCols) {\n            var frHdr = this.parent.getHeaderContent().querySelector('.e-frozen-right-header');\n            var frCont = this.parent.getContent().querySelector('.e-frozen-right-content');\n            if (frCont.contains(e.element) || (this.parent.frozenRows && frHdr.contains(e.element))) {\n                cellIndex += (frzCols + this.parent.getMovableColumnsCount());\n            }\n        }\n        if (this.parent.frozenRows && e.container.isContent) {\n            rowIndex += this.parent.frozenRows;\n        }\n        var isEdit = this.parent.isEdit;\n        if (!this.parent.element.getElementsByClassName('e-popup-open').length) {\n            isEdit = isEdit && !this.validateFormObj();\n            switch (e.keyArgs.action) {\n                case 'tab':\n                case 'shiftTab':\n                    // eslint-disable-next-line no-case-declarations\n                    var col = this.parent.getColumns()[e.indexes[1]];\n                    if (col && !this.parent.isEdit) {\n                        this.editCell(e.indexes[0], col.field);\n                    }\n                    if (isEdit || this.parent.isLastCellPrimaryKey) {\n                        this.editCellFromIndex(rowIndex, cellIndex);\n                    }\n                    break;\n                case 'enter':\n                case 'shiftEnter':\n                    e.keyArgs.preventDefault();\n                    // eslint-disable-next-line no-case-declarations\n                    var args = { cancel: false, keyArgs: e.keyArgs };\n                    this.parent.notify('beforeFocusCellEdit', args);\n                    if (!args.cancel && isEdit) {\n                        this.editCell(rowIndex, this.cellDetails.column.field);\n                    }\n                    break;\n                case 'f2':\n                    this.editCellFromIndex(rowIndex, cellIndex);\n                    this.focus.focus();\n                    break;\n            }\n        }\n    };\n    BatchEdit.prototype.isAddRow = function (index) {\n        return this.parent.getDataRows()[index].classList.contains('e-insertedrow');\n    };\n    BatchEdit.prototype.editCellFromIndex = function (rowIdx, cellIdx) {\n        this.cellDetails.rowIndex = rowIdx;\n        this.cellDetails.cellIndex = cellIdx;\n        this.editCell(rowIdx, this.parent.getColumns()[cellIdx].field, this.isAddRow(rowIdx));\n    };\n    BatchEdit.prototype.closeEdit = function () {\n        var _this = this;\n        var gObj = this.parent;\n        var rows = this.parent.getRowsObject();\n        var argument = { cancel: false, batchChanges: this.getBatchChanges() };\n        gObj.notify(events.beforeBatchCancel, argument);\n        if (argument.cancel) {\n            return;\n        }\n        if (gObj.isEdit) {\n            this.saveCell(true);\n        }\n        this.isAdded = false;\n        gObj.clearSelection();\n        var allRows = getGridRowObjects(this.parent);\n        var _loop_1 = function (i) {\n            var isInsert = false;\n            var isDirty = rows[i].isDirty;\n            gridActionHandler(this_1.parent, function (tableName, rows) {\n                isInsert = _this.removeBatchElementChanges(rows[i], isDirty);\n                if (isInsert) {\n                    rows.splice(i, 1);\n                }\n            }, allRows);\n            if (isInsert) {\n                i--;\n            }\n            out_i_1 = i;\n        };\n        var this_1 = this, out_i_1;\n        for (var i = 0; i < rows.length; i++) {\n            _loop_1(i);\n            i = out_i_1;\n        }\n        if (!gObj.getContentTable().querySelector('tr.e-row')) {\n            gObj.renderModule.renderEmptyRow();\n        }\n        var args = {\n            requestType: 'batchCancel', rows: this.parent.getRowsObject()\n        };\n        gObj.notify(events.batchCancel, {\n            rows: this.parent.getRowsObject().length ? this.parent.getRowsObject() :\n                [new Row({ isDataRow: true, cells: [new Cell({ isDataCell: true, visible: true })] })]\n        });\n        gObj.selectRow(this.cellDetails.rowIndex);\n        this.refreshRowIdx();\n        gObj.notify(events.toolbarRefresh, {});\n        this.parent.notify(events.tooltipDestroy, {});\n        args = { requestType: 'batchCancel', rows: this.parent.getRowsObject() };\n        gObj.trigger(events.batchCancel, args);\n    };\n    BatchEdit.prototype.removeBatchElementChanges = function (row, isDirty) {\n        var gObj = this.parent;\n        var rowRenderer = new RowRenderer(this.serviceLocator, null, this.parent);\n        var isInstertedRemoved = false;\n        if (isDirty) {\n            row.isDirty = isDirty;\n            var tr = gObj.getRowElementByUID(row.uid);\n            if (tr) {\n                if (tr.classList.contains('e-insertedrow')) {\n                    remove(tr);\n                    isInstertedRemoved = true;\n                }\n                else {\n                    refreshForeignData(row, this.parent.getForeignKeyColumns(), row.data);\n                    delete row.changes;\n                    delete row.edit;\n                    row.isDirty = false;\n                    classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n                    rowRenderer.refresh(row, gObj.getColumns(), false);\n                }\n                if (this.parent.aggregates.length > 0) {\n                    var type = 'type';\n                    var editType = [];\n                    editType[type] = 'cancel';\n                    this.parent.notify(events.refreshFooterRenderer, editType);\n                    if (this.parent.groupSettings.columns.length > 0) {\n                        this.parent.notify(events.groupAggregates, editType);\n                    }\n                }\n            }\n        }\n        return isInstertedRemoved;\n    };\n    BatchEdit.prototype.removeHideAndSelection = function (tr) {\n        if (tr.classList.contains('e-hiddenrow')) {\n            tr.removeAttribute('aria-selected');\n            var tdElements = [].slice.call(tr.getElementsByClassName('e-selectionbackground'));\n            for (var i = 0; i < tdElements.length; i++) {\n                removeClass([tdElements[i]], ['e-selectionbackground', 'e-active']);\n            }\n        }\n        classList(tr, [], ['e-hiddenrow', 'e-updatedtd']);\n    };\n    BatchEdit.prototype.deleteRecord = function (fieldname, data) {\n        this.saveCell();\n        if (this.validateFormObj()) {\n            this.saveCell(true);\n        }\n        this.isAdded = false;\n        this.bulkDelete(fieldname, data);\n        if (this.parent.aggregates.length > 0) {\n            this.parent.notify(events.refreshFooterRenderer, {});\n            if (this.parent.groupSettings.columns.length > 0) {\n                this.parent.notify(events.groupAggregates, {});\n            }\n        }\n    };\n    BatchEdit.prototype.addRecord = function (data) {\n        this.bulkAddRow(data);\n    };\n    BatchEdit.prototype.endEdit = function () {\n        if (this.parent.isEdit && this.validateFormObj()) {\n            return;\n        }\n        this.batchSave();\n    };\n    BatchEdit.prototype.closeForm = function () {\n        for (var i = 0; i < Object.keys(this.originalCell).length; i++) {\n            for (var j = 0; j < Object.keys(this.cloneCell).length; j++) {\n                if (Object.keys(this.originalCell)[i] === Object.keys(this.cloneCell)[j]) {\n                    this.cloneCell[Object.keys(this.cloneCell)[j]].replaceWith(this.originalCell[Object.keys(this.originalCell)[i]]);\n                    if (this.originalCell[Object.keys(this.originalCell)[i]].classList.contains('e-selectionbackground')) {\n                        this.originalCell[Object.keys(this.originalCell)[i]]\n                            .classList.remove('e-selectionbackground', 'e-cellselectionbackground', 'e-active');\n                    }\n                }\n            }\n        }\n        this.cloneCell = {};\n        this.originalCell = {};\n    };\n    BatchEdit.prototype.validateFormObj = function () {\n        return this.parent.editModule.formObj && !this.parent.editModule.formObj.validate();\n    };\n    BatchEdit.prototype.batchSave = function () {\n        var gObj = this.parent;\n        var deletedRecords = 'deletedRecords';\n        if (gObj.isCheckBoxSelection) {\n            var checkAllBox = gObj.element.querySelector('.e-checkselectall').parentElement;\n            if (checkAllBox.classList.contains('e-checkbox-disabled') &&\n                gObj.pageSettings.totalRecordsCount > gObj.currentViewData.length) {\n                removeClass([checkAllBox], ['e-checkbox-disabled']);\n            }\n        }\n        this.saveCell();\n        if (gObj.isEdit || this.editNextValCell() || gObj.isEdit) {\n            return;\n        }\n        var changes = this.getBatchChanges();\n        if (this.parent.selectionSettings.type === 'Multiple' && changes[deletedRecords].length &&\n            this.parent.selectionSettings.persistSelection) {\n            changes[deletedRecords] = this.removeSelectedData;\n            this.removeSelectedData = [];\n        }\n        var original = {\n            changedRecords: this.parent.getRowsObject()\n                .filter(function (row) { return row.isDirty && ['add', 'delete'].indexOf(row.edit) === -1; })\n                .map(function (row) { return row.data; })\n        };\n        var args = { batchChanges: changes, cancel: false };\n        gObj.trigger(events.beforeBatchSave, args, function (beforeBatchSaveArgs) {\n            if (beforeBatchSaveArgs.cancel) {\n                return;\n            }\n            gObj.showSpinner();\n            gObj.notify(events.bulkSave, { changes: changes, original: original });\n        });\n    };\n    BatchEdit.prototype.getBatchChanges = function () {\n        var changes = {\n            addedRecords: [],\n            deletedRecords: [],\n            changedRecords: []\n        };\n        var rows = this.parent.getRowsObject();\n        for (var _i = 0, rows_1 = rows; _i < rows_1.length; _i++) {\n            var row = rows_1[_i];\n            if (row.isDirty) {\n                switch (row.edit) {\n                    case 'add':\n                        changes.addedRecords.push(row.changes);\n                        break;\n                    case 'delete':\n                        changes.deletedRecords.push(row.data);\n                        break;\n                    default:\n                        changes.changedRecords.push(row.changes);\n                }\n            }\n        }\n        return changes;\n    };\n    /**\n     * @param {string} uid - specifes the uid\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.removeRowObjectFromUID = function (uid) {\n        var rows = this.parent.getRowsObject();\n        var i = 0;\n        for (var len = rows.length; i < len; i++) {\n            if (rows[i].uid === uid) {\n                break;\n            }\n        }\n        gridActionHandler(this.parent, function (tableName, rows) {\n            rows.splice(i, 1);\n        }, getGridRowObjects(this.parent));\n    };\n    /**\n     * @param {Row<Column>} row - specifies the row object\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addRowObject = function (row) {\n        var gObj = this.parent;\n        var isTop = gObj.editSettings.newRowPosition === 'Top';\n        gridActionHandler(this.parent, function (tableName, rows) {\n            var rowClone = row.clone();\n            rowClone.cells = splitFrozenRowObjectCells(gObj, rowClone.cells, tableName);\n            if (isTop) {\n                rows.unshift(rowClone);\n            }\n            else {\n                rows.push(rowClone);\n            }\n        }, getGridRowObjects(this.parent), true);\n    };\n    // tslint:disable-next-line:max-func-body-length\n    BatchEdit.prototype.bulkDelete = function (fieldname, data) {\n        var _this = this;\n        this.removeSelectedData = [];\n        var gObj = this.parent;\n        var index = gObj.selectedRowIndex;\n        var selectedRows = gObj.getSelectedRows();\n        var args = {\n            primaryKey: this.parent.getPrimaryKeyFieldNames(),\n            rowIndex: index,\n            rowData: data ? data : gObj.getSelectedRecords()[0],\n            cancel: false\n        };\n        if (data) {\n            args.row = gObj.editModule.deleteRowUid ? gObj.getRowElementByUID(gObj.editModule.deleteRowUid)\n                : gObj.getRows()[gObj.getCurrentViewRecords().indexOf(data)];\n        }\n        else {\n            args.row = data ? gObj.getRows()[index] : selectedRows[0];\n        }\n        if (!args.row) {\n            return;\n        }\n        // tslint:disable-next-line:max-func-body-length\n        gObj.trigger(events.beforeBatchDelete, args, function (beforeBatchDeleteArgs) {\n            if (beforeBatchDeleteArgs.cancel) {\n                return;\n            }\n            _this.removeSelectedData = gObj.getSelectedRecords();\n            gObj.clearSelection();\n            beforeBatchDeleteArgs.row = beforeBatchDeleteArgs.row ?\n                beforeBatchDeleteArgs.row : data ? gObj.getRows()[index] : selectedRows[0];\n            if (_this.parent.isFrozenGrid()) {\n                if (data) {\n                    index = parseInt(beforeBatchDeleteArgs.row.getAttribute(literals.ariaRowIndex), 10);\n                    selectedRows = [];\n                    selectedRows.push(gObj.getRowByIndex(index));\n                    selectedRows.push(gObj.getMovableRowByIndex(index));\n                    if (gObj.getFrozenMode() === literals.leftRight) {\n                        selectedRows.push(gObj.getFrozenRightRowByIndex(index));\n                    }\n                }\n                for (var i = 0; i < selectedRows.length; i++) {\n                    var uid = selectedRows[i].getAttribute('data-uid');\n                    if (selectedRows[i].classList.contains('e-insertedrow')) {\n                        _this.removeRowObjectFromUID(uid);\n                        remove(selectedRows[i]);\n                    }\n                    else {\n                        var rowObj = gObj.getRowObjectFromUID(uid);\n                        rowObj.isDirty = true;\n                        rowObj.edit = 'delete';\n                        classList(selectedRows[i], ['e-hiddenrow', 'e-updatedtd'], []);\n                        if (gObj.frozenRows && index < gObj.frozenRows && gObj.getMovableDataRows().length >= gObj.frozenRows) {\n                            gObj.getMovableHeaderTbody().appendChild(gObj.getMovableRowByIndex(gObj.frozenRows - 1));\n                            gObj.getFrozenHeaderTbody().appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n                            if (gObj.getFrozenMode() === literals.leftRight) {\n                                gObj.getFrozenRightHeaderTbody().appendChild(gObj.getFrozenRightRowByIndex(gObj.frozenRows - 1));\n                            }\n                        }\n                        if (gObj.frozenRows && index < gObj.frozenRows && gObj.getDataRows().length >= gObj.frozenRows) {\n                            gObj.getHeaderTable().querySelector(literals.tbody).appendChild(gObj.getRowByIndex(gObj.frozenRows - 1));\n                        }\n                    }\n                    delete selectedRows[i];\n                }\n            }\n            else if (!_this.parent.isFrozenGrid() && (selectedRows.length === 1 || data)) {\n                var uid = beforeBatchDeleteArgs.row.getAttribute('data-uid');\n                uid = data && _this.parent.editModule.deleteRowUid ? uid = _this.parent.editModule.deleteRowUid : uid;\n                if (beforeBatchDeleteArgs.row.classList.contains('e-insertedrow')) {\n                    _this.removeRowObjectFromUID(uid);\n                    remove(beforeBatchDeleteArgs.row);\n                }\n                else {\n                    var rowObj = gObj.getRowObjectFromUID(uid);\n                    rowObj.isDirty = true;\n                    rowObj.edit = 'delete';\n                    classList(beforeBatchDeleteArgs.row, ['e-hiddenrow', 'e-updatedtd'], []);\n                }\n                delete beforeBatchDeleteArgs.row;\n            }\n            else {\n                for (var i = 0; i < selectedRows.length; i++) {\n                    var uniqueid = selectedRows[i].getAttribute('data-uid');\n                    if (selectedRows[i].classList.contains('e-insertedrow')) {\n                        _this.removeRowObjectFromUID(uniqueid);\n                        remove(selectedRows[i]);\n                    }\n                    else {\n                        classList(selectedRows[i], ['e-hiddenrow', 'e-updatedtd'], []);\n                        var selectedRow = gObj.getRowObjectFromUID(uniqueid);\n                        selectedRow.isDirty = true;\n                        selectedRow.edit = 'delete';\n                        delete selectedRows[i];\n                    }\n                }\n            }\n            _this.refreshRowIdx();\n            if (data) {\n                gObj.editModule.deleteRowUid = undefined;\n                if (gObj.getSelectedRows().length) {\n                    index = parseInt(gObj.getSelectedRows()[0].getAttribute(literals.ariaRowIndex), 10);\n                }\n            }\n            if (!gObj.isCheckBoxSelection) {\n                gObj.selectRow(index);\n            }\n            gObj.trigger(events.batchDelete, beforeBatchDeleteArgs);\n            gObj.notify(events.batchDelete, { rows: _this.parent.getRowsObject() });\n            gObj.notify(events.toolbarRefresh, {});\n        });\n    };\n    BatchEdit.prototype.refreshRowIdx = function () {\n        var gObj = this.parent;\n        var rows = gObj.getAllDataRows(true);\n        var dataRows = getGridRowElements(this.parent);\n        var dataObjects = getGridRowObjects(this.parent);\n        var _loop_2 = function (i, j, len) {\n            if (rows[i].classList.contains(literals.row) && !rows[i].classList.contains('e-hiddenrow')) {\n                gridActionHandler(this_2.parent, function (tableName, rowElements, rowObjects) {\n                    rowElements[i].setAttribute(literals.ariaRowIndex, j.toString());\n                    rowObjects[i].index = j;\n                }, dataRows, null, dataObjects);\n                j++;\n            }\n            else {\n                gridActionHandler(this_2.parent, function (tableName, rowElements, rowObjects) {\n                    rowElements[i].removeAttribute(literals.ariaRowIndex);\n                    rowObjects[i].index = -1;\n                }, dataRows, null, dataObjects);\n            }\n            out_j_1 = j;\n        };\n        var this_2 = this, out_j_1;\n        for (var i = 0, j = 0, len = rows.length; i < len; i++) {\n            _loop_2(i, j, len);\n            j = out_j_1;\n        }\n    };\n    BatchEdit.prototype.getIndexFromData = function (data) {\n        return inArray(data, this.parent.getCurrentViewRecords());\n    };\n    BatchEdit.prototype.bulkAddRow = function (data) {\n        var _this = this;\n        var gObj = this.parent;\n        if (!gObj.editSettings.allowAdding) {\n            return;\n        }\n        if (gObj.isEdit) {\n            this.saveCell();\n            this.parent.notify(events.editNextValCell, {});\n        }\n        if (gObj.isEdit) {\n            return;\n        }\n        this.parent.element.classList.add('e-editing');\n        var defaultData = data ? data : this.getDefaultData();\n        var args = {\n            defaultData: defaultData,\n            primaryKey: gObj.getPrimaryKeyFieldNames(),\n            cancel: false\n        };\n        gObj.trigger(events.beforeBatchAdd, args, function (beforeBatchAddArgs) {\n            if (beforeBatchAddArgs.cancel) {\n                return;\n            }\n            _this.isAdded = true;\n            gObj.clearSelection();\n            var mTr;\n            var frTr;\n            var row = new RowRenderer(_this.serviceLocator, null, _this.parent);\n            var model = new RowModelGenerator(_this.parent);\n            var modelData = model.generateRows([beforeBatchAddArgs.defaultData]);\n            var tr = row.render(modelData[0], gObj.getColumns());\n            var col;\n            var index;\n            for (var i = 0; i < _this.parent.groupSettings.columns.length; i++) {\n                tr.insertBefore(_this.parent.createElement('td', { className: 'e-indentcell' }), tr.firstChild);\n                modelData[0].cells.unshift(new Cell({ cellType: CellType.Indent }));\n            }\n            var tbody = gObj.getContentTable().querySelector(literals.tbody);\n            tr.classList.add('e-insertedrow');\n            if (tbody.querySelector('.e-emptyrow')) {\n                var emptyRow = tbody.querySelector('.e-emptyrow');\n                emptyRow.parentNode.removeChild(emptyRow);\n                _this.removeFrozenTbody();\n            }\n            if (gObj.isFrozenGrid()) {\n                frTr = tr.cloneNode(true);\n                mTr = _this.renderMovable(tr, frTr);\n                tr = gObj.getFrozenMode() === 'Right' ? frTr : tr;\n                _this.renderFrozenAddRow(tr, mTr, frTr);\n            }\n            if (gObj.frozenRows && gObj.editSettings.newRowPosition === 'Top') {\n                tbody = gObj.getHeaderTable().querySelector(literals.tbody);\n            }\n            else {\n                tbody = gObj.getContentTable().querySelector(literals.tbody);\n            }\n            if (_this.parent.editSettings.newRowPosition === 'Top') {\n                tbody.insertBefore(tr, tbody.firstChild);\n            }\n            else {\n                tbody.appendChild(tr);\n            }\n            addClass([].slice.call(tr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n            modelData[0].isDirty = true;\n            modelData[0].changes = extend({}, {}, modelData[0].data, true);\n            modelData[0].edit = 'add';\n            _this.addRowObject(modelData[0]);\n            _this.refreshRowIdx();\n            _this.focus.forgetPrevious();\n            gObj.notify(events.batchAdd, { rows: _this.parent.getRowsObject(), args: { isFrozen: _this.parent.isFrozenGrid() } });\n            var changes = _this.getBatchChanges();\n            var btmIdx = _this.getBottomIndex();\n            if (_this.parent.editSettings.newRowPosition === 'Top') {\n                gObj.selectRow(0);\n            }\n            else {\n                gObj.selectRow(btmIdx);\n            }\n            if (!data) {\n                index = _this.findNextEditableCell(0, true);\n                col = gObj.getColumns()[index];\n                if (_this.parent.editSettings.newRowPosition === 'Top') {\n                    _this.editCell(0, col.field, true);\n                }\n                else {\n                    _this.editCell(btmIdx, col.field, true);\n                }\n            }\n            if (_this.parent.aggregates.length > 0 && (data || changes[literals.addedRecords].length)) {\n                _this.parent.notify(events.refreshFooterRenderer, {});\n            }\n            var args1 = {\n                defaultData: beforeBatchAddArgs.defaultData, row: tr,\n                columnObject: col, columnIndex: index, primaryKey: beforeBatchAddArgs.primaryKey, cell: tr.cells[index]\n            };\n            gObj.trigger(events.batchAdd, args1);\n            if (gObj.isFrozenGrid()) {\n                alignFrozenEditForm(mTr.querySelector('td:not(.e-hide)'), tr.querySelector('td:not(.e-hide)'));\n            }\n        });\n    };\n    BatchEdit.prototype.renderFrozenAddRow = function (tr, mTr, frTr) {\n        var gObj = this.parent;\n        var mTbody = getMovableTbody(this.parent);\n        var frTbody = getFrozenRightTbody(this.parent);\n        if (gObj.editSettings.newRowPosition === 'Top') {\n            mTbody.insertBefore(mTr, mTbody.firstChild);\n        }\n        else {\n            mTbody.appendChild(mTr);\n        }\n        addClass([].slice.call(mTr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n        if (frTbody && frTr) {\n            if (gObj.editSettings.newRowPosition === 'Top') {\n                frTbody.insertBefore(frTr, frTbody.firstChild);\n            }\n            else {\n                frTbody.appendChild(frTr);\n            }\n            addClass([].slice.call(frTr.getElementsByClassName(literals.rowCell)), ['e-updatedtd']);\n            alignFrozenEditForm(frTr.querySelector('td:not(.e-hide)'), tr.querySelector('td:not(.e-hide)'));\n        }\n        if (gObj.height === 'auto') {\n            gObj.notify(events.frozenHeight, {});\n        }\n    };\n    BatchEdit.prototype.removeFrozenTbody = function () {\n        var gObj = this.parent;\n        if (gObj.isFrozenGrid()) {\n            var moveTbody = gObj.getContent().querySelector('.' + literals.movableContent).querySelector(literals.tbody);\n            (moveTbody.firstElementChild).parentNode.removeChild(moveTbody.firstElementChild);\n            if (gObj.getFrozenMode() === literals.leftRight) {\n                var frTbody = gObj.getContent().querySelector('.e-frozen-right-content').querySelector(literals.tbody);\n                (frTbody.firstElementChild).parentNode.removeChild(frTbody.firstElementChild);\n            }\n        }\n    };\n    BatchEdit.prototype.renderMovable = function (ele, rightEle) {\n        var mEle = ele.cloneNode(true);\n        var movable = this.parent.getMovableColumnsCount();\n        var left = this.parent.getFrozenLeftCount();\n        var right = this.parent.getFrozenRightColumnsCount();\n        sliceElements(ele, 0, left);\n        sliceElements(mEle, left, right ? mEle.children.length - right : mEle.children.length);\n        sliceElements(rightEle, left + movable, rightEle.children.length);\n        return mEle;\n    };\n    BatchEdit.prototype.findNextEditableCell = function (columnIndex, isAdd, isValOnly) {\n        var cols = this.parent.getColumns();\n        var endIndex = cols.length;\n        var validation;\n        for (var i = columnIndex; i < endIndex; i++) {\n            validation = isValOnly ? isNullOrUndefined(cols[i].validationRules) : false;\n            if (!isAdd && this.checkNPCell(cols[i])) {\n                return i;\n            }\n            else if (isAdd && !cols[i].template && cols[i].visible && cols[i].allowEditing &&\n                !(cols[i].isIdentity && cols[i].isPrimaryKey) && !validation) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    BatchEdit.prototype.checkNPCell = function (col) {\n        return !col.template && col.visible && !col.isPrimaryKey && !col.isIdentity && col.allowEditing;\n    };\n    BatchEdit.prototype.getDefaultData = function () {\n        var gObj = this.parent;\n        var data = {};\n        var dValues = { 'number': 0, 'string': null, 'boolean': false, 'date': null, 'datetime': null };\n        for (var _i = 0, _a = (gObj.columnModel); _i < _a.length; _i++) {\n            var col = _a[_i];\n            if (col.field) {\n                setValue(col.field, Object.keys(col).indexOf('defaultValue') >= 0 ? col.defaultValue : dValues[col.type], data);\n            }\n        }\n        return data;\n    };\n    BatchEdit.prototype.setCellIdx = function (target) {\n        var gLen = 0;\n        if (this.parent.allowGrouping) {\n            gLen = this.parent.groupSettings.columns.length;\n        }\n        this.cellDetails.cellIndex = target.cellIndex - gLen;\n        this.cellDetails.rowIndex = parseInt(target.getAttribute('index'), 10);\n    };\n    BatchEdit.prototype.editCell = function (index, field, isAdd) {\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        this.index = index;\n        this.field = field;\n        this.isAdd = isAdd;\n        var checkEdit = gObj.isEdit && !(this.cellDetails.column.field === field\n            && (this.cellDetails.rowIndex === index && this.parent.getDataRows().length - 1 !== index));\n        if (gObj.editSettings.allowEditing) {\n            if (!checkEdit && col.allowEditing) {\n                this.editCellExtend(index, field, isAdd);\n            }\n            else if (checkEdit) {\n                this.editNext = true;\n                this.saveCell();\n            }\n        }\n    };\n    BatchEdit.prototype.editCellExtend = function (index, field, isAdd) {\n        var _this = this;\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        var keys = gObj.getPrimaryKeyFieldNames();\n        if (gObj.isEdit) {\n            return;\n        }\n        var row;\n        var mRowData;\n        var rowData = extend({}, {}, this.getDataByIndex(index), true);\n        if (col.getFreezeTableName() === 'movable' || col.getFreezeTableName() === literals.frozenRight) {\n            row = col.getFreezeTableName() === 'movable' ? gObj.getMovableDataRows()[index] : gObj.getFrozenRightDataRows()[index];\n            mRowData = this.parent.getRowObjectFromUID(row.getAttribute('data-uid'));\n            rowData = mRowData.changes ? extend({}, {}, mRowData.changes, true) : rowData;\n        }\n        else {\n            row = gObj.getDataRows()[index];\n            rowData = extend({}, {}, this.getDataByIndex(index), true);\n        }\n        if ((keys[0] === col.field && !row.classList.contains('e-insertedrow')) || col.columns ||\n            (col.isPrimaryKey && col.isIdentity)) {\n            this.parent.isLastCellPrimaryKey = true;\n            return;\n        }\n        this.parent.isLastCellPrimaryKey = false;\n        this.parent.element.classList.add('e-editing');\n        var rowObj = gObj.getRowObjectFromUID(row.getAttribute('data-uid'));\n        var cells = [].slice.apply(row.cells);\n        var args = {\n            columnName: col.field, isForeignKey: !isNullOrUndefined(col.foreignKeyValue),\n            primaryKey: keys, rowData: rowData,\n            validationRules: extend({}, col.validationRules ? col.validationRules : {}),\n            value: getObject(col.field, rowData),\n            type: !isAdd ? 'edit' : 'add', cancel: false,\n            foreignKeyData: rowObj && rowObj.foreignKeyData\n        };\n        args.cell = cells[this.getColIndex(cells, this.getCellIdx(col.uid))];\n        args.row = row;\n        args.columnObject = col;\n        if (!args.cell) {\n            return;\n        }\n        gObj.trigger(events.cellEdit, args, function (cellEditArgs) {\n            if (cellEditArgs.cancel) {\n                return;\n            }\n            cellEditArgs.cell = cellEditArgs.cell ? cellEditArgs.cell : cells[_this.getColIndex(cells, _this.getCellIdx(col.uid))];\n            cellEditArgs.row = cellEditArgs.row ? cellEditArgs.row : row;\n            cellEditArgs.columnObject = cellEditArgs.columnObject ? cellEditArgs.columnObject : col;\n            cellEditArgs.columnObject.index = isNullOrUndefined(cellEditArgs.columnObject.index) ? 0 : cellEditArgs.columnObject.index;\n            _this.cellDetails = {\n                rowData: rowData, column: col, value: cellEditArgs.value, isForeignKey: cellEditArgs.isForeignKey, rowIndex: index,\n                cellIndex: parseInt(cellEditArgs.cell.getAttribute(literals.ariaColIndex), 10),\n                foreignKeyData: cellEditArgs.foreignKeyData\n            };\n            if (cellEditArgs.cell.classList.contains('e-updatedtd')) {\n                _this.isColored = true;\n                cellEditArgs.cell.classList.remove('e-updatedtd');\n            }\n            gObj.isEdit = true;\n            gObj.clearSelection();\n            if (!gObj.isCheckBoxSelection || !gObj.isPersistSelection) {\n                gObj.selectRow(_this.cellDetails.rowIndex, true);\n            }\n            _this.renderer.update(cellEditArgs);\n            _this.parent.notify(events.batchEditFormRendered, cellEditArgs);\n            _this.form = select('#' + gObj.element.id + 'EditForm', gObj.element);\n            gObj.editModule.applyFormValidation([col]);\n            _this.parent.element.querySelector('.e-gridpopup').style.display = 'none';\n        });\n    };\n    BatchEdit.prototype.updateCell = function (rowIndex, field, value) {\n        var gObj = this.parent;\n        var col = gObj.getColumnByField(field);\n        var index = gObj.getColumnIndexByField(field);\n        if (col && !col.isPrimaryKey && col.allowEditing) {\n            var td = getCellByColAndRowIndex(this.parent, col, rowIndex, index);\n            var rowObj = col.getFreezeTableName() === 'movable' ? this.parent.getMovableRowsObject()[rowIndex] :\n                col.getFreezeTableName() === literals.frozenRight ? gObj.getFrozenRightRowsObject()[rowIndex]\n                    : gObj.getRowObjectFromUID(td.parentElement.getAttribute('data-uid'));\n            this.refreshTD(td, col, rowObj, value);\n            this.parent.trigger(events.queryCellInfo, {\n                cell: this.newReactTd || td, column: col, data: rowObj.changes\n            });\n        }\n    };\n    BatchEdit.prototype.setChanges = function (rowObj, field, value) {\n        var currentRowObj;\n        if (!this.parent.isFrozenGrid()) {\n            if (!rowObj.changes) {\n                rowObj.changes = extend({}, {}, rowObj.data, true);\n            }\n            if (!isNullOrUndefined(field)) {\n                DataUtil.setValue(field, value, rowObj.changes);\n            }\n            if (rowObj.data[field] !== value) {\n                var type = this.parent.getColumnByField(field).type;\n                if ((type === 'date' || type === 'datetime')) {\n                    if (new Date(rowObj.data[field]).toString() !== new Date(value).toString()) {\n                        rowObj.isDirty = true;\n                    }\n                }\n                else {\n                    rowObj.isDirty = true;\n                }\n            }\n        }\n        else {\n            var rowEle = this.parent.getRowElementByUID(rowObj.uid);\n            var rowIndex = parseInt(rowEle.getAttribute(literals.ariaRowIndex), 10);\n            currentRowObj = this.parent.getRowsObject()[rowIndex];\n            if (!currentRowObj.changes) {\n                currentRowObj.changes = extend({}, {}, rowObj.data, true);\n            }\n            if (!isNullOrUndefined(field)) {\n                setValue(field, value, currentRowObj.changes);\n            }\n            var movableRowObject = this.parent.getMovableRowsObject()[rowIndex];\n            movableRowObject.changes = extend({}, {}, currentRowObj.changes, true);\n            if (rowObj.data[field] !== value) {\n                movableRowObject.isDirty = true;\n                currentRowObj.isDirty = true;\n            }\n            if (this.parent.getFrozenMode() === literals.leftRight) {\n                var frRowObject = this.parent.getFrozenRightRowsObject()[rowIndex];\n                frRowObject.changes = extend({}, {}, currentRowObj.changes, true);\n                if (rowObj.data[field] !== value) {\n                    frRowObject.isDirty = true;\n                }\n            }\n        }\n    };\n    BatchEdit.prototype.updateRow = function (index, data) {\n        var keys = Object.keys(data);\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var col = keys_1[_i];\n            this.updateCell(index, col, data[col]);\n        }\n    };\n    BatchEdit.prototype.getCellIdx = function (uid) {\n        var cIdx = this.parent.getColumnIndexByUid(uid) + this.parent.groupSettings.columns.length;\n        if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n            cIdx++;\n        }\n        if (this.parent.isRowDragable()) {\n            cIdx++;\n        }\n        return cIdx;\n    };\n    BatchEdit.prototype.refreshTD = function (td, column, rowObj, value) {\n        var cell = new CellRenderer(this.parent, this.serviceLocator);\n        var rowcell;\n        value = column.type === 'number' && !isNullOrUndefined(value) ? parseFloat(value) : value;\n        this.setChanges(rowObj, column.field, value);\n        var frzCols = this.parent.getFrozenColumns() || this.parent.getFrozenLeftColumnsCount()\n            || this.parent.getFrozenRightColumnsCount();\n        frzCols = frzCols && this.parent.isRowDragable() ? frzCols + 1 : frzCols;\n        refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n        if (frzCols && column.getFreezeTableName() === 'movable' && this.parent.getColumns().length === rowObj.cells.length) {\n            rowcell = rowObj.cells.slice(frzCols, rowObj.cells.length);\n        }\n        else {\n            rowcell = rowObj.cells;\n        }\n        var parentElement;\n        var cellIndex;\n        if (this.parent.isReact) {\n            parentElement = td.parentElement;\n            cellIndex = td.cellIndex;\n        }\n        var index = 0;\n        if (frzCols) {\n            index = column.getFreezeTableName() === 'movable' && this.parent.getFrozenMode() !== 'Right'\n                ? frzCols : column.getFreezeTableName() === literals.frozenRight\n                ? this.parent.getFrozenLeftColumnsCount() + this.parent.getMovableColumnsCount() : index;\n        }\n        cell.refreshTD(td, rowcell[this.getCellIdx(column.uid) - index], rowObj.changes, { 'index': this.getCellIdx(column.uid) });\n        if (this.parent.isReact) {\n            this.newReactTd = parentElement.cells[cellIndex];\n            parentElement.cells[cellIndex].classList.add('e-updatedtd');\n        }\n        else {\n            td.classList.add('e-updatedtd');\n        }\n        td.classList.add('e-updatedtd');\n        this.parent.notify(events.toolbarRefresh, {});\n    };\n    BatchEdit.prototype.getColIndex = function (cells, index) {\n        var cIdx = 0;\n        if (this.parent.allowGrouping && this.parent.groupSettings.columns) {\n            cIdx = this.parent.groupSettings.columns.length;\n        }\n        if (!isNullOrUndefined(this.parent.detailTemplate) || !isNullOrUndefined(this.parent.childGrid)) {\n            cIdx++;\n        }\n        if (this.parent.isRowDragable()) {\n            cIdx++;\n        }\n        for (var m = 0; m < cells.length; m++) {\n            var colIndex = parseInt(cells[m].getAttribute(literals.ariaColIndex), 10);\n            if (colIndex === index - cIdx) {\n                return m;\n            }\n        }\n        return -1;\n    };\n    BatchEdit.prototype.editNextValCell = function () {\n        var gObj = this.parent;\n        var btmIdx = this.getBottomIndex();\n        if (this.isAdded && !gObj.isEdit) {\n            for (var i = this.cellDetails.cellIndex; i < gObj.getColumns().length; i++) {\n                if (gObj.isEdit) {\n                    return;\n                }\n                var index = this.findNextEditableCell(this.cellDetails.cellIndex + 1, true, true);\n                var col = gObj.getColumns()[index];\n                if (col) {\n                    if (this.parent.editSettings.newRowPosition === 'Bottom') {\n                        this.editCell(btmIdx, col.field, true);\n                    }\n                    else {\n                        var args = { index: 0, column: col };\n                        this.parent.notify(events.nextCellIndex, args);\n                        this.editCell(args.index, col.field, true);\n                    }\n                    this.saveCell();\n                }\n            }\n            if (!gObj.isEdit) {\n                this.isAdded = false;\n            }\n        }\n    };\n    BatchEdit.prototype.escapeCellEdit = function () {\n        var args = this.generateCellArgs();\n        args.value = args.previousValue;\n        this.successCallBack(args, args.cell.parentElement, args.column, true)(args);\n    };\n    BatchEdit.prototype.generateCellArgs = function () {\n        var gObj = this.parent;\n        this.parent.element.classList.remove('e-editing');\n        var column = this.cellDetails.column;\n        var obj = {};\n        obj[column.field] = getObject(column.field, this.cellDetails.rowData);\n        var editedData = gObj.editModule.getCurrentEditedData(this.form, obj);\n        var cloneEditedData = extend({}, editedData);\n        editedData = extend({}, editedData, this.cellDetails.rowData);\n        var value = getObject(column.field, cloneEditedData);\n        if (!isNullOrUndefined(column.field) && !isUndefined(value)) {\n            setValue(column.field, value, editedData);\n        }\n        var args = {\n            columnName: column.field,\n            value: getObject(column.field, editedData),\n            rowData: this.cellDetails.rowData,\n            column: column,\n            previousValue: this.cellDetails.value,\n            isForeignKey: this.cellDetails.isForeignKey,\n            cancel: false\n        };\n        args.cell = this.form.parentElement;\n        args.columnObject = column;\n        return args;\n    };\n    BatchEdit.prototype.saveCell = function (isForceSave) {\n        if (this.preventSaveCell || !this.form) {\n            return;\n        }\n        var gObj = this.parent;\n        if (!isForceSave && (!gObj.isEdit || this.validateFormObj())) {\n            return;\n        }\n        this.preventSaveCell = true;\n        var args = this.generateCellArgs();\n        var tr = args.cell.parentElement;\n        var col = args.column;\n        if (!isForceSave) {\n            gObj.trigger(events.cellSave, args, this.successCallBack(args, tr, col));\n            gObj.notify(events.batchForm, { formObj: this.form });\n        }\n        else {\n            this.successCallBack(args, tr, col)(args);\n        }\n    };\n    BatchEdit.prototype.successCallBack = function (cellSaveArgs, tr, column, isEscapeCellEdit) {\n        var _this = this;\n        return function (cellSaveArgs) {\n            var gObj = _this.parent;\n            cellSaveArgs.cell = cellSaveArgs.cell ? cellSaveArgs.cell : _this.form.parentElement;\n            cellSaveArgs.columnObject = cellSaveArgs.columnObject ? cellSaveArgs.columnObject : column;\n            cellSaveArgs.columnObject.index = isNullOrUndefined(cellSaveArgs.columnObject.index) ? 0 : cellSaveArgs.columnObject.index;\n            if (cellSaveArgs.cancel) {\n                _this.preventSaveCell = false;\n                if (_this.editNext) {\n                    _this.editNext = false;\n                    if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n                        return;\n                    }\n                    _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n                }\n                return;\n            }\n            gObj.editModule.destroyWidgets([column]);\n            gObj.isEdit = false;\n            gObj.editModule.destroyForm();\n            _this.parent.notify(events.tooltipDestroy, {});\n            var rowObj = parentsUntil(cellSaveArgs.cell, literals.movableContent)\n                || parentsUntil(cellSaveArgs.cell, literals.movableHeader) ? gObj.getRowObjectFromUID(tr.getAttribute('data-uid'), true)\n                : gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            if (gObj.getFrozenMode() === literals.leftRight && (parentsUntil(cellSaveArgs.cell, 'e-frozen-right-header')\n                || parentsUntil(cellSaveArgs.cell, 'e-frozen-right-content'))) {\n                rowObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'), false, true);\n            }\n            _this.refreshTD(cellSaveArgs.cell, column, rowObj, cellSaveArgs.value);\n            if (_this.parent.isReact) {\n                cellSaveArgs.cell = _this.newReactTd;\n            }\n            removeClass([tr], [literals.editedRow, 'e-batchrow']);\n            removeClass([cellSaveArgs.cell], ['e-editedbatchcell', 'e-boolcell']);\n            if (!isNullOrUndefined(cellSaveArgs.value) && cellSaveArgs.value.toString() ===\n                (!isNullOrUndefined(_this.cellDetails.value) ? _this.cellDetails.value : '').toString() && !_this.isColored\n                || (isNullOrUndefined(cellSaveArgs.value) && isNullOrUndefined(rowObj.data[column.field]) &&\n                    isNullOrUndefined(_this.cellDetails.value) && !cellSaveArgs.cell.parentElement.classList.contains('e-insertedrow'))) {\n                cellSaveArgs.cell.classList.remove('e-updatedtd');\n            }\n            if (isNullOrUndefined(isEscapeCellEdit)) {\n                gObj.trigger(events.cellSaved, cellSaveArgs);\n            }\n            gObj.notify(events.toolbarRefresh, {});\n            _this.isColored = false;\n            if (_this.parent.aggregates.length > 0) {\n                _this.parent.notify(events.refreshFooterRenderer, {});\n                if (_this.parent.groupSettings.columns.length > 0 && !_this.isAddRow(_this.cellDetails.rowIndex)) {\n                    _this.parent.notify(events.groupAggregates, {});\n                }\n            }\n            _this.preventSaveCell = false;\n            if (_this.editNext) {\n                _this.editNext = false;\n                if (_this.cellDetails.rowIndex === _this.index && _this.cellDetails.column.field === _this.field) {\n                    return;\n                }\n                var col = gObj.getColumnByField(_this.field);\n                if (col && col.allowEditing) {\n                    _this.editCellExtend(_this.index, _this.field, _this.isAdd);\n                }\n            }\n            if (isEscapeCellEdit) {\n                gObj.notify(events.restoreFocus, {});\n            }\n        };\n    };\n    BatchEdit.prototype.getDataByIndex = function (index) {\n        var row = this.parent.getRowObjectFromUID(this.parent.getDataRows()[index].getAttribute('data-uid'));\n        return row.changes ? row.changes : row.data;\n    };\n    BatchEdit.prototype.keyDownHandler = function (e) {\n        if ((e.action === 'tab' || e.action === 'shiftTab') && this.parent.isEdit) {\n            var gObj = this.parent;\n            var btmIdx = this.getBottomIndex();\n            var rowcell = parentsUntil(e.target, literals.rowCell);\n            if (rowcell) {\n                var cell = rowcell.querySelector('.e-field');\n                if (cell) {\n                    var visibleColumns = this.parent.getVisibleColumns();\n                    var columnIndex = e.action === 'tab' ? visibleColumns.length - 1 : 0;\n                    if (visibleColumns[columnIndex].field === cell.getAttribute('id').slice(this.parent.element.id.length)) {\n                        if (this.cellDetails.rowIndex === btmIdx && e.action === 'tab') {\n                            if (gObj.editSettings.newRowPosition === 'Top') {\n                                gObj.editSettings.newRowPosition = 'Bottom';\n                                this.addRecord();\n                                gObj.editSettings.newRowPosition = 'Top';\n                            }\n                            else {\n                                this.addRecord();\n                            }\n                        }\n                        else {\n                            this.saveCell();\n                        }\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    BatchEdit.prototype.addCancelWhilePaging = function () {\n        if (this.validateFormObj()) {\n            this.parent.notify(events.destroyForm, {});\n            this.parent.isEdit = false;\n            this.isColored = false;\n        }\n    };\n    BatchEdit.prototype.getBottomIndex = function () {\n        var changes = this.getBatchChanges();\n        return this.parent.getCurrentViewRecords().length + changes[literals.addedRecords].length -\n            changes[literals.deletedRecords].length - 1;\n    };\n    return BatchEdit;\n}());\nexport { BatchEdit };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}