{"ast":null,"code":"import { Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nimport { formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getScrollBarWidth, getUpdateUsingRaf } from '../base/util';\nimport { scroll, contentReady, uiUpdate, onEmpty, headerRefreshed, textWrapRefresh, virtualScrollEdit, infiniteScrollHandler, closeFilterDialog } from '../base/constant';\nimport { lazyLoadScrollHandler, checkScrollReset } from '../base/constant';\nimport { ColumnWidthService } from '../services/width-controller';\nimport * as literals from '../base/string-literals';\nimport * as events from '../base/constant';\n/**\n * The `Scroll` module is used to handle scrolling behaviour.\n */\nvar Scroll = /** @class */function () {\n  /**\n   * Constructor for the Grid scrolling.\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @hidden\n   */\n  function Scroll(parent) {\n    //To maintain scroll state on grid actions.\n    this.previousValues = {\n      top: 0,\n      left: 0\n    };\n    this.oneTimeReady = true;\n    this.parent = parent;\n    this.widthService = new ColumnWidthService(parent);\n    this.addEventListener();\n  }\n  /**\n   * For internal use only - Get the module name.\n   *\n   * @returns {string} returns the module name\n   * @private\n   */\n  Scroll.prototype.getModuleName = function () {\n    return 'scroll';\n  };\n  /**\n   * @param {boolean} uiupdate - specifies the uiupdate\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.setWidth = function (uiupdate) {\n    this.parent.element.style.width = formatUnit(this.parent.width);\n    if (uiupdate) {\n      this.widthService.setWidthToColumns();\n    }\n    if (this.parent.toolbarModule && this.parent.toolbarModule.toolbar && this.parent.toolbarModule.toolbar.element) {\n      this.parent.toolbarModule.toolbar.refreshOverflow();\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.setHeight = function () {\n    var mHdrHeight = 0;\n    var content = this.parent.getContent().querySelector('.' + literals.content);\n    var height = this.parent.height;\n    if (this.parent.isFrozenGrid() && this.parent.height !== 'auto' && this.parent.height.toString().indexOf('%') < 0) {\n      height = parseInt(height, 10) - Scroll.getScrollBarWidth();\n    }\n    if (!this.parent.enableVirtualization && this.parent.frozenRows && this.parent.height !== 'auto') {\n      var tbody = this.parent.getHeaderContent().querySelector(literals.tbody);\n      mHdrHeight = tbody ? tbody.offsetHeight : 0;\n      if (tbody && mHdrHeight) {\n        var add = tbody.getElementsByClassName(literals.addedRow).length;\n        var height_1 = add * this.parent.getRowHeight();\n        mHdrHeight -= height_1;\n      }\n      content.style.height = formatUnit(height - mHdrHeight);\n    } else {\n      content.style.height = formatUnit(height);\n    }\n    this.ensureOverflow(content);\n    if (this.parent.isFrozenGrid()) {\n      this.refresh();\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.setPadding = function () {\n    var content = this.parent.getHeaderContent();\n    var scrollWidth = Scroll.getScrollBarWidth() - this.getThreshold();\n    var cssProps = this.getCssProperties();\n    var padding = this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight ? '0.5px' : '1px';\n    content.querySelector('.' + literals.headerContent).style[cssProps.border] = scrollWidth > 0 ? padding : '0px';\n    content.style[cssProps.padding] = scrollWidth > 0 ? scrollWidth + 'px' : '0px';\n  };\n  /**\n   * @param {boolean} rtl - specifies the rtl\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.removePadding = function (rtl) {\n    var cssProps = this.getCssProperties(rtl);\n    var hDiv = this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n    hDiv.style[cssProps.border] = '';\n    hDiv.parentElement.style[cssProps.padding] = '';\n    var footerDiv = this.parent.getFooterContent();\n    if (footerDiv && footerDiv.classList.contains('e-footerpadding')) {\n      footerDiv.classList.remove('e-footerpadding');\n    }\n  };\n  /**\n   * Refresh makes the Grid adoptable with the height of parent container.\n   *\n   * > The [`height`](grid/#height/) must be set to 100%.\n   *\n   * @returns {void}\n   */\n  Scroll.prototype.refresh = function () {\n    if (this.parent.height !== '100%') {\n      return;\n    }\n    var content = this.parent.getContent();\n    this.parent.element.style.height = '100%';\n    var height = this.widthService.getSiblingsHeight(content);\n    content.style.height = 'calc(100% - ' + height + 'px)'; //Set the height to the  '.' + literals.gridContent;\n    if (this.parent.isFrozenGrid()) {\n      content.firstElementChild.style.height = 'calc(100% - ' + getScrollBarWidth() + 'px)';\n    }\n  };\n  Scroll.prototype.getThreshold = function () {\n    /* Some browsers places the scroller outside the content,\n     * hence the padding should be adjusted.*/\n    var appName = Browser.info.name;\n    if (appName === 'mozilla') {\n      return 0.5;\n    }\n    return 1;\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(onEmpty, this.wireEvents, this);\n    this.parent.on(contentReady, this.wireEvents, this);\n    this.parent.on(uiUpdate, this.onPropertyChanged, this);\n    this.parent.on(textWrapRefresh, this.wireEvents, this);\n    this.parent.on(headerRefreshed, this.setScrollLeft, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.off(onEmpty, this.wireEvents);\n    this.parent.off(contentReady, this.wireEvents);\n    this.parent.off(uiUpdate, this.onPropertyChanged);\n    this.parent.off(textWrapRefresh, this.wireEvents);\n    this.parent.off(headerRefreshed, this.setScrollLeft);\n  };\n  Scroll.prototype.setScrollLeft = function () {\n    if (this.parent.isFrozenGrid()) {\n      this.parent.headerModule.getMovableHeader().scrollLeft = this.previousValues.left;\n    } else {\n      this.parent.getHeaderContent().querySelector('.' + literals.headerContent).scrollLeft = this.previousValues.left;\n    }\n  };\n  Scroll.prototype.onFrozenContentScroll = function () {\n    var _this = this;\n    return function (e) {\n      if (_this.content.querySelector(literals.tbody) === null || _this.parent.isPreventScrollEvent) {\n        return;\n      }\n      if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n        _this.parent.notify(infiniteScrollHandler, e);\n      }\n      _this.previousValues.top = e.target.scrollTop;\n    };\n  };\n  Scroll.prototype.onContentScroll = function (scrollTarget) {\n    var _this = this;\n    var element = scrollTarget;\n    var isHeader = element.classList.contains(literals.headerContent);\n    return function (e) {\n      if (_this.content.querySelector(literals.tbody) === null || _this.parent.isPreventScrollEvent) {\n        return;\n      }\n      var target = e.target;\n      var left = target.scrollLeft;\n      if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n        _this.parent.notify(infiniteScrollHandler, {\n          target: e.target,\n          isLeft: _this.previousValues.left !== left\n        });\n      }\n      if (_this.parent.groupSettings.columns.length && _this.parent.groupSettings.enableLazyLoading) {\n        var isDown = _this.previousValues.top < _this.parent.getContent().firstElementChild.scrollTop;\n        _this.parent.notify(lazyLoadScrollHandler, {\n          scrollDown: isDown\n        });\n      }\n      _this.parent.notify(virtualScrollEdit, {});\n      var isFooter = target.classList.contains('e-summarycontent');\n      if (_this.previousValues.left === left) {\n        _this.previousValues.top = !isHeader ? _this.previousValues.top : target.scrollTop;\n        return;\n      }\n      _this.parent.notify(closeFilterDialog, e);\n      element.scrollLeft = left;\n      if (isFooter) {\n        _this.header.scrollLeft = left;\n      }\n      _this.previousValues.left = left;\n      _this.parent.notify(scroll, {\n        left: left\n      });\n    };\n  };\n  Scroll.prototype.onCustomScrollbarScroll = function (mCont, mHdr) {\n    var _this = this;\n    var content = mCont;\n    var header = mHdr;\n    return function (e) {\n      if (_this.content.querySelector(literals.tbody) === null) {\n        return;\n      }\n      var target = e.target;\n      var left = target.scrollLeft;\n      if (_this.previousValues.left === left) {\n        return;\n      }\n      content.scrollLeft = left;\n      header.scrollLeft = left;\n      _this.previousValues.left = left;\n      _this.parent.notify(scroll, {\n        left: left\n      });\n      if (_this.parent.isDestroyed) {\n        return;\n      }\n    };\n  };\n  Scroll.prototype.onTouchScroll = function (scrollTarget) {\n    var _this = this;\n    var element = scrollTarget;\n    return function (e) {\n      if (e.pointerType === 'mouse') {\n        return;\n      }\n      var isFrozen = _this.parent.isFrozenGrid();\n      var pageXY = _this.getPointXY(e);\n      var left = element.scrollLeft + (_this.pageXY.x - pageXY.x);\n      var mHdr = isFrozen ? _this.parent.getHeaderContent().querySelector('.' + literals.movableHeader) : _this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n      var mCont = isFrozen ? _this.parent.getContent().querySelector('.' + literals.movableContent) : _this.parent.getContent().querySelector('.' + literals.content);\n      if (_this.previousValues.left === left || left < 0 || mHdr.scrollWidth - mHdr.clientWidth < left) {\n        return;\n      }\n      e.preventDefault();\n      mHdr.scrollLeft = left;\n      mCont.scrollLeft = left;\n      if (isFrozen) {\n        var scrollBar = _this.parent.getContent().querySelector('.e-movablescrollbar');\n        scrollBar.scrollLeft = left;\n      }\n      _this.pageXY.x = pageXY.x;\n      _this.previousValues.left = left;\n    };\n  };\n  Scroll.prototype.setPageXY = function () {\n    var _this = this;\n    return function (e) {\n      if (e.pointerType === 'mouse') {\n        return;\n      }\n      _this.pageXY = _this.getPointXY(e);\n    };\n  };\n  Scroll.prototype.getPointXY = function (e) {\n    var pageXY = {\n      x: 0,\n      y: 0\n    };\n    if (e.touches && e.touches.length) {\n      pageXY.x = e.touches[0].pageX;\n      pageXY.y = e.touches[0].pageY;\n    } else {\n      pageXY.x = e.pageX;\n      pageXY.y = e.pageY;\n    }\n    return pageXY;\n  };\n  Scroll.prototype.getScrollbleParent = function (node) {\n    if (node === null) {\n      return null;\n    }\n    var parent = isNullOrUndefined(node.tagName) ? node.scrollingElement : node;\n    var overflowY = document.defaultView.getComputedStyle(parent, null).overflowY;\n    if (parent.scrollHeight > parent.clientHeight && overflowY !== 'hidden' && overflowY !== 'visible' || node.tagName === \"HTML\" || node.tagName === \"BODY\") {\n      return node;\n    } else {\n      return this.getScrollbleParent(node.parentNode);\n    }\n  };\n  /**\n   * @param {boolean} isAdd - specifies whether adding/removing the event\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.addStickyListener = function (isAdd) {\n    this.parentElement = this.getScrollbleParent(this.parent.element.parentElement);\n    if (isAdd) {\n      if (this.parentElement) {\n        EventHandler.add(this.parentElement.tagName === 'HTML' || this.parentElement.tagName === 'BODY' ? document : this.parentElement, 'scroll', this.makeStickyHeader, this);\n      }\n    } else {\n      EventHandler.remove(this.parentElement, 'scroll', this.makeStickyHeader);\n    }\n  };\n  Scroll.prototype.wireEvents = function () {\n    var _this = this;\n    if (this.oneTimeReady) {\n      var frzCols = this.parent.isFrozenGrid();\n      this.content = this.parent.getContent().querySelector('.' + literals.content);\n      this.header = this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n      var mCont = this.content.querySelector('.' + literals.movableContent);\n      var mHdr = this.header.querySelector('.' + literals.movableHeader);\n      var mScrollBar = this.parent.getContent().querySelector('.e-movablescrollbar');\n      if (this.parent.frozenRows) {\n        EventHandler.add(frzCols ? mHdr : this.header, 'touchstart pointerdown', this.setPageXY(), this);\n        EventHandler.add(frzCols ? mHdr : this.header, 'touchmove pointermove', this.onTouchScroll(frzCols ? mCont : this.content), this);\n      }\n      if (this.parent.isFrozenGrid()) {\n        EventHandler.add(mScrollBar, 'scroll', this.onCustomScrollbarScroll(mCont, mHdr), this);\n        EventHandler.add(mCont, 'scroll', this.onCustomScrollbarScroll(mScrollBar, mHdr), this);\n        EventHandler.add(mHdr, 'scroll', this.onCustomScrollbarScroll(mScrollBar, mCont), this);\n        EventHandler.add(this.content, 'scroll', this.onFrozenContentScroll(), this);\n        EventHandler.add(mHdr, 'touchstart pointerdown', this.setPageXY(), this);\n        EventHandler.add(mHdr, 'touchmove pointermove', this.onTouchScroll(mCont), this);\n        EventHandler.add(mCont, 'touchstart pointerdown', this.setPageXY(), this);\n        if (!(/macintosh|ipad/.test(Browser.userAgent.toLowerCase()) && Browser.isDevice)) {\n          EventHandler.add(mCont, 'touchmove pointermove', this.onTouchScroll(mHdr), this);\n        }\n      } else {\n        EventHandler.add(this.content, 'scroll', this.onContentScroll(this.header), this);\n        EventHandler.add(this.header, 'scroll', this.onContentScroll(this.content), this);\n      }\n      if (this.parent.aggregates.length) {\n        EventHandler.add(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll(this.content), this);\n      }\n      if (this.parent.enableStickyHeader) {\n        this.addStickyListener(true);\n      }\n      this.refresh();\n      this.oneTimeReady = false;\n    }\n    var table = this.parent.getContentTable();\n    var sLeft;\n    var sHeight;\n    var clientHeight;\n    getUpdateUsingRaf(function () {\n      sLeft = _this.header.scrollLeft;\n      sHeight = table.scrollHeight;\n      clientHeight = _this.parent.getContent().clientHeight;\n    }, function () {\n      var args = {\n        cancel: false\n      };\n      _this.parent.notify(checkScrollReset, args);\n      if (!_this.parent.enableVirtualization && !_this.parent.enableInfiniteScrolling) {\n        if (sHeight < clientHeight) {\n          addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n          if (_this.parent.isFrozenGrid()) {\n            addClass(_this.parent.getContent().querySelector('.' + literals.movableContent).querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n            if (_this.parent.getFrozenRightColumnsCount()) {\n              addClass(_this.parent.getContent().querySelector('.e-frozen-right-content').querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n            }\n          }\n        }\n        if (!args.cancel) {\n          if ((_this.parent.frozenRows > 0 || _this.parent.isFrozenGrid()) && _this.header.querySelector('.' + literals.movableHeader)) {\n            _this.header.querySelector('.' + literals.movableHeader).scrollLeft = _this.previousValues.left;\n          } else {\n            _this.header.scrollLeft = _this.previousValues.left;\n          }\n          _this.content.scrollLeft = _this.previousValues.left;\n          _this.content.scrollTop = _this.previousValues.top;\n        }\n      }\n      if (!_this.parent.enableColumnVirtualization) {\n        _this.content.scrollLeft = sLeft;\n      }\n      if (_this.parent.isFrozenGrid() && _this.header.querySelector('.' + literals.movableHeader)) {\n        _this.header.querySelector('.' + literals.movableHeader).scrollLeft = _this.content.querySelector('.' + literals.movableContent).scrollLeft;\n      }\n    });\n    this.parent.isPreventScrollEvent = false;\n  };\n  /**\n   * @param {boolean} rtl - specifies the rtl\n   * @returns {ScrollCss} returns the ScrollCss\n   * @hidden\n   */\n  Scroll.prototype.getCssProperties = function (rtl) {\n    var css = {};\n    var enableRtl = isNullOrUndefined(rtl) ? this.parent.enableRtl : rtl;\n    css.border = enableRtl ? 'borderLeftWidth' : 'borderRightWidth';\n    css.padding = enableRtl ? 'paddingLeft' : 'paddingRight';\n    return css;\n  };\n  Scroll.prototype.ensureOverflow = function (content) {\n    content.style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n  };\n  Scroll.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n    this.setPadding();\n    this.oneTimeReady = true;\n    if (this.parent.height === 'auto') {\n      this.removePadding();\n    }\n    this.wireEvents();\n    this.setHeight();\n    var width = 'width';\n    this.setWidth(!isNullOrUndefined(e.properties[width]));\n  };\n  Scroll.prototype.makeStickyHeader = function () {\n    if (this.parent.enableStickyHeader && this.parent.element && this.parent.getContent()) {\n      var contentRect = this.parent.getContent().getClientRects()[0];\n      if (contentRect) {\n        var headerEle = this.parent.getHeaderContent();\n        var toolbarEle = this.parent.element.querySelector('.e-toolbar');\n        var groupHeaderEle = this.parent.element.querySelector('.e-groupdroparea');\n        var height = headerEle.offsetHeight + (toolbarEle ? toolbarEle.offsetHeight : 0) + (groupHeaderEle ? groupHeaderEle.offsetHeight : 0);\n        var parentTop = this.parentElement.getClientRects()[0].top;\n        var top_1 = contentRect.top - (parentTop < 0 ? 0 : parentTop);\n        var left = contentRect.left;\n        if (top_1 < height && contentRect.bottom > 0) {\n          headerEle.classList.add('e-sticky');\n          var elemTop = 0;\n          if (groupHeaderEle && this.parent.groupSettings.showDropArea) {\n            this.setSticky(groupHeaderEle, elemTop, contentRect.width, left, true);\n            elemTop += groupHeaderEle.getClientRects()[0].height;\n          }\n          if (toolbarEle) {\n            this.setSticky(toolbarEle, elemTop, contentRect.width, left, true);\n            elemTop += toolbarEle.getClientRects()[0].height;\n          }\n          this.setSticky(headerEle, elemTop, contentRect.width, left, true);\n        } else {\n          if (headerEle.classList.contains('e-sticky')) {\n            this.setSticky(headerEle, null, null, null, false);\n            if (toolbarEle) {\n              this.setSticky(toolbarEle, null, null, null, false);\n            }\n            if (groupHeaderEle) {\n              this.setSticky(groupHeaderEle, null, null, null, false);\n            }\n            var ccDlg = this.parent.element.querySelector('.e-ccdlg');\n            if (ccDlg) {\n              ccDlg.classList.remove('e-sticky');\n            }\n          }\n        }\n        this.parent.notify(events.stickyScrollComplete, {});\n      }\n    }\n  };\n  Scroll.prototype.setSticky = function (ele, top, width, left, isAdd) {\n    if (isAdd) {\n      ele.style.width = width + 'px';\n      ele.classList.add('e-sticky');\n    } else {\n      ele.classList.remove('e-sticky');\n    }\n    ele.style.top = top != null ? top + 'px' : '';\n    ele.style.left = left !== null ? parseInt(ele.style.left, 10) !== left ? left + 'px' : ele.style.left : '';\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Scroll.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n    if (!gridElement || !gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent)) {\n      return;\n    }\n    this.removeEventListener();\n    //Remove Dom event\n    var cont = this.parent.getContent().querySelector('.' + literals.content);\n    EventHandler.remove(cont, 'scroll', this.onContentScroll);\n    if (this.parent.enableStickyHeader) {\n      this.addStickyListener(false);\n    }\n    //Remove padding\n    this.removePadding();\n    removeClass([this.parent.getHeaderContent().querySelector('.' + literals.headerContent)], literals.headerContent);\n    removeClass([cont], literals.content);\n    //Remove height\n    cont.style.height = '';\n    //Remove width\n    this.parent.element.style.width = '';\n  };\n  /**\n   * Function to get the scrollbar width of the browser.\n   *\n   * @returns {number} return the width\n   * @hidden\n   */\n  Scroll.getScrollBarWidth = function () {\n    return getScrollBarWidth();\n  };\n  return Scroll;\n}();\nexport { Scroll };","map":{"version":3,"names":["Browser","EventHandler","addClass","removeClass","formatUnit","isNullOrUndefined","getScrollBarWidth","getUpdateUsingRaf","scroll","contentReady","uiUpdate","onEmpty","headerRefreshed","textWrapRefresh","virtualScrollEdit","infiniteScrollHandler","closeFilterDialog","lazyLoadScrollHandler","checkScrollReset","ColumnWidthService","literals","events","Scroll","parent","previousValues","top","left","oneTimeReady","widthService","addEventListener","prototype","getModuleName","setWidth","uiupdate","element","style","width","setWidthToColumns","toolbarModule","toolbar","refreshOverflow","setHeight","mHdrHeight","content","getContent","querySelector","height","isFrozenGrid","toString","indexOf","parseInt","enableVirtualization","frozenRows","tbody","getHeaderContent","offsetHeight","add","getElementsByClassName","addedRow","length","height_1","getRowHeight","ensureOverflow","refresh","setPadding","scrollWidth","getThreshold","cssProps","getCssProperties","padding","getFrozenMode","leftRight","headerContent","border","removePadding","rtl","hDiv","parentElement","footerDiv","getFooterContent","classList","contains","remove","getSiblingsHeight","firstElementChild","appName","info","name","isDestroyed","on","wireEvents","onPropertyChanged","setScrollLeft","removeEventListener","off","headerModule","getMovableHeader","scrollLeft","onFrozenContentScroll","_this","e","isPreventScrollEvent","infiniteScrollModule","enableInfiniteScrolling","notify","target","scrollTop","onContentScroll","scrollTarget","isHeader","isLeft","groupSettings","columns","enableLazyLoading","isDown","scrollDown","isFooter","header","onCustomScrollbarScroll","mCont","mHdr","onTouchScroll","pointerType","isFrozen","pageXY","getPointXY","x","movableHeader","movableContent","clientWidth","preventDefault","scrollBar","setPageXY","y","touches","pageX","pageY","getScrollbleParent","node","tagName","scrollingElement","overflowY","document","defaultView","getComputedStyle","scrollHeight","clientHeight","parentNode","addStickyListener","isAdd","makeStickyHeader","frzCols","mScrollBar","test","userAgent","toLowerCase","isDevice","aggregates","firstChild","enableStickyHeader","table","getContentTable","sLeft","sHeight","args","cancel","querySelectorAll","getFrozenRightColumnsCount","enableColumnVirtualization","css","enableRtl","module","properties","contentRect","getClientRects","headerEle","toolbarEle","groupHeaderEle","parentTop","top_1","bottom","elemTop","showDropArea","setSticky","ccDlg","stickyScrollComplete","ele","destroy","gridElement","gridHeader","gridContent","cont"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js"],"sourcesContent":["import { Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nimport { formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getScrollBarWidth, getUpdateUsingRaf } from '../base/util';\nimport { scroll, contentReady, uiUpdate, onEmpty, headerRefreshed, textWrapRefresh, virtualScrollEdit, infiniteScrollHandler, closeFilterDialog } from '../base/constant';\nimport { lazyLoadScrollHandler, checkScrollReset } from '../base/constant';\nimport { ColumnWidthService } from '../services/width-controller';\nimport * as literals from '../base/string-literals';\nimport * as events from '../base/constant';\n/**\n * The `Scroll` module is used to handle scrolling behaviour.\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Grid scrolling.\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @hidden\n     */\n    function Scroll(parent) {\n        //To maintain scroll state on grid actions.\n        this.previousValues = { top: 0, left: 0 };\n        this.oneTimeReady = true;\n        this.parent = parent;\n        this.widthService = new ColumnWidthService(parent);\n        this.addEventListener();\n    }\n    /**\n     * For internal use only - Get the module name.\n     *\n     * @returns {string} returns the module name\n     * @private\n     */\n    Scroll.prototype.getModuleName = function () {\n        return 'scroll';\n    };\n    /**\n     * @param {boolean} uiupdate - specifies the uiupdate\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setWidth = function (uiupdate) {\n        this.parent.element.style.width = formatUnit(this.parent.width);\n        if (uiupdate) {\n            this.widthService.setWidthToColumns();\n        }\n        if (this.parent.toolbarModule && this.parent.toolbarModule.toolbar &&\n            this.parent.toolbarModule.toolbar.element) {\n            this.parent.toolbarModule.toolbar.refreshOverflow();\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setHeight = function () {\n        var mHdrHeight = 0;\n        var content = this.parent.getContent().querySelector('.' + literals.content);\n        var height = this.parent.height;\n        if (this.parent.isFrozenGrid() && this.parent.height !== 'auto' && this.parent.height.toString().indexOf('%') < 0) {\n            height = parseInt(height, 10) - Scroll.getScrollBarWidth();\n        }\n        if (!this.parent.enableVirtualization && this.parent.frozenRows && this.parent.height !== 'auto') {\n            var tbody = this.parent.getHeaderContent().querySelector(literals.tbody);\n            mHdrHeight = tbody ? tbody.offsetHeight : 0;\n            if (tbody && mHdrHeight) {\n                var add = tbody.getElementsByClassName(literals.addedRow).length;\n                var height_1 = add * this.parent.getRowHeight();\n                mHdrHeight -= height_1;\n            }\n            content.style.height = formatUnit(height - mHdrHeight);\n        }\n        else {\n            content.style.height = formatUnit(height);\n        }\n        this.ensureOverflow(content);\n        if (this.parent.isFrozenGrid()) {\n            this.refresh();\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        var content = this.parent.getHeaderContent();\n        var scrollWidth = Scroll.getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.getCssProperties();\n        var padding = this.parent.getFrozenMode() === 'Right' || this.parent.getFrozenMode() === literals.leftRight ? '0.5px' : '1px';\n        content.querySelector('.' + literals.headerContent).style[cssProps.border] = scrollWidth > 0 ? padding : '0px';\n        content.style[cssProps.padding] = scrollWidth > 0 ? scrollWidth + 'px' : '0px';\n    };\n    /**\n     * @param {boolean} rtl - specifies the rtl\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.removePadding = function (rtl) {\n        var cssProps = this.getCssProperties(rtl);\n        var hDiv = this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n        hDiv.style[cssProps.border] = '';\n        hDiv.parentElement.style[cssProps.padding] = '';\n        var footerDiv = this.parent.getFooterContent();\n        if (footerDiv && footerDiv.classList.contains('e-footerpadding')) {\n            footerDiv.classList.remove('e-footerpadding');\n        }\n    };\n    /**\n     * Refresh makes the Grid adoptable with the height of parent container.\n     *\n     * > The [`height`](grid/#height/) must be set to 100%.\n     *\n     * @returns {void}\n     */\n    Scroll.prototype.refresh = function () {\n        if (this.parent.height !== '100%') {\n            return;\n        }\n        var content = this.parent.getContent();\n        this.parent.element.style.height = '100%';\n        var height = this.widthService.getSiblingsHeight(content);\n        content.style.height = 'calc(100% - ' + height + 'px)'; //Set the height to the  '.' + literals.gridContent;\n        if (this.parent.isFrozenGrid()) {\n            content.firstElementChild.style.height = 'calc(100% - ' + getScrollBarWidth() + 'px)';\n        }\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        var appName = Browser.info.name;\n        if (appName === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(onEmpty, this.wireEvents, this);\n        this.parent.on(contentReady, this.wireEvents, this);\n        this.parent.on(uiUpdate, this.onPropertyChanged, this);\n        this.parent.on(textWrapRefresh, this.wireEvents, this);\n        this.parent.on(headerRefreshed, this.setScrollLeft, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(onEmpty, this.wireEvents);\n        this.parent.off(contentReady, this.wireEvents);\n        this.parent.off(uiUpdate, this.onPropertyChanged);\n        this.parent.off(textWrapRefresh, this.wireEvents);\n        this.parent.off(headerRefreshed, this.setScrollLeft);\n    };\n    Scroll.prototype.setScrollLeft = function () {\n        if (this.parent.isFrozenGrid()) {\n            this.parent.headerModule.getMovableHeader().scrollLeft = this.previousValues.left;\n        }\n        else {\n            this.parent.getHeaderContent().querySelector('.' + literals.headerContent).scrollLeft = this.previousValues.left;\n        }\n    };\n    Scroll.prototype.onFrozenContentScroll = function () {\n        var _this = this;\n        return function (e) {\n            if (_this.content.querySelector(literals.tbody) === null || _this.parent.isPreventScrollEvent) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n                _this.parent.notify(infiniteScrollHandler, e);\n            }\n            _this.previousValues.top = e.target.scrollTop;\n        };\n    };\n    Scroll.prototype.onContentScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        var isHeader = element.classList.contains(literals.headerContent);\n        return function (e) {\n            if (_this.content.querySelector(literals.tbody) === null || _this.parent.isPreventScrollEvent) {\n                return;\n            }\n            var target = e.target;\n            var left = target.scrollLeft;\n            if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n                _this.parent.notify(infiniteScrollHandler, { target: e.target, isLeft: _this.previousValues.left !== left });\n            }\n            if (_this.parent.groupSettings.columns.length && _this.parent.groupSettings.enableLazyLoading) {\n                var isDown = _this.previousValues.top < _this.parent.getContent().firstElementChild.scrollTop;\n                _this.parent.notify(lazyLoadScrollHandler, { scrollDown: isDown });\n            }\n            _this.parent.notify(virtualScrollEdit, {});\n            var isFooter = target.classList.contains('e-summarycontent');\n            if (_this.previousValues.left === left) {\n                _this.previousValues.top = !isHeader ? _this.previousValues.top : target.scrollTop;\n                return;\n            }\n            _this.parent.notify(closeFilterDialog, e);\n            element.scrollLeft = left;\n            if (isFooter) {\n                _this.header.scrollLeft = left;\n            }\n            _this.previousValues.left = left;\n            _this.parent.notify(scroll, { left: left });\n        };\n    };\n    Scroll.prototype.onCustomScrollbarScroll = function (mCont, mHdr) {\n        var _this = this;\n        var content = mCont;\n        var header = mHdr;\n        return function (e) {\n            if (_this.content.querySelector(literals.tbody) === null) {\n                return;\n            }\n            var target = e.target;\n            var left = target.scrollLeft;\n            if (_this.previousValues.left === left) {\n                return;\n            }\n            content.scrollLeft = left;\n            header.scrollLeft = left;\n            _this.previousValues.left = left;\n            _this.parent.notify(scroll, { left: left });\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n        };\n    };\n    Scroll.prototype.onTouchScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            var isFrozen = _this.parent.isFrozenGrid();\n            var pageXY = _this.getPointXY(e);\n            var left = element.scrollLeft + (_this.pageXY.x - pageXY.x);\n            var mHdr = isFrozen ?\n                _this.parent.getHeaderContent().querySelector('.' + literals.movableHeader) :\n                _this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n            var mCont = isFrozen ?\n                _this.parent.getContent().querySelector('.' + literals.movableContent) :\n                _this.parent.getContent().querySelector('.' + literals.content);\n            if (_this.previousValues.left === left || (left < 0 || (mHdr.scrollWidth - mHdr.clientWidth) < left)) {\n                return;\n            }\n            e.preventDefault();\n            mHdr.scrollLeft = left;\n            mCont.scrollLeft = left;\n            if (isFrozen) {\n                var scrollBar = _this.parent.getContent().querySelector('.e-movablescrollbar');\n                scrollBar.scrollLeft = left;\n            }\n            _this.pageXY.x = pageXY.x;\n            _this.previousValues.left = left;\n        };\n    };\n    Scroll.prototype.setPageXY = function () {\n        var _this = this;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            _this.pageXY = _this.getPointXY(e);\n        };\n    };\n    Scroll.prototype.getPointXY = function (e) {\n        var pageXY = { x: 0, y: 0 };\n        if (e.touches && e.touches.length) {\n            pageXY.x = e.touches[0].pageX;\n            pageXY.y = e.touches[0].pageY;\n        }\n        else {\n            pageXY.x = e.pageX;\n            pageXY.y = e.pageY;\n        }\n        return pageXY;\n    };\n    Scroll.prototype.getScrollbleParent = function (node) {\n        if (node === null) {\n            return null;\n        }\n        var parent = isNullOrUndefined(node.tagName) ? node.scrollingElement : node;\n        var overflowY = document.defaultView.getComputedStyle(parent, null).overflowY;\n        if (parent.scrollHeight > parent.clientHeight && overflowY !== 'hidden'\n            && overflowY !== 'visible' || node.tagName === \"HTML\" || node.tagName === \"BODY\") {\n            return node;\n        }\n        else {\n            return this.getScrollbleParent(node.parentNode);\n        }\n    };\n    /**\n     * @param {boolean} isAdd - specifies whether adding/removing the event\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.addStickyListener = function (isAdd) {\n        this.parentElement = this.getScrollbleParent(this.parent.element.parentElement);\n        if (isAdd) {\n            if (this.parentElement) {\n                EventHandler.add(this.parentElement.tagName === 'HTML' || this.parentElement.tagName === 'BODY' ? document :\n                    this.parentElement, 'scroll', this.makeStickyHeader, this);\n            }\n        }\n        else {\n            EventHandler.remove(this.parentElement, 'scroll', this.makeStickyHeader);\n        }\n    };\n    Scroll.prototype.wireEvents = function () {\n        var _this = this;\n        if (this.oneTimeReady) {\n            var frzCols = this.parent.isFrozenGrid();\n            this.content = this.parent.getContent().querySelector('.' + literals.content);\n            this.header = this.parent.getHeaderContent().querySelector('.' + literals.headerContent);\n            var mCont = this.content.querySelector('.' + literals.movableContent);\n            var mHdr = this.header.querySelector('.' + literals.movableHeader);\n            var mScrollBar = this.parent.getContent().querySelector('.e-movablescrollbar');\n            if (this.parent.frozenRows) {\n                EventHandler.add(frzCols ? mHdr : this.header, 'touchstart pointerdown', this.setPageXY(), this);\n                EventHandler.add(frzCols ? mHdr : this.header, 'touchmove pointermove', this.onTouchScroll(frzCols ? mCont : this.content), this);\n            }\n            if (this.parent.isFrozenGrid()) {\n                EventHandler.add(mScrollBar, 'scroll', this.onCustomScrollbarScroll(mCont, mHdr), this);\n                EventHandler.add(mCont, 'scroll', this.onCustomScrollbarScroll(mScrollBar, mHdr), this);\n                EventHandler.add(mHdr, 'scroll', this.onCustomScrollbarScroll(mScrollBar, mCont), this);\n                EventHandler.add(this.content, 'scroll', this.onFrozenContentScroll(), this);\n                EventHandler.add(mHdr, 'touchstart pointerdown', this.setPageXY(), this);\n                EventHandler.add(mHdr, 'touchmove pointermove', this.onTouchScroll(mCont), this);\n                EventHandler.add(mCont, 'touchstart pointerdown', this.setPageXY(), this);\n                if (!(/macintosh|ipad/.test(Browser.userAgent.toLowerCase()) && Browser.isDevice)) {\n                    EventHandler.add(mCont, 'touchmove pointermove', this.onTouchScroll(mHdr), this);\n                }\n            }\n            else {\n                EventHandler.add(this.content, 'scroll', this.onContentScroll(this.header), this);\n                EventHandler.add(this.header, 'scroll', this.onContentScroll(this.content), this);\n            }\n            if (this.parent.aggregates.length) {\n                EventHandler.add(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll(this.content), this);\n            }\n            if (this.parent.enableStickyHeader) {\n                this.addStickyListener(true);\n            }\n            this.refresh();\n            this.oneTimeReady = false;\n        }\n        var table = this.parent.getContentTable();\n        var sLeft;\n        var sHeight;\n        var clientHeight;\n        getUpdateUsingRaf(function () {\n            sLeft = _this.header.scrollLeft;\n            sHeight = table.scrollHeight;\n            clientHeight = _this.parent.getContent().clientHeight;\n        }, function () {\n            var args = { cancel: false };\n            _this.parent.notify(checkScrollReset, args);\n            if (!_this.parent.enableVirtualization && !_this.parent.enableInfiniteScrolling) {\n                if (sHeight < clientHeight) {\n                    addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                    if (_this.parent.isFrozenGrid()) {\n                        addClass(_this.parent.getContent().querySelector('.' + literals.movableContent).querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                        if (_this.parent.getFrozenRightColumnsCount()) {\n                            addClass(_this.parent.getContent().querySelector('.e-frozen-right-content').querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                        }\n                    }\n                }\n                if (!args.cancel) {\n                    if ((_this.parent.frozenRows > 0 || _this.parent.isFrozenGrid()) && _this.header.querySelector('.' + literals.movableHeader)) {\n                        _this.header.querySelector('.' + literals.movableHeader).scrollLeft = _this.previousValues.left;\n                    }\n                    else {\n                        _this.header.scrollLeft = _this.previousValues.left;\n                    }\n                    _this.content.scrollLeft = _this.previousValues.left;\n                    _this.content.scrollTop = _this.previousValues.top;\n                }\n            }\n            if (!_this.parent.enableColumnVirtualization) {\n                _this.content.scrollLeft = sLeft;\n            }\n            if (_this.parent.isFrozenGrid() && _this.header.querySelector('.' + literals.movableHeader)) {\n                _this.header.querySelector('.' + literals.movableHeader).scrollLeft =\n                    _this.content.querySelector('.' + literals.movableContent).scrollLeft;\n            }\n        });\n        this.parent.isPreventScrollEvent = false;\n    };\n    /**\n     * @param {boolean} rtl - specifies the rtl\n     * @returns {ScrollCss} returns the ScrollCss\n     * @hidden\n     */\n    Scroll.prototype.getCssProperties = function (rtl) {\n        var css = {};\n        var enableRtl = isNullOrUndefined(rtl) ? this.parent.enableRtl : rtl;\n        css.border = enableRtl ? 'borderLeftWidth' : 'borderRightWidth';\n        css.padding = enableRtl ? 'paddingLeft' : 'paddingRight';\n        return css;\n    };\n    Scroll.prototype.ensureOverflow = function (content) {\n        content.style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n    };\n    Scroll.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        this.setPadding();\n        this.oneTimeReady = true;\n        if (this.parent.height === 'auto') {\n            this.removePadding();\n        }\n        this.wireEvents();\n        this.setHeight();\n        var width = 'width';\n        this.setWidth(!isNullOrUndefined(e.properties[width]));\n    };\n    Scroll.prototype.makeStickyHeader = function () {\n        if (this.parent.enableStickyHeader && this.parent.element && this.parent.getContent()) {\n            var contentRect = this.parent.getContent().getClientRects()[0];\n            if (contentRect) {\n                var headerEle = this.parent.getHeaderContent();\n                var toolbarEle = this.parent.element.querySelector('.e-toolbar');\n                var groupHeaderEle = this.parent.element.querySelector('.e-groupdroparea');\n                var height = headerEle.offsetHeight + (toolbarEle ? toolbarEle.offsetHeight : 0) +\n                    (groupHeaderEle ? groupHeaderEle.offsetHeight : 0);\n                var parentTop = this.parentElement.getClientRects()[0].top;\n                var top_1 = contentRect.top - (parentTop < 0 ? 0 : parentTop);\n                var left = contentRect.left;\n                if (top_1 < height && contentRect.bottom > 0) {\n                    headerEle.classList.add('e-sticky');\n                    var elemTop = 0;\n                    if (groupHeaderEle && this.parent.groupSettings.showDropArea) {\n                        this.setSticky(groupHeaderEle, elemTop, contentRect.width, left, true);\n                        elemTop += groupHeaderEle.getClientRects()[0].height;\n                    }\n                    if (toolbarEle) {\n                        this.setSticky(toolbarEle, elemTop, contentRect.width, left, true);\n                        elemTop += toolbarEle.getClientRects()[0].height;\n                    }\n                    this.setSticky(headerEle, elemTop, contentRect.width, left, true);\n                }\n                else {\n                    if (headerEle.classList.contains('e-sticky')) {\n                        this.setSticky(headerEle, null, null, null, false);\n                        if (toolbarEle) {\n                            this.setSticky(toolbarEle, null, null, null, false);\n                        }\n                        if (groupHeaderEle) {\n                            this.setSticky(groupHeaderEle, null, null, null, false);\n                        }\n                        var ccDlg = this.parent.element.querySelector('.e-ccdlg');\n                        if (ccDlg) {\n                            ccDlg.classList.remove('e-sticky');\n                        }\n                    }\n                }\n                this.parent.notify(events.stickyScrollComplete, {});\n            }\n        }\n    };\n    Scroll.prototype.setSticky = function (ele, top, width, left, isAdd) {\n        if (isAdd) {\n            ele.style.width = width + 'px';\n            ele.classList.add('e-sticky');\n        }\n        else {\n            ele.classList.remove('e-sticky');\n        }\n        ele.style.top = top != null ? top + 'px' : '';\n        ele.style.left = left !== null ? parseInt(ele.style.left, 10) !== left ? left + 'px' : ele.style.left : '';\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Scroll.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.' + literals.gridHeader) && !gridElement.querySelector('.' + literals.gridContent))) {\n            return;\n        }\n        this.removeEventListener();\n        //Remove Dom event\n        var cont = this.parent.getContent().querySelector('.' + literals.content);\n        EventHandler.remove(cont, 'scroll', this.onContentScroll);\n        if (this.parent.enableStickyHeader) {\n            this.addStickyListener(false);\n        }\n        //Remove padding\n        this.removePadding();\n        removeClass([this.parent.getHeaderContent().querySelector('.' + literals.headerContent)], literals.headerContent);\n        removeClass([cont], literals.content);\n        //Remove height\n        cont.style.height = '';\n        //Remove width\n        this.parent.element.style.width = '';\n    };\n    /**\n     * Function to get the scrollbar width of the browser.\n     *\n     * @returns {number} return the width\n     * @hidden\n     */\n    Scroll.getScrollBarWidth = function () {\n        return getScrollBarWidth();\n    };\n    return Scroll;\n}());\nexport { Scroll };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}