{"ast":null,"code":"import { remove, resetBlazorTemplate, blazorTemplates, getValue } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Deferred, Predicate, DataUtil } from '@syncfusion/ej2-data';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { RenderType, CellType } from '../base/enum';\nimport { Data } from '../actions/data';\nimport { Column } from '../models/column';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport * as events from '../base/constant';\nimport { prepareColumns, setFormatter, isGroupAdaptive, getDatePredicate, getObject, clearReactVueTemplates } from '../base/util';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { HeaderRender } from '../renderer/header-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { HeaderCellRenderer } from '../renderer/header-cell-renderer';\nimport { StackedHeaderCellRenderer } from '../renderer/stacked-cell-renderer';\nimport { IndentCellRenderer } from '../renderer/indent-cell-renderer';\nimport { GroupCaptionCellRenderer, GroupCaptionEmptyCellRenderer } from '../renderer/caption-cell-renderer';\nimport { ExpandCellRenderer } from '../renderer/expand-cell-renderer';\nimport { HeaderIndentCellRenderer } from '../renderer/header-indent-renderer';\nimport { DetailHeaderIndentCellRenderer } from '../renderer/detail-header-indent-renderer';\nimport { DetailExpandCellRenderer } from '../renderer/detail-expand-cell-renderer';\nimport { RowDragDropRenderer } from './row-drag-drop-renderer';\nimport { RowDragDropHeaderRenderer } from '../renderer/row-drag-header-indent-render';\nimport * as literals from '../base/string-literals';\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar Render = /** @class */function () {\n  /**\n   * Constructor for render module\n   *\n   * @param {IGrid} parent - specifies the IGrid\n   * @param {ServiceLocator} locator - specifies the serviceLocator\n   */\n  function Render(parent, locator) {\n    this.emptyGrid = false;\n    this.counter = 0;\n    this.parent = parent;\n    this.locator = locator;\n    this.data = new Data(parent, locator);\n    this.l10n = locator.getService('localization');\n    this.ariaService = this.locator.getService('ariaService');\n    this.renderer = this.locator.getService('rendererFactory');\n    this.addEventListener();\n  }\n  /**\n   * To initialize grid header, content and footer rendering\n   *\n   * @returns {void}\n   */\n  Render.prototype.render = function () {\n    var gObj = this.parent;\n    this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n    this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n    this.headerRenderer.renderPanel();\n    this.contentRenderer.renderPanel();\n    if (gObj.getColumns().length) {\n      this.isLayoutRendered = true;\n      this.headerRenderer.renderTable();\n      this.contentRenderer.renderTable();\n      this.emptyRow(false);\n    }\n    this.parent.scrollModule.setWidth();\n    this.parent.scrollModule.setHeight();\n    if (this.parent.height !== 'auto') {\n      this.parent.scrollModule.setPadding();\n    }\n    this.refreshDataManager();\n  };\n  /**\n   * Refresh the entire Grid.\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   */\n  Render.prototype.refresh = function (e) {\n    var _this = this;\n    if (e === void 0) {\n      e = {\n        requestType: 'refresh'\n      };\n    }\n    var gObj = this.parent;\n    gObj.notify(e.requestType + \"-begin\", e);\n    gObj.trigger(events.actionBegin, e, function (args) {\n      if (args === void 0) {\n        args = {\n          requestType: 'refresh'\n        };\n      }\n      if (args.cancel) {\n        gObj.notify(events.cancelBegin, args);\n        return;\n      }\n      if (args.requestType === 'delete' && gObj.allowPaging) {\n        var dataLength = args.data.length;\n        var count = gObj.pageSettings.totalRecordsCount - dataLength;\n        var currentViewData = gObj.getCurrentViewRecords().length;\n        // eslint-disable-next-line max-len\n        if (!(currentViewData - dataLength) && count && (gObj.pageSettings.currentPage - 1) * gObj.pageSettings.pageSize === count) {\n          gObj.prevPageMoving = true;\n          gObj.setProperties({\n            pageSettings: {\n              totalRecordsCount: count,\n              currentPage: Math.ceil(count / gObj.pageSettings.pageSize)\n            }\n          }, true);\n          gObj.pagerModule.pagerObj.totalRecordsCount = count;\n        }\n      }\n      if (args.requestType === 'reorder' && _this.parent.dataSource && 'result' in _this.parent.dataSource) {\n        _this.contentRenderer.refreshContentRows(args);\n      } else if ((args.requestType === 'paging' || args.requestType === 'columnstate' || args.requestType === 'reorder') && _this.parent.groupSettings.enableLazyLoading && _this.parent.groupSettings.columns.length && _this.parent.contentModule.getGroupCache()[_this.parent.pageSettings.currentPage]) {\n        _this.contentRenderer.refreshContentRows(args);\n      } else {\n        _this.refreshDataManager(args);\n      }\n    });\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.resetTemplates = function () {\n    var gObj = this.parent;\n    var gridColumns = gObj.getColumns();\n    if (gObj.detailTemplate) {\n      var detailTemplateID = gObj.element.id + 'detailTemplate';\n      blazorTemplates[detailTemplateID] = [];\n      resetBlazorTemplate(detailTemplateID, 'DetailTemplate');\n    }\n    if (gObj.groupSettings.captionTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'captionTemplate', 'CaptionTemplate');\n    }\n    if (gObj.rowTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate');\n    }\n    if (gObj.toolbarTemplate) {\n      resetBlazorTemplate(gObj.element.id + 'toolbarTemplate', 'ToolbarTemplate');\n    }\n    if (gObj.pageSettings.template) {\n      resetBlazorTemplate(gObj.element.id + '_template', 'pageSettings');\n    }\n    for (var i = 0; i < gridColumns.length; i++) {\n      if (gridColumns[i].template) {\n        blazorTemplates[gObj.element.id + gridColumns[i].uid] = [];\n        resetBlazorTemplate(gObj.element.id + gridColumns[i].uid, 'Template');\n      }\n      if (gridColumns[i].headerTemplate) {\n        resetBlazorTemplate(gObj.element.id + gridColumns[i].uid + 'headerTemplate', 'HeaderTemplate');\n      }\n      if (gridColumns[i].filterTemplate) {\n        resetBlazorTemplate(gObj.element.id + gridColumns[i].uid + 'filterTemplate', 'FilterTemplate');\n      }\n    }\n    var guid = 'guid';\n    for (var k = 0; k < gObj.aggregates.length; k++) {\n      for (var j = 0; j < gObj.aggregates[k].columns.length; j++) {\n        if (gObj.aggregates[k].columns[j].footerTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'footerTemplate';\n          resetBlazorTemplate(tempID, 'FooterTemplate');\n        }\n        if (gObj.aggregates[k].columns[j].groupFooterTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'groupFooterTemplate';\n          resetBlazorTemplate(tempID, 'GroupFooterTemplate');\n        }\n        if (gObj.aggregates[k].columns[j].groupCaptionTemplate) {\n          var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'groupCaptionTemplate';\n          resetBlazorTemplate(tempID, 'GroupCaptionTemplate');\n        }\n      }\n    }\n  };\n  Render.prototype.refreshComplete = function (e) {\n    this.parent.trigger(events.actionComplete, e);\n  };\n  /**\n   * The function is used to refresh the dataManager\n   *\n   * @param {NotifyArgs} args - specifies the args\n   * @returns {void}\n   */\n  Render.prototype.refreshDataManager = function (args) {\n    var _this = this;\n    if (args === void 0) {\n      args = {};\n    }\n    if (args.requestType !== 'virtualscroll' && !args.isCaptionCollapse) {\n      this.parent.showSpinner();\n    }\n    this.parent.notify(events.resetInfiniteBlocks, args);\n    this.emptyGrid = false;\n    var dataManager;\n    var isFActon = this.isNeedForeignAction();\n    this.ariaService.setBusy(this.parent.getContent().querySelector('.' + literals.content), true);\n    if (isFActon) {\n      var deffered = new Deferred();\n      dataManager = this.getFData(deffered, args);\n    }\n    if (!dataManager) {\n      dataManager = this.data.getData(args, this.data.generateQuery().requiresCount());\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      dataManager = dataManager.then(function (e) {\n        var query = _this.data.generateQuery().requiresCount();\n        if (_this.emptyGrid) {\n          var def = new Deferred();\n          def.resolve({\n            result: [],\n            count: 0\n          });\n          return def.promise;\n        }\n        return _this.data.getData(args, query);\n      });\n    }\n    if (this.parent.getForeignKeyColumns().length && (!isFActon || this.parent.searchSettings.key.length)) {\n      var deffered_1 = new Deferred();\n      dataManager = dataManager.then(function (e) {\n        _this.parent.notify(events.getForeignKeyData, {\n          dataManager: dataManager,\n          result: e,\n          promise: deffered_1,\n          action: args\n        });\n        return deffered_1.promise;\n      });\n    }\n    if (this.parent.groupSettings.disablePageWiseAggregates && this.parent.groupSettings.columns.length) {\n      dataManager = dataManager.then(function (e) {\n        return _this.validateGroupRecords(e);\n      });\n    }\n    dataManager.then(function (e) {\n      return _this.dataManagerSuccess(e, args);\n    }).catch(function (e) {\n      return _this.dataManagerFailure(e, args);\n    });\n  };\n  Render.prototype.getFData = function (deferred, args) {\n    this.parent.notify(events.getForeignKeyData, {\n      isComplex: true,\n      promise: deferred,\n      action: args\n    });\n    return deferred.promise;\n  };\n  Render.prototype.isNeedForeignAction = function () {\n    var gObj = this.parent;\n    return !!(gObj.allowFiltering && gObj.filterSettings.columns.length || gObj.searchSettings.key.length) && this.foreignKey(this.parent.getForeignKeyColumns());\n  };\n  Render.prototype.foreignKey = function (columns) {\n    var _this = this;\n    return columns.some(function (col) {\n      var fbool = false;\n      fbool = _this.parent.filterSettings.columns.some(function (value) {\n        return col.uid === value.uid;\n      });\n      return !!(fbool || _this.parent.searchSettings.key.length);\n    });\n  };\n  Render.prototype.sendBulkRequest = function (args) {\n    var _this = this;\n    args.requestType = 'batchsave';\n    var promise = this.data.saveChanges(args.changes, this.parent.getPrimaryKeyFieldNames()[0], args.original);\n    var query = this.data.generateQuery().requiresCount();\n    if (this.data.dataManager.dataSource.offline) {\n      this.refreshDataManager({\n        requestType: 'batchsave'\n      });\n      return;\n    } else {\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      promise.then(function (e) {\n        _this.data.getData(args, query).then(function (e) {\n          return _this.dmSuccess(e, args);\n        }).catch(function (e) {\n          return _this.dmFailure(e, args);\n        });\n      }).catch(function (e) {\n        return _this.dmFailure(e, args);\n      });\n    }\n  };\n  Render.prototype.dmSuccess = function (e, args) {\n    this.dataManagerSuccess(e, args);\n  };\n  Render.prototype.dmFailure = function (e, args) {\n    this.dataManagerFailure(e, args);\n  };\n  /**\n   * Render empty row to Grid which is used at the time to represent to no records.\n   *\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.renderEmptyRow = function () {\n    this.emptyRow(true);\n  };\n  Render.prototype.emptyRow = function (isTrigger) {\n    var gObj = this.parent;\n    var tbody = this.contentRenderer.getTable().querySelector(literals.tbody);\n    if (!isNullOrUndefined(tbody)) {\n      remove(tbody);\n    }\n    tbody = this.parent.createElement(literals.tbody);\n    var spanCount = 0;\n    if (gObj.detailTemplate || gObj.childGrid) {\n      ++spanCount;\n    }\n    var tr = this.parent.createElement('tr', {\n      className: 'e-emptyrow'\n    });\n    tr.appendChild(this.parent.createElement('td', {\n      innerHTML: this.l10n.getConstant('EmptyRecord'),\n      attrs: {\n        colspan: (gObj.getVisibleColumns().length + spanCount + gObj.groupSettings.columns.length).toString()\n      }\n    }));\n    tbody.appendChild(tr);\n    this.contentRenderer.renderEmpty(tbody);\n    if (isTrigger) {\n      this.parent.trigger(events.dataBound, {});\n      this.parent.notify(events.onEmpty, {\n        rows: [new Row({\n          isDataRow: true,\n          cells: [new Cell({\n            isDataCell: true,\n            visible: true\n          })]\n        })]\n      });\n    }\n  };\n  Render.prototype.dynamicColumnChange = function () {\n    if (this.parent.getCurrentViewRecords().length) {\n      this.updateColumnType(this.parent.getCurrentViewRecords()[0]);\n    }\n  };\n  Render.prototype.updateColumnType = function (record) {\n    var columns = this.parent.getColumns();\n    var value;\n    var cFormat = 'customFormat';\n    var equalTo = 'equalTo';\n    var data = record && record.items ? record.items[0] : record;\n    var fmtr = this.locator.getService('valueFormatter');\n    for (var i = 0, len = columns.length; i < len; i++) {\n      value = getObject(columns[i].field || '', data);\n      if (!isNullOrUndefined(columns[i][cFormat])) {\n        columns[i].format = columns[i][cFormat];\n      }\n      if (!isNullOrUndefined(columns[i].validationRules) && !isNullOrUndefined(columns[i].validationRules[equalTo])) {\n        columns[i].validationRules[equalTo][0] = this.parent.element.id + columns[i].validationRules[equalTo][0];\n      }\n      if (columns[i].isForeignColumn() && columns[i].columnData) {\n        value = getObject(columns[i].foreignKeyValue || '', columns[i].columnData[0]);\n      }\n      if (!isNullOrUndefined(value)) {\n        this.isColTypeDef = true;\n        if (!columns[i].type) {\n          columns[i].type = value.getDay ? value.getHours() > 0 || value.getMinutes() > 0 || value.getSeconds() > 0 || value.getMilliseconds() > 0 ? 'datetime' : 'date' : typeof value;\n        }\n      } else {\n        columns[i].type = columns[i].type || null;\n      }\n      var valueFormatter = new ValueFormatter();\n      if (columns[i].format && (columns[i].format.skeleton || columns[i].format.format && typeof columns[i].format.format === 'string')) {\n        columns[i].setFormatter(valueFormatter.getFormatFunction(extend({}, columns[i].format)));\n        columns[i].setParser(valueFormatter.getParserFunction(columns[i].format));\n      }\n      if (typeof columns[i].format === 'string') {\n        setFormatter(this.locator, columns[i]);\n      } else if (!columns[i].format && columns[i].type === 'number') {\n        columns[i].setParser(fmtr.getParserFunction({\n          format: 'n2'\n        }));\n      }\n    }\n  };\n  /**\n   * @param {ReturnType} e - specifies the return type\n   * @param {NotifyArgs} args - specifies the Notifyargs\n   * @returns {void}\n   * @hidden\n   */\n  // tslint:disable-next-line:max-func-body-length\n  Render.prototype.dataManagerSuccess = function (e, args) {\n    var _this = this;\n    var gObj = this.parent;\n    this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n    this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n    e.actionArgs = args;\n    var isInfiniteDelete = this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && (args.requestType === 'delete' || args.requestType === 'save' && this.parent.infiniteScrollModule.requestType === 'add');\n    // tslint:disable-next-line:max-func-body-length\n    gObj.trigger(events.beforeDataBound, e, function (dataArgs) {\n      if (dataArgs.cancel) {\n        return;\n      }\n      dataArgs.result = isNullOrUndefined(dataArgs.result) ? [] : dataArgs.result;\n      var len = Object.keys(dataArgs.result).length;\n      if (_this.parent.isDestroyed) {\n        return;\n      }\n      if (!gObj.getColumns().length && !len && !(gObj.columns.length && gObj.columns[0] instanceof Column)) {\n        gObj.hideSpinner();\n        return;\n      }\n      if (_this.isInfiniteEnd(args) && !len) {\n        _this.parent.notify(events.infiniteEditHandler, {\n          e: args,\n          result: e.result,\n          count: e.count,\n          agg: e.aggregates\n        });\n        return;\n      }\n      _this.parent.isEdit = false;\n      _this.parent.notify(events.editReset, {});\n      _this.parent.notify(events.tooltipDestroy, {});\n      _this.contentRenderer.prevCurrentView = _this.parent.currentViewData.slice();\n      gObj.currentViewData = dataArgs.result;\n      gObj.notify(events.refreshInfiniteCurrentViewData, {\n        args: args,\n        data: dataArgs.result\n      });\n      if (!len && dataArgs.count && gObj.allowPaging && args && args.requestType !== 'delete') {\n        if (_this.parent.groupSettings.enableLazyLoading && (args.requestType === 'grouping' || args.requestType === 'ungrouping')) {\n          _this.parent.notify(events.groupComplete, args);\n        }\n        gObj.prevPageMoving = true;\n        gObj.pageSettings.totalRecordsCount = dataArgs.count;\n        if (args.requestType !== 'paging') {\n          gObj.pageSettings.currentPage = Math.ceil(dataArgs.count / gObj.pageSettings.pageSize);\n        }\n        gObj.dataBind();\n        return;\n      }\n      if ((!gObj.getColumns().length && len || !_this.isLayoutRendered) && !isGroupAdaptive(gObj)) {\n        _this.updatesOnInitialRender(dataArgs);\n      }\n      if (!_this.isColTypeDef && gObj.getCurrentViewRecords()) {\n        if (_this.data.dataManager.dataSource.offline && gObj.dataSource && gObj.dataSource.length) {\n          _this.updateColumnType(gObj.dataSource[0]);\n        } else {\n          _this.updateColumnType(gObj.getCurrentViewRecords()[0]);\n        }\n      }\n      if (!_this.parent.isInitialLoad && _this.parent.groupSettings.disablePageWiseAggregates && !_this.parent.groupSettings.columns.length) {\n        dataArgs.result = _this.parent.dataSource instanceof Array ? _this.parent.dataSource : _this.parent.currentViewData;\n      }\n      if ((_this.parent.isReact || _this.parent.isVue) && !isNullOrUndefined(args) && args.requestType !== 'infiniteScroll' && !args.isFrozen) {\n        clearReactVueTemplates(_this.parent, ['footerTemplate']);\n      }\n      _this.parent.notify(events.dataReady, extend({\n        count: dataArgs.count,\n        result: dataArgs.result,\n        aggregates: dataArgs.aggregates\n      }, args));\n      if ((gObj.groupSettings.columns.length || args && args.requestType === 'ungrouping') && args && args.requestType !== 'filtering') {\n        _this.headerRenderer.refreshUI();\n      }\n      if (len) {\n        if (isGroupAdaptive(gObj)) {\n          var content = 'content';\n          args.scrollTop = {\n            top: _this.contentRenderer[content].scrollTop\n          };\n        }\n        if (!isInfiniteDelete) {\n          if (_this.parent.enableImmutableMode) {\n            _this.contentRenderer.immutableModeRendering(args);\n          } else {\n            _this.contentRenderer.refreshContentRows(args);\n          }\n        } else {\n          _this.parent.notify(events.infiniteEditHandler, {\n            e: args,\n            result: e.result,\n            count: e.count,\n            agg: e.aggregates\n          });\n        }\n      } else {\n        if (args && args.isCaptionCollapse) {\n          return;\n        }\n        if (!gObj.getColumns().length) {\n          gObj.element.innerHTML = '';\n          alert(_this.l10n.getConstant('EmptyDataSourceError')); //ToDO: change this alert as dialog\n          return;\n        }\n        _this.contentRenderer.setRowElements([]);\n        _this.contentRenderer.setRowObjects([]);\n        _this.ariaService.setBusy(_this.parent.getContent().querySelector('.' + literals.content), false);\n        _this.renderEmptyRow();\n        if (args) {\n          var action = (args.requestType || '').toLowerCase() + '-complete';\n          _this.parent.notify(action, args);\n          if (args.requestType === 'batchsave') {\n            args.cancel = false;\n            args.rows = [];\n            args.isFrozen = _this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n            _this.parent.trigger(events.actionComplete, args);\n          }\n        }\n        _this.parent.hideSpinner();\n      }\n      _this.parent.notify(events.toolbarRefresh, {});\n      _this.setRowCount(_this.parent.getCurrentViewRecords().length);\n      _this.parent.getDataModule().isQueryInvokedFromData = false;\n    });\n  };\n  /**\n   * @param {object} e - specifies the object\n   * @param {Object[]} e.result - specifies the result\n   * @param {NotifyArgs} args - specifies the args\n   * @returns {void}\n   * @hidden\n   */\n  Render.prototype.dataManagerFailure = function (e, args) {\n    this.ariaService.setOptions(this.parent.getContent().querySelector('.' + literals.content), {\n      busy: false,\n      invalid: true\n    });\n    this.setRowCount(1);\n    this.parent.trigger(events.actionFailure, {\n      error: e\n    });\n    this.parent.hideSpinner();\n    if (args.requestType === 'save' || args.requestType === 'delete' || args.name === 'bulk-save') {\n      return;\n    }\n    this.parent.currentViewData = [];\n    this.renderEmptyRow();\n    this.parent.log('actionfailure', {\n      error: e\n    });\n  };\n  Render.prototype.setRowCount = function (dataRowCount) {\n    this.ariaService.setOptions(this.parent.getHeaderTable(), {\n      rowcount: dataRowCount ? dataRowCount.toString() : '1'\n    });\n  };\n  Render.prototype.isInfiniteEnd = function (args) {\n    return this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && args.requestType === 'delete';\n  };\n  Render.prototype.updatesOnInitialRender = function (e) {\n    this.isLayoutRendered = true;\n    if (this.parent.columns.length < 1) {\n      this.buildColumns(e.result[0]);\n    }\n    prepareColumns(this.parent.columns, null, this.parent);\n    this.headerRenderer.renderTable();\n    this.contentRenderer.renderTable();\n    this.parent.isAutoGen = true;\n    this.parent.notify(events.autoCol, {});\n  };\n  Render.prototype.iterateComplexColumns = function (obj, field, split) {\n    var keys = Object.keys(obj);\n    for (var i = 0; i < keys.length; i++) {\n      var childKeys = typeof obj[keys[i]] === 'object' && obj[keys[i]] && !(obj[keys[i]] instanceof Date) ? Object.keys(obj[keys[i]]) : [];\n      if (childKeys.length) {\n        this.iterateComplexColumns(obj[keys[i]], field + (keys[i] + '.'), split);\n      } else {\n        split[this.counter] = field + keys[i];\n        this.counter++;\n      }\n    }\n  };\n  Render.prototype.buildColumns = function (record) {\n    var cols = [];\n    var complexCols = {};\n    this.iterateComplexColumns(record, '', complexCols);\n    var columns = Object.keys(complexCols).filter(function (e) {\n      return complexCols[e] !== 'BlazId';\n    }).map(function (field) {\n      return complexCols[field];\n    });\n    for (var i = 0, len = columns.length; i < len; i++) {\n      cols[i] = {\n        'field': columns[i]\n      };\n      if (this.parent.enableColumnVirtualization) {\n        cols[i].width = !isNullOrUndefined(cols[i].width) ? cols[i].width : 200;\n      }\n    }\n    this.parent.setProperties({\n      'columns': cols\n    }, true);\n  };\n  Render.prototype.instantiateRenderer = function () {\n    this.renderer.addRenderer(RenderType.Header, new HeaderRender(this.parent, this.locator));\n    this.renderer.addRenderer(RenderType.Content, new ContentRender(this.parent, this.locator));\n    var cellrender = this.locator.getService('cellRendererFactory');\n    cellrender.addCellRenderer(CellType.Header, new HeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Data, new CellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Indent, new IndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.GroupCaption, new GroupCaptionCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.GroupCaptionEmpty, new GroupCaptionEmptyCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.Expand, new ExpandCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.HeaderIndent, new HeaderIndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailHeader, new DetailHeaderIndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.RowDragHIcon, new RowDragDropHeaderRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailExpand, new DetailExpandCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.DetailFooterIntent, new IndentCellRenderer(this.parent, this.locator));\n    cellrender.addCellRenderer(CellType.RowDragIcon, new RowDragDropRenderer(this.parent, this.locator));\n  };\n  Render.prototype.addEventListener = function () {\n    var _this = this;\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n    this.parent.on('refreshdataSource', this.dataManagerSuccess, this);\n    this.parent.on(events.modelChanged, this.refresh, this);\n    this.parent.on(events.refreshComplete, this.refreshComplete, this);\n    this.parent.on(events.bulkSave, this.sendBulkRequest, this);\n    this.parent.on(events.showEmptyGrid, function () {\n      _this.emptyGrid = true;\n    }, this);\n    this.parent.on(events.autoCol, this.dynamicColumnChange, this);\n  };\n  /**\n   * @param {ReturnType} e - specifies the Return type\n   * @returns {Promise<Object>} returns the object\n   * @hidden\n   */\n  Render.prototype.validateGroupRecords = function (e) {\n    var _this = this;\n    var index = e.result.length - 1;\n    if (index < 0) {\n      return Promise.resolve(e);\n    }\n    var group0 = e.result[0];\n    var groupN = e.result[index];\n    var predicate = [];\n    var addWhere = function (input) {\n      var groups = [group0, groupN];\n      for (var i = 0; i < groups.length; i++) {\n        predicate.push(new Predicate('field', '==', groups[i].field).and(_this.getPredicate('key', 'equal', groups[i].key)));\n      }\n      input.where(Predicate.or(predicate));\n    };\n    var query = new Query();\n    addWhere(query);\n    var curDm = new DataManager(e.result);\n    var curFilter = curDm.executeLocal(query);\n    var newQuery = this.data.generateQuery(true);\n    var rPredicate = [];\n    if (this.data.isRemote()) {\n      var groups = [group0, groupN];\n      for (var i = 0; i < groups.length; i++) {\n        rPredicate.push(this.getPredicate(groups[i].field, 'equal', groups[i].key));\n      }\n      newQuery.where(Predicate.or(rPredicate));\n    } else {\n      addWhere(newQuery);\n    }\n    var deferred = new Deferred();\n    this.data.getData({}, newQuery).then(function (r) {\n      _this.updateGroupInfo(curFilter, r.result);\n      deferred.resolve(e);\n    }).catch(function (e) {\n      return deferred.reject(e);\n    });\n    return deferred.promise;\n  };\n  Render.prototype.getPredicate = function (key, operator, value) {\n    if (value instanceof Date) {\n      return getDatePredicate({\n        field: key,\n        operator: operator,\n        value: value\n      });\n    }\n    return new Predicate(key, operator, value);\n  };\n  Render.prototype.updateGroupInfo = function (current, untouched) {\n    var dm = new DataManager(untouched);\n    var elements = current;\n    for (var i = 0; i < elements.length; i++) {\n      var uGroup = dm.executeLocal(new Query().where(new Predicate('field', '==', elements[i].field).and(this.getPredicate('key', 'equal', elements[i].key))))[0];\n      elements[i].count = uGroup.count;\n      var itemGroup = elements[i].items;\n      var uGroupItem = uGroup.items;\n      if (itemGroup.GroupGuid) {\n        elements[i].items = this.updateGroupInfo(elements[i].items, uGroup.items);\n      }\n      var rows = this.parent.aggregates;\n      for (var j = 0; j < rows.length; j++) {\n        var row = rows[j];\n        for (var k = 0; k < row.columns.length; k++) {\n          var types = row.columns[k].type instanceof Array ? row.columns[k].type : [row.columns[k].type];\n          for (var l = 0; l < types.length; l++) {\n            var key = row.columns[k].field + ' - ' + types[l].toLowerCase();\n            var data = itemGroup.level ? uGroupItem.records : uGroup.items;\n            var context = this.parent;\n            if (types[l] === 'Custom') {\n              var data_1 = itemGroup.level ? uGroupItem : uGroup;\n              var temp = row.columns[k].customAggregate;\n              if (typeof temp === 'string') {\n                temp = getValue(temp, window);\n              }\n              elements[i].aggregates[key] = temp ? temp.call(context, data_1, row.columns[k]) : '';\n            } else {\n              // eslint-disable-next-line max-len\n              elements[i].aggregates[key] = DataUtil.aggregates[types[l].toLowerCase()](data, row.columns[k].field);\n            }\n          }\n        }\n      }\n    }\n    return current;\n  };\n  return Render;\n}();\nexport { Render };","map":{"version":3,"names":["remove","resetBlazorTemplate","blazorTemplates","getValue","isNullOrUndefined","extend","DataManager","Query","Deferred","Predicate","DataUtil","ValueFormatter","RenderType","CellType","Data","Column","Row","Cell","events","prepareColumns","setFormatter","isGroupAdaptive","getDatePredicate","getObject","clearReactVueTemplates","ContentRender","HeaderRender","CellRenderer","HeaderCellRenderer","StackedHeaderCellRenderer","IndentCellRenderer","GroupCaptionCellRenderer","GroupCaptionEmptyCellRenderer","ExpandCellRenderer","HeaderIndentCellRenderer","DetailHeaderIndentCellRenderer","DetailExpandCellRenderer","RowDragDropRenderer","RowDragDropHeaderRenderer","literals","Render","parent","locator","emptyGrid","counter","data","l10n","getService","ariaService","renderer","addEventListener","prototype","render","gObj","headerRenderer","getRenderer","Header","contentRenderer","Content","renderPanel","getColumns","length","isLayoutRendered","renderTable","emptyRow","scrollModule","setWidth","setHeight","height","setPadding","refreshDataManager","refresh","e","_this","requestType","notify","trigger","actionBegin","args","cancel","cancelBegin","allowPaging","dataLength","count","pageSettings","totalRecordsCount","currentViewData","getCurrentViewRecords","currentPage","pageSize","prevPageMoving","setProperties","Math","ceil","pagerModule","pagerObj","dataSource","refreshContentRows","groupSettings","enableLazyLoading","columns","contentModule","getGroupCache","resetTemplates","gridColumns","detailTemplate","detailTemplateID","element","id","captionTemplate","rowTemplate","toolbarTemplate","template","i","uid","headerTemplate","filterTemplate","guid","k","aggregates","j","footerTemplate","tempID","groupFooterTemplate","groupCaptionTemplate","refreshComplete","actionComplete","isCaptionCollapse","showSpinner","resetInfiniteBlocks","dataManager","isFActon","isNeedForeignAction","setBusy","getContent","querySelector","content","deffered","getFData","getData","generateQuery","requiresCount","then","query","def","resolve","result","promise","getForeignKeyColumns","searchSettings","key","deffered_1","getForeignKeyData","action","disablePageWiseAggregates","validateGroupRecords","dataManagerSuccess","catch","dataManagerFailure","deferred","isComplex","allowFiltering","filterSettings","foreignKey","some","col","fbool","value","sendBulkRequest","saveChanges","changes","getPrimaryKeyFieldNames","original","offline","dmSuccess","dmFailure","renderEmptyRow","isTrigger","tbody","getTable","createElement","spanCount","childGrid","tr","className","appendChild","innerHTML","getConstant","attrs","colspan","getVisibleColumns","toString","renderEmpty","dataBound","onEmpty","rows","isDataRow","cells","isDataCell","visible","dynamicColumnChange","updateColumnType","record","cFormat","equalTo","items","fmtr","len","field","format","validationRules","isForeignColumn","columnData","foreignKeyValue","isColTypeDef","type","getDay","getHours","getMinutes","getSeconds","getMilliseconds","valueFormatter","skeleton","getFormatFunction","setParser","getParserFunction","actionArgs","isInfiniteDelete","enableInfiniteScrolling","infiniteScrollSettings","enableCache","infiniteScrollModule","beforeDataBound","dataArgs","Object","keys","isDestroyed","hideSpinner","isInfiniteEnd","infiniteEditHandler","agg","isEdit","editReset","tooltipDestroy","prevCurrentView","slice","refreshInfiniteCurrentViewData","groupComplete","dataBind","updatesOnInitialRender","isInitialLoad","Array","isReact","isVue","isFrozen","dataReady","refreshUI","scrollTop","top","enableImmutableMode","immutableModeRendering","alert","setRowElements","setRowObjects","toLowerCase","getFrozenColumns","toolbarRefresh","setRowCount","getDataModule","isQueryInvokedFromData","setOptions","busy","invalid","actionFailure","error","name","log","dataRowCount","getHeaderTable","rowcount","buildColumns","isAutoGen","autoCol","iterateComplexColumns","obj","split","childKeys","Date","cols","complexCols","filter","map","enableColumnVirtualization","width","instantiateRenderer","addRenderer","cellrender","addCellRenderer","StackedHeader","Indent","GroupCaption","GroupCaptionEmpty","Expand","HeaderIndent","DetailHeader","RowDragHIcon","DetailExpand","DetailFooterIntent","RowDragIcon","on","initialLoad","modelChanged","bulkSave","showEmptyGrid","index","Promise","group0","groupN","predicate","addWhere","input","groups","push","and","getPredicate","where","or","curDm","curFilter","executeLocal","newQuery","rPredicate","isRemote","r","updateGroupInfo","reject","operator","current","untouched","dm","elements","uGroup","itemGroup","uGroupItem","GroupGuid","row","types","l","level","records","context","data_1","temp","customAggregate","window","call"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/renderer/render.js"],"sourcesContent":["import { remove, resetBlazorTemplate, blazorTemplates, getValue } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nimport { DataManager, Query, Deferred, Predicate, DataUtil } from '@syncfusion/ej2-data';\nimport { ValueFormatter } from '../services/value-formatter';\nimport { RenderType, CellType } from '../base/enum';\nimport { Data } from '../actions/data';\nimport { Column } from '../models/column';\nimport { Row } from '../models/row';\nimport { Cell } from '../models/cell';\nimport * as events from '../base/constant';\nimport { prepareColumns, setFormatter, isGroupAdaptive, getDatePredicate, getObject, clearReactVueTemplates } from '../base/util';\nimport { ContentRender } from '../renderer/content-renderer';\nimport { HeaderRender } from '../renderer/header-renderer';\nimport { CellRenderer } from '../renderer/cell-renderer';\nimport { HeaderCellRenderer } from '../renderer/header-cell-renderer';\nimport { StackedHeaderCellRenderer } from '../renderer/stacked-cell-renderer';\nimport { IndentCellRenderer } from '../renderer/indent-cell-renderer';\nimport { GroupCaptionCellRenderer, GroupCaptionEmptyCellRenderer } from '../renderer/caption-cell-renderer';\nimport { ExpandCellRenderer } from '../renderer/expand-cell-renderer';\nimport { HeaderIndentCellRenderer } from '../renderer/header-indent-renderer';\nimport { DetailHeaderIndentCellRenderer } from '../renderer/detail-header-indent-renderer';\nimport { DetailExpandCellRenderer } from '../renderer/detail-expand-cell-renderer';\nimport { RowDragDropRenderer } from './row-drag-drop-renderer';\nimport { RowDragDropHeaderRenderer } from '../renderer/row-drag-header-indent-render';\nimport * as literals from '../base/string-literals';\n/**\n * Content module is used to render grid content\n *\n * @hidden\n */\nvar Render = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     *\n     * @param {IGrid} parent - specifies the IGrid\n     * @param {ServiceLocator} locator - specifies the serviceLocator\n     */\n    function Render(parent, locator) {\n        this.emptyGrid = false;\n        this.counter = 0;\n        this.parent = parent;\n        this.locator = locator;\n        this.data = new Data(parent, locator);\n        this.l10n = locator.getService('localization');\n        this.ariaService = this.locator.getService('ariaService');\n        this.renderer = this.locator.getService('rendererFactory');\n        this.addEventListener();\n    }\n    /**\n     * To initialize grid header, content and footer rendering\n     *\n     * @returns {void}\n     */\n    Render.prototype.render = function () {\n        var gObj = this.parent;\n        this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n        this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n        this.headerRenderer.renderPanel();\n        this.contentRenderer.renderPanel();\n        if (gObj.getColumns().length) {\n            this.isLayoutRendered = true;\n            this.headerRenderer.renderTable();\n            this.contentRenderer.renderTable();\n            this.emptyRow(false);\n        }\n        this.parent.scrollModule.setWidth();\n        this.parent.scrollModule.setHeight();\n        if (this.parent.height !== 'auto') {\n            this.parent.scrollModule.setPadding();\n        }\n        this.refreshDataManager();\n    };\n    /**\n     * Refresh the entire Grid.\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     */\n    Render.prototype.refresh = function (e) {\n        var _this = this;\n        if (e === void 0) { e = { requestType: 'refresh' }; }\n        var gObj = this.parent;\n        gObj.notify(e.requestType + \"-begin\", e);\n        gObj.trigger(events.actionBegin, e, function (args) {\n            if (args === void 0) { args = { requestType: 'refresh' }; }\n            if (args.cancel) {\n                gObj.notify(events.cancelBegin, args);\n                return;\n            }\n            if (args.requestType === 'delete' && gObj.allowPaging) {\n                var dataLength = args.data.length;\n                var count = gObj.pageSettings.totalRecordsCount - dataLength;\n                var currentViewData = gObj.getCurrentViewRecords().length;\n                // eslint-disable-next-line max-len\n                if (!(currentViewData - dataLength) && count && ((gObj.pageSettings.currentPage - 1) * gObj.pageSettings.pageSize) === count) {\n                    gObj.prevPageMoving = true;\n                    gObj.setProperties({\n                        pageSettings: {\n                            totalRecordsCount: count, currentPage: Math.ceil(count / gObj.pageSettings.pageSize)\n                        }\n                    }, true);\n                    gObj.pagerModule.pagerObj.totalRecordsCount = count;\n                }\n            }\n            if (args.requestType === 'reorder' && _this.parent.dataSource && 'result' in _this.parent.dataSource) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else if ((args.requestType === 'paging' || args.requestType === 'columnstate' || args.requestType === 'reorder')\n                && _this.parent.groupSettings.enableLazyLoading && _this.parent.groupSettings.columns.length\n                && _this.parent.contentModule.getGroupCache()[_this.parent.pageSettings.currentPage]) {\n                _this.contentRenderer.refreshContentRows(args);\n            }\n            else {\n                _this.refreshDataManager(args);\n            }\n        });\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.resetTemplates = function () {\n        var gObj = this.parent;\n        var gridColumns = gObj.getColumns();\n        if (gObj.detailTemplate) {\n            var detailTemplateID = gObj.element.id + 'detailTemplate';\n            blazorTemplates[detailTemplateID] = [];\n            resetBlazorTemplate(detailTemplateID, 'DetailTemplate');\n        }\n        if (gObj.groupSettings.captionTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'captionTemplate', 'CaptionTemplate');\n        }\n        if (gObj.rowTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'rowTemplate', 'RowTemplate');\n        }\n        if (gObj.toolbarTemplate) {\n            resetBlazorTemplate(gObj.element.id + 'toolbarTemplate', 'ToolbarTemplate');\n        }\n        if (gObj.pageSettings.template) {\n            resetBlazorTemplate(gObj.element.id + '_template', 'pageSettings');\n        }\n        for (var i = 0; i < gridColumns.length; i++) {\n            if (gridColumns[i].template) {\n                blazorTemplates[gObj.element.id + gridColumns[i].uid] = [];\n                resetBlazorTemplate(gObj.element.id + gridColumns[i].uid, 'Template');\n            }\n            if (gridColumns[i].headerTemplate) {\n                resetBlazorTemplate(gObj.element.id + gridColumns[i].uid + 'headerTemplate', 'HeaderTemplate');\n            }\n            if (gridColumns[i].filterTemplate) {\n                resetBlazorTemplate(gObj.element.id + gridColumns[i].uid + 'filterTemplate', 'FilterTemplate');\n            }\n        }\n        var guid = 'guid';\n        for (var k = 0; k < gObj.aggregates.length; k++) {\n            for (var j = 0; j < gObj.aggregates[k].columns.length; j++) {\n                if (gObj.aggregates[k].columns[j].footerTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'footerTemplate';\n                    resetBlazorTemplate(tempID, 'FooterTemplate');\n                }\n                if (gObj.aggregates[k].columns[j].groupFooterTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'groupFooterTemplate';\n                    resetBlazorTemplate(tempID, 'GroupFooterTemplate');\n                }\n                if (gObj.aggregates[k].columns[j].groupCaptionTemplate) {\n                    var tempID = gObj.element.id + gObj.aggregates[k].columns[j][guid] + 'groupCaptionTemplate';\n                    resetBlazorTemplate(tempID, 'GroupCaptionTemplate');\n                }\n            }\n        }\n    };\n    Render.prototype.refreshComplete = function (e) {\n        this.parent.trigger(events.actionComplete, e);\n    };\n    /**\n     * The function is used to refresh the dataManager\n     *\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     */\n    Render.prototype.refreshDataManager = function (args) {\n        var _this = this;\n        if (args === void 0) { args = {}; }\n        if (args.requestType !== 'virtualscroll' && !args.isCaptionCollapse) {\n            this.parent.showSpinner();\n        }\n        this.parent.notify(events.resetInfiniteBlocks, args);\n        this.emptyGrid = false;\n        var dataManager;\n        var isFActon = this.isNeedForeignAction();\n        this.ariaService.setBusy(this.parent.getContent().querySelector('.' + literals.content), true);\n        if (isFActon) {\n            var deffered = new Deferred();\n            dataManager = this.getFData(deffered, args);\n        }\n        if (!dataManager) {\n            dataManager = this.data.getData(args, this.data.generateQuery().requiresCount());\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            dataManager = dataManager.then(function (e) {\n                var query = _this.data.generateQuery().requiresCount();\n                if (_this.emptyGrid) {\n                    var def = new Deferred();\n                    def.resolve({ result: [], count: 0 });\n                    return def.promise;\n                }\n                return _this.data.getData(args, query);\n            });\n        }\n        if (this.parent.getForeignKeyColumns().length && (!isFActon || this.parent.searchSettings.key.length)) {\n            var deffered_1 = new Deferred();\n            dataManager = dataManager.then(function (e) {\n                _this.parent.notify(events.getForeignKeyData, { dataManager: dataManager, result: e, promise: deffered_1, action: args });\n                return deffered_1.promise;\n            });\n        }\n        if (this.parent.groupSettings.disablePageWiseAggregates && this.parent.groupSettings.columns.length) {\n            dataManager = dataManager.then(function (e) { return _this.validateGroupRecords(e); });\n        }\n        dataManager.then(function (e) { return _this.dataManagerSuccess(e, args); })\n            .catch(function (e) { return _this.dataManagerFailure(e, args); });\n    };\n    Render.prototype.getFData = function (deferred, args) {\n        this.parent.notify(events.getForeignKeyData, { isComplex: true, promise: deferred, action: args });\n        return deferred.promise;\n    };\n    Render.prototype.isNeedForeignAction = function () {\n        var gObj = this.parent;\n        return !!((gObj.allowFiltering && gObj.filterSettings.columns.length) ||\n            (gObj.searchSettings.key.length)) && this.foreignKey(this.parent.getForeignKeyColumns());\n    };\n    Render.prototype.foreignKey = function (columns) {\n        var _this = this;\n        return columns.some(function (col) {\n            var fbool = false;\n            fbool = _this.parent.filterSettings.columns.some(function (value) {\n                return col.uid === value.uid;\n            });\n            return !!(fbool || _this.parent.searchSettings.key.length);\n        });\n    };\n    Render.prototype.sendBulkRequest = function (args) {\n        var _this = this;\n        args.requestType = 'batchsave';\n        var promise = this.data.saveChanges(args.changes, this.parent.getPrimaryKeyFieldNames()[0], args.original);\n        var query = this.data.generateQuery().requiresCount();\n        if (this.data.dataManager.dataSource.offline) {\n            this.refreshDataManager({ requestType: 'batchsave' });\n            return;\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\n            promise.then(function (e) {\n                _this.data.getData(args, query)\n                    .then(function (e) { return _this.dmSuccess(e, args); })\n                    .catch(function (e) { return _this.dmFailure(e, args); });\n            })\n                .catch(function (e) { return _this.dmFailure(e, args); });\n        }\n    };\n    Render.prototype.dmSuccess = function (e, args) {\n        this.dataManagerSuccess(e, args);\n    };\n    Render.prototype.dmFailure = function (e, args) {\n        this.dataManagerFailure(e, args);\n    };\n    /**\n     * Render empty row to Grid which is used at the time to represent to no records.\n     *\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.renderEmptyRow = function () {\n        this.emptyRow(true);\n    };\n    Render.prototype.emptyRow = function (isTrigger) {\n        var gObj = this.parent;\n        var tbody = this.contentRenderer.getTable().querySelector(literals.tbody);\n        if (!isNullOrUndefined(tbody)) {\n            remove(tbody);\n        }\n        tbody = this.parent.createElement(literals.tbody);\n        var spanCount = 0;\n        if (gObj.detailTemplate || gObj.childGrid) {\n            ++spanCount;\n        }\n        var tr = this.parent.createElement('tr', { className: 'e-emptyrow' });\n        tr.appendChild(this.parent.createElement('td', {\n            innerHTML: this.l10n.getConstant('EmptyRecord'),\n            attrs: { colspan: (gObj.getVisibleColumns().length + spanCount + gObj.groupSettings.columns.length).toString() }\n        }));\n        tbody.appendChild(tr);\n        this.contentRenderer.renderEmpty(tbody);\n        if (isTrigger) {\n            this.parent.trigger(events.dataBound, {});\n            this.parent.notify(events.onEmpty, { rows: [new Row({ isDataRow: true, cells: [new Cell({ isDataCell: true, visible: true })] })] });\n        }\n    };\n    Render.prototype.dynamicColumnChange = function () {\n        if (this.parent.getCurrentViewRecords().length) {\n            this.updateColumnType(this.parent.getCurrentViewRecords()[0]);\n        }\n    };\n    Render.prototype.updateColumnType = function (record) {\n        var columns = this.parent.getColumns();\n        var value;\n        var cFormat = 'customFormat';\n        var equalTo = 'equalTo';\n        var data = record && record.items ? record.items[0] : record;\n        var fmtr = this.locator.getService('valueFormatter');\n        for (var i = 0, len = columns.length; i < len; i++) {\n            value = getObject(columns[i].field || '', data);\n            if (!isNullOrUndefined(columns[i][cFormat])) {\n                columns[i].format = columns[i][cFormat];\n            }\n            if (!isNullOrUndefined(columns[i].validationRules) && !isNullOrUndefined(columns[i].validationRules[equalTo])) {\n                columns[i].validationRules[equalTo][0] = this.parent.element.id + columns[i].validationRules[equalTo][0];\n            }\n            if (columns[i].isForeignColumn() && columns[i].columnData) {\n                value = getObject(columns[i].foreignKeyValue || '', columns[i].columnData[0]);\n            }\n            if (!isNullOrUndefined(value)) {\n                this.isColTypeDef = true;\n                if (!columns[i].type) {\n                    columns[i].type = value.getDay ? (value.getHours() > 0 || value.getMinutes() > 0 ||\n                        value.getSeconds() > 0 || value.getMilliseconds() > 0 ? 'datetime' : 'date') : typeof (value);\n                }\n            }\n            else {\n                columns[i].type = columns[i].type || null;\n            }\n            var valueFormatter = new ValueFormatter();\n            if (columns[i].format && (columns[i].format.skeleton || (columns[i].format.format &&\n                typeof columns[i].format.format === 'string'))) {\n                columns[i].setFormatter(valueFormatter.getFormatFunction(extend({}, columns[i].format)));\n                columns[i].setParser(valueFormatter.getParserFunction(columns[i].format));\n            }\n            if (typeof (columns[i].format) === 'string') {\n                setFormatter(this.locator, columns[i]);\n            }\n            else if (!columns[i].format && columns[i].type === 'number') {\n                columns[i].setParser(fmtr.getParserFunction({ format: 'n2' }));\n            }\n        }\n    };\n    /**\n     * @param {ReturnType} e - specifies the return type\n     * @param {NotifyArgs} args - specifies the Notifyargs\n     * @returns {void}\n     * @hidden\n     */\n    // tslint:disable-next-line:max-func-body-length\n    Render.prototype.dataManagerSuccess = function (e, args) {\n        var _this = this;\n        var gObj = this.parent;\n        this.contentRenderer = this.renderer.getRenderer(RenderType.Content);\n        this.headerRenderer = this.renderer.getRenderer(RenderType.Header);\n        e.actionArgs = args;\n        var isInfiniteDelete = this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache\n            && (args.requestType === 'delete' || (args.requestType === 'save' && this.parent.infiniteScrollModule.requestType === 'add'));\n        // tslint:disable-next-line:max-func-body-length\n        gObj.trigger(events.beforeDataBound, e, function (dataArgs) {\n            if (dataArgs.cancel) {\n                return;\n            }\n            dataArgs.result = isNullOrUndefined(dataArgs.result) ? [] : dataArgs.result;\n            var len = Object.keys(dataArgs.result).length;\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n            if ((!gObj.getColumns().length && !len) && !(gObj.columns.length && gObj.columns[0] instanceof Column)) {\n                gObj.hideSpinner();\n                return;\n            }\n            if (_this.isInfiniteEnd(args) && !len) {\n                _this.parent.notify(events.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                return;\n            }\n            _this.parent.isEdit = false;\n            _this.parent.notify(events.editReset, {});\n            _this.parent.notify(events.tooltipDestroy, {});\n            _this.contentRenderer.prevCurrentView = _this.parent.currentViewData.slice();\n            gObj.currentViewData = dataArgs.result;\n            gObj.notify(events.refreshInfiniteCurrentViewData, { args: args, data: dataArgs.result });\n            if (!len && dataArgs.count && gObj.allowPaging && args && args.requestType !== 'delete') {\n                if (_this.parent.groupSettings.enableLazyLoading\n                    && (args.requestType === 'grouping' || args.requestType === 'ungrouping')) {\n                    _this.parent.notify(events.groupComplete, args);\n                }\n                gObj.prevPageMoving = true;\n                gObj.pageSettings.totalRecordsCount = dataArgs.count;\n                if (args.requestType !== 'paging') {\n                    gObj.pageSettings.currentPage = Math.ceil(dataArgs.count / gObj.pageSettings.pageSize);\n                }\n                gObj.dataBind();\n                return;\n            }\n            if ((!gObj.getColumns().length && len || !_this.isLayoutRendered) && !isGroupAdaptive(gObj)) {\n                _this.updatesOnInitialRender(dataArgs);\n            }\n            if (!_this.isColTypeDef && gObj.getCurrentViewRecords()) {\n                if (_this.data.dataManager.dataSource.offline && gObj.dataSource && gObj.dataSource.length) {\n                    _this.updateColumnType(gObj.dataSource[0]);\n                }\n                else {\n                    _this.updateColumnType(gObj.getCurrentViewRecords()[0]);\n                }\n            }\n            if (!_this.parent.isInitialLoad && _this.parent.groupSettings.disablePageWiseAggregates &&\n                !_this.parent.groupSettings.columns.length) {\n                dataArgs.result = _this.parent.dataSource instanceof Array ? _this.parent.dataSource : _this.parent.currentViewData;\n            }\n            if ((_this.parent.isReact || _this.parent.isVue) && !isNullOrUndefined(args) && args.requestType !== 'infiniteScroll' && !args.isFrozen) {\n                clearReactVueTemplates(_this.parent, ['footerTemplate']);\n            }\n            _this.parent.notify(events.dataReady, extend({ count: dataArgs.count, result: dataArgs.result, aggregates: dataArgs.aggregates }, args));\n            if ((gObj.groupSettings.columns.length || (args && args.requestType === 'ungrouping'))\n                && (args && args.requestType !== 'filtering')) {\n                _this.headerRenderer.refreshUI();\n            }\n            if (len) {\n                if (isGroupAdaptive(gObj)) {\n                    var content = 'content';\n                    args.scrollTop = { top: _this.contentRenderer[content].scrollTop };\n                }\n                if (!isInfiniteDelete) {\n                    if (_this.parent.enableImmutableMode) {\n                        _this.contentRenderer.immutableModeRendering(args);\n                    }\n                    else {\n                        _this.contentRenderer.refreshContentRows(args);\n                    }\n                }\n                else {\n                    _this.parent.notify(events.infiniteEditHandler, { e: args, result: e.result, count: e.count, agg: e.aggregates });\n                }\n            }\n            else {\n                if (args && args.isCaptionCollapse) {\n                    return;\n                }\n                if (!gObj.getColumns().length) {\n                    gObj.element.innerHTML = '';\n                    alert(_this.l10n.getConstant('EmptyDataSourceError')); //ToDO: change this alert as dialog\n                    return;\n                }\n                _this.contentRenderer.setRowElements([]);\n                _this.contentRenderer.setRowObjects([]);\n                _this.ariaService.setBusy(_this.parent.getContent().querySelector('.' + literals.content), false);\n                _this.renderEmptyRow();\n                if (args) {\n                    var action = (args.requestType || '').toLowerCase() + '-complete';\n                    _this.parent.notify(action, args);\n                    if (args.requestType === 'batchsave') {\n                        args.cancel = false;\n                        args.rows = [];\n                        args.isFrozen = _this.parent.getFrozenColumns() !== 0 && !args.isFrozen;\n                        _this.parent.trigger(events.actionComplete, args);\n                    }\n                }\n                _this.parent.hideSpinner();\n            }\n            _this.parent.notify(events.toolbarRefresh, {});\n            _this.setRowCount(_this.parent.getCurrentViewRecords().length);\n            _this.parent.getDataModule().isQueryInvokedFromData = false;\n        });\n    };\n    /**\n     * @param {object} e - specifies the object\n     * @param {Object[]} e.result - specifies the result\n     * @param {NotifyArgs} args - specifies the args\n     * @returns {void}\n     * @hidden\n     */\n    Render.prototype.dataManagerFailure = function (e, args) {\n        this.ariaService.setOptions(this.parent.getContent().querySelector('.' + literals.content), { busy: false, invalid: true });\n        this.setRowCount(1);\n        this.parent.trigger(events.actionFailure, { error: e });\n        this.parent.hideSpinner();\n        if (args.requestType === 'save' || args.requestType === 'delete'\n            || args.name === 'bulk-save') {\n            return;\n        }\n        this.parent.currentViewData = [];\n        this.renderEmptyRow();\n        this.parent.log('actionfailure', { error: e });\n    };\n    Render.prototype.setRowCount = function (dataRowCount) {\n        this.ariaService.setOptions(this.parent.getHeaderTable(), {\n            rowcount: dataRowCount ? dataRowCount.toString() : '1'\n        });\n    };\n    Render.prototype.isInfiniteEnd = function (args) {\n        return this.parent.enableInfiniteScrolling && !this.parent.infiniteScrollSettings.enableCache && args.requestType === 'delete';\n    };\n    Render.prototype.updatesOnInitialRender = function (e) {\n        this.isLayoutRendered = true;\n        if (this.parent.columns.length < 1) {\n            this.buildColumns(e.result[0]);\n        }\n        prepareColumns(this.parent.columns, null, this.parent);\n        this.headerRenderer.renderTable();\n        this.contentRenderer.renderTable();\n        this.parent.isAutoGen = true;\n        this.parent.notify(events.autoCol, {});\n    };\n    Render.prototype.iterateComplexColumns = function (obj, field, split) {\n        var keys = Object.keys(obj);\n        for (var i = 0; i < keys.length; i++) {\n            var childKeys = typeof obj[keys[i]] === 'object' && obj[keys[i]] && !(obj[keys[i]] instanceof Date) ?\n                Object.keys(obj[keys[i]]) : [];\n            if (childKeys.length) {\n                this.iterateComplexColumns(obj[keys[i]], field + (keys[i] + '.'), split);\n            }\n            else {\n                split[this.counter] = field + keys[i];\n                this.counter++;\n            }\n        }\n    };\n    Render.prototype.buildColumns = function (record) {\n        var cols = [];\n        var complexCols = {};\n        this.iterateComplexColumns(record, '', complexCols);\n        var columns = Object.keys(complexCols).filter(function (e) { return complexCols[e] !== 'BlazId'; }).\n            map(function (field) { return complexCols[field]; });\n        for (var i = 0, len = columns.length; i < len; i++) {\n            cols[i] = { 'field': columns[i] };\n            if (this.parent.enableColumnVirtualization) {\n                cols[i].width = !isNullOrUndefined(cols[i].width) ? cols[i].width : 200;\n            }\n        }\n        this.parent.setProperties({ 'columns': cols }, true);\n    };\n    Render.prototype.instantiateRenderer = function () {\n        this.renderer.addRenderer(RenderType.Header, new HeaderRender(this.parent, this.locator));\n        this.renderer.addRenderer(RenderType.Content, new ContentRender(this.parent, this.locator));\n        var cellrender = this.locator.getService('cellRendererFactory');\n        cellrender.addCellRenderer(CellType.Header, new HeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Data, new CellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Indent, new IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.GroupCaption, new GroupCaptionCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.GroupCaptionEmpty, new GroupCaptionEmptyCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.Expand, new ExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.HeaderIndent, new HeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.StackedHeader, new StackedHeaderCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailHeader, new DetailHeaderIndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.RowDragHIcon, new RowDragDropHeaderRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailExpand, new DetailExpandCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.DetailFooterIntent, new IndentCellRenderer(this.parent, this.locator));\n        cellrender.addCellRenderer(CellType.RowDragIcon, new RowDragDropRenderer(this.parent, this.locator));\n    };\n    Render.prototype.addEventListener = function () {\n        var _this = this;\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(events.initialLoad, this.instantiateRenderer, this);\n        this.parent.on('refreshdataSource', this.dataManagerSuccess, this);\n        this.parent.on(events.modelChanged, this.refresh, this);\n        this.parent.on(events.refreshComplete, this.refreshComplete, this);\n        this.parent.on(events.bulkSave, this.sendBulkRequest, this);\n        this.parent.on(events.showEmptyGrid, function () { _this.emptyGrid = true; }, this);\n        this.parent.on(events.autoCol, this.dynamicColumnChange, this);\n    };\n    /**\n     * @param {ReturnType} e - specifies the Return type\n     * @returns {Promise<Object>} returns the object\n     * @hidden\n     */\n    Render.prototype.validateGroupRecords = function (e) {\n        var _this = this;\n        var index = e.result.length - 1;\n        if (index < 0) {\n            return Promise.resolve(e);\n        }\n        var group0 = e.result[0];\n        var groupN = e.result[index];\n        var predicate = [];\n        var addWhere = function (input) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                predicate.push(new Predicate('field', '==', groups[i].field).and(_this.getPredicate('key', 'equal', groups[i].key)));\n            }\n            input.where(Predicate.or(predicate));\n        };\n        var query = new Query();\n        addWhere(query);\n        var curDm = new DataManager(e.result);\n        var curFilter = curDm.executeLocal(query);\n        var newQuery = this.data.generateQuery(true);\n        var rPredicate = [];\n        if (this.data.isRemote()) {\n            var groups = [group0, groupN];\n            for (var i = 0; i < groups.length; i++) {\n                rPredicate.push(this.getPredicate(groups[i].field, 'equal', groups[i].key));\n            }\n            newQuery.where(Predicate.or(rPredicate));\n        }\n        else {\n            addWhere(newQuery);\n        }\n        var deferred = new Deferred();\n        this.data.getData({}, newQuery).then(function (r) {\n            _this.updateGroupInfo(curFilter, r.result);\n            deferred.resolve(e);\n        }).catch(function (e) { return deferred.reject(e); });\n        return deferred.promise;\n    };\n    Render.prototype.getPredicate = function (key, operator, value) {\n        if (value instanceof Date) {\n            return getDatePredicate({ field: key, operator: operator, value: value });\n        }\n        return new Predicate(key, operator, value);\n    };\n    Render.prototype.updateGroupInfo = function (current, untouched) {\n        var dm = new DataManager(untouched);\n        var elements = current;\n        for (var i = 0; i < elements.length; i++) {\n            var uGroup = dm.executeLocal(new Query()\n                .where(new Predicate('field', '==', elements[i].field).and(this.getPredicate('key', 'equal', elements[i].key))))[0];\n            elements[i].count = uGroup.count;\n            var itemGroup = elements[i].items;\n            var uGroupItem = uGroup.items;\n            if (itemGroup.GroupGuid) {\n                elements[i].items = this.updateGroupInfo(elements[i].items, uGroup.items);\n            }\n            var rows = this.parent.aggregates;\n            for (var j = 0; j < rows.length; j++) {\n                var row = rows[j];\n                for (var k = 0; k < row.columns.length; k++) {\n                    var types = row.columns[k].type instanceof Array ? (row.columns[k].type) :\n                        [(row.columns[k].type)];\n                    for (var l = 0; l < types.length; l++) {\n                        var key = row.columns[k].field + ' - ' + types[l].toLowerCase();\n                        var data = itemGroup.level ? uGroupItem.records : uGroup.items;\n                        var context = this.parent;\n                        if (types[l] === 'Custom') {\n                            var data_1 = itemGroup.level ? uGroupItem : uGroup;\n                            var temp = row.columns[k].customAggregate;\n                            if (typeof temp === 'string') {\n                                temp = getValue(temp, window);\n                            }\n                            elements[i].aggregates[key] = temp ? temp.call(context, data_1, row.columns[k]) : '';\n                        }\n                        else {\n                            // eslint-disable-next-line max-len\n                            elements[i].aggregates[key] = DataUtil.aggregates[types[l].toLowerCase()](data, row.columns[k].field);\n                        }\n                    }\n                }\n            }\n        }\n        return current;\n    };\n    return Render;\n}());\nexport { Render };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}