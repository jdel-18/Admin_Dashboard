{"ast":null,"code":"import { extend, select } from '@syncfusion/ej2-base';\nimport { remove, isNullOrUndefined, updateBlazorTemplate } from '@syncfusion/ej2-base';\nimport { parentsUntil, isGroupAdaptive, refreshForeignData, getObject, gridActionHandler } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport { addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * `NormalEdit` module is used to handle normal('inline, dialog, external') editing actions.\n *\n * @hidden\n */\nvar NormalEdit = /** @class */function () {\n  function NormalEdit(parent, serviceLocator, renderer) {\n    this.args = {};\n    this.currentVirtualData = {};\n    this.parent = parent;\n    this.renderer = renderer;\n    this.serviceLocator = serviceLocator;\n    this.addEventListener();\n  }\n  NormalEdit.prototype.clickHandler = function (e) {\n    var target = e.target;\n    var gObj = this.parent;\n    if ((parentsUntil(target, literals.gridContent) && parentsUntil(parentsUntil(target, literals.gridContent), 'e-grid').id === gObj.element.id || gObj.frozenRows && parentsUntil(target, literals.headerContent)) && !parentsUntil(target, 'e-unboundcelldiv')) {\n      this.rowIndex = parentsUntil(target, literals.rowCell) ? parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) : -1;\n      if (gObj.isEdit) {\n        gObj.editModule.endEdit();\n      }\n    }\n  };\n  NormalEdit.prototype.dblClickHandler = function (e) {\n    if (parentsUntil(e.target, literals.rowCell) && this.parent.editSettings.allowEditOnDblClick) {\n      this.parent.editModule.startEdit(parentsUntil(e.target, literals.row));\n    }\n  };\n  /**\n   * The function used to trigger editComplete\n   *\n   * @param {NotifyArgs} e - specifies the NotifyArgs\n   * @returns {void}\n   * @hidden\n   */\n  NormalEdit.prototype.editComplete = function (e) {\n    this.parent.isEdit = false;\n    var action = 'action';\n    switch (e.requestType) {\n      case 'save':\n        if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') || !this.parent.isPersistSelection) {\n          if (e[action] !== 'edit') {\n            this.parent.selectRow(0);\n          }\n        }\n        this.parent.trigger(events.actionComplete, extend(e, {\n          requestType: 'save',\n          type: events.actionComplete\n        }));\n        break;\n      case 'delete':\n        this.parent.trigger(events.actionComplete, extend(e, {\n          requestType: 'delete',\n          type: events.actionComplete\n        }));\n        if (!this.parent.isCheckBoxSelection) {\n          this.parent.selectRow(this.editRowIndex);\n        }\n        break;\n    }\n  };\n  NormalEdit.prototype.getEditArgs = function (editedData, rowObj, isScroll) {\n    var primaryKeys = this.parent.getPrimaryKeyFieldNames();\n    var primaryKeyValues = [];\n    for (var i = 0; i < primaryKeys.length; i++) {\n      primaryKeyValues.push(getObject(primaryKeys[i], editedData));\n    }\n    var args = {\n      primaryKey: primaryKeys,\n      primaryKeyValue: primaryKeyValues,\n      requestType: 'beginEdit',\n      rowData: editedData,\n      rowIndex: this.rowIndex,\n      type: 'edit',\n      cancel: false,\n      foreignKeyData: rowObj && rowObj.foreignKeyData,\n      target: undefined,\n      isScroll: isScroll\n    };\n    return args;\n  };\n  NormalEdit.prototype.startEdit = function (tr) {\n    var _this = this;\n    var gObj = this.parent;\n    this.rowIndex = this.editRowIndex = parseInt(tr.getAttribute(literals.ariaRowIndex), 10);\n    if (gObj.enableVirtualization || gObj.enableInfiniteScrolling) {\n      var selector = '.e-row[aria-rowindex=\"' + this.rowIndex + '\"]';\n      var virtualRow = this.parent.element.querySelector(selector);\n      if (!virtualRow) {\n        return;\n      }\n    }\n    var e = {\n      data: undefined,\n      index: this.rowIndex,\n      isScroll: false\n    };\n    this.parent.notify(events.virtualScrollEditActionBegin, e);\n    if (isGroupAdaptive(gObj)) {\n      var rObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n      this.previousData = rObj.data;\n    } else if (!this.previousData && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n      this.previousData = e.data;\n    } else if (!this.parent.enableVirtualization) {\n      this.previousData = extend({}, {}, gObj.getCurrentViewRecords()[this.rowIndex], true);\n    }\n    var editedData = extend({}, {}, e.data || this.previousData, true);\n    this.uid = tr.getAttribute('data-uid');\n    var rowObj = gObj.getRowObjectFromUID(this.uid);\n    var args = this.getEditArgs(editedData, rowObj, e.isScroll);\n    args.row = tr;\n    if (!args.isScroll) {\n      this.parent.notify(events.createVirtualValidationForm, {\n        uid: this.uid,\n        prevData: this.previousData,\n        argsCreator: this.getEditArgs.bind(this),\n        renderer: this.renderer\n      });\n      gObj.trigger(events.beginEdit, args, function (begineditargs) {\n        begineditargs.type = 'actionBegin';\n        gObj.trigger(events.actionBegin, begineditargs, function (editargs) {\n          if (!editargs.cancel) {\n            _this.inlineEditHandler(editargs, tr);\n          }\n        });\n      });\n    } else {\n      this.inlineEditHandler(args, tr);\n    }\n  };\n  NormalEdit.prototype.inlineEditHandler = function (editargs, tr) {\n    var gObj = this.parent;\n    gObj.isEdit = true;\n    editargs.row = editargs.row ? editargs.row : tr;\n    if (gObj.editSettings.mode !== 'Dialog') {\n      gObj.clearSelection();\n    }\n    if (gObj.editSettings.mode === 'Dialog' && gObj.selectionModule) {\n      gObj.selectionModule.preventFocus = true;\n      editargs.row.classList.add('e-dlgeditrow');\n    }\n    this.renderer.update(editargs);\n    this.uid = tr.getAttribute('data-uid');\n    gObj.editModule.applyFormValidation();\n    editargs.type = 'actionComplete';\n    gObj.trigger(events.actionComplete, editargs);\n    this.args = editargs;\n    if (this.parent.allowTextWrap) {\n      this.parent.notify(events.freezeRender, {\n        case: 'textwrap'\n      });\n    }\n  };\n  NormalEdit.prototype.updateRow = function (index, data) {\n    var _this = this;\n    var gObj = this.parent;\n    this.editRowIndex = index;\n    var args = {\n      requestType: 'save',\n      action: 'edit',\n      type: events.actionBegin,\n      data: data,\n      cancel: false,\n      previousData: gObj.getCurrentViewRecords()[index],\n      row: gObj.getRowByIndex(index)\n    };\n    gObj.showSpinner();\n    if (gObj.enableInfiniteScrolling) {\n      this.uid = args.row.getAttribute('data-uid');\n      var index_1 = parseInt(args.row.getAttribute('aria-rowindex'));\n      this.parent.notify(events.refreshInfiniteEditrowindex, {\n        index: index_1\n      });\n    }\n    gObj.notify(events.updateData, args);\n    if (args.promise) {\n      args.promise.then(function () {\n        return gObj.refresh();\n      }).catch(function (e) {\n        return _this.edFail(e);\n      });\n    } else {\n      if (!gObj.enableInfiniteScrolling) {\n        gObj.refresh();\n      }\n    }\n  };\n  NormalEdit.prototype.editFormValidate = function () {\n    var gObj = this.parent;\n    var isValid = gObj.editModule.editFormValidate();\n    var validationArgs = {\n      prevData: this.previousData,\n      isValid: true,\n      editIdx: this.editRowIndex,\n      addIdx: this.addedRowIndex\n    };\n    gObj.notify(events.validateVirtualForm, validationArgs);\n    return isValid && validationArgs.isValid;\n  };\n  NormalEdit.prototype.endEdit = function () {\n    var gObj = this.parent;\n    if (!this.parent.isEdit || !this.editFormValidate()) {\n      return;\n    }\n    var editedData = extend({}, {}, this.previousData, true);\n    var args = extend(this.args, {\n      requestType: 'save',\n      type: events.actionBegin,\n      data: editedData,\n      cancel: false,\n      previousData: this.previousData,\n      selectedRow: gObj.selectedRowIndex,\n      foreignKeyData: {}\n    });\n    var index = gObj.getFrozenMode() === 'Right' ? 1 : 0;\n    var isDlg = gObj.editSettings.mode === 'Dialog';\n    var dlgWrapper = select('#' + gObj.element.id + '_dialogEdit_wrapper', document);\n    var dlgForm = isDlg ? dlgWrapper.querySelector('.e-gridform') : gObj.element.getElementsByClassName('e-gridform')[index];\n    var data = {\n      virtualData: extend({}, {}, this.previousData, true),\n      isAdd: false,\n      isScroll: false,\n      endEdit: true\n    };\n    this.parent.notify(events.getVirtualData, data);\n    if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling) && this.parent.editSettings.mode === 'Normal' && Object.keys(data.virtualData).length) {\n      if (this.parent.isEdit) {\n        this.currentVirtualData = editedData = args.data = data.virtualData;\n      }\n    } else {\n      editedData = gObj.editModule.getCurrentEditedData(dlgForm, editedData);\n    }\n    if (gObj.isFrozenGrid() && gObj.editSettings.mode === 'Normal') {\n      var mhdrFrm = gObj.getMovableVirtualHeader().querySelector('.e-gridform');\n      var mCntFrm = gObj.getMovableVirtualContent().querySelector('.e-gridform');\n      var mvblEle = [mhdrFrm || mCntFrm];\n      var frHdrFrm = void 0;\n      var frCntFrm = void 0;\n      var frEle = [];\n      if (gObj.getFrozenMode() === literals.leftRight) {\n        frHdrFrm = gObj.getFrozenRightHeader().querySelector('.e-gridform');\n        frCntFrm = gObj.getFrozenRightContent().querySelector('.e-gridform');\n        frEle = [frHdrFrm || frCntFrm];\n      }\n      gridActionHandler(this.parent, function (tableName, elements) {\n        for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n          var ele = elements_1[_i];\n          if (ele) {\n            editedData = gObj.editModule.getCurrentEditedData(ele, editedData);\n          }\n        }\n      }, [[], mvblEle, frEle]);\n    }\n    var eleLength = [].slice.call(gObj.element.getElementsByClassName(literals.editedRow)).length;\n    if (!data.isAdd && Object.keys(this.currentVirtualData).length && !eleLength) {\n      eleLength = 1;\n    }\n    if (isDlg ? dlgWrapper.getElementsByClassName(literals.editedRow).length : eleLength) {\n      args.action = 'edit';\n      gObj.trigger(events.actionBegin, args, function (endEditArgs) {\n        if (endEditArgs.cancel) {\n          return;\n        }\n        gObj.showSpinner();\n        gObj.notify(events.updateData, endEditArgs);\n      });\n    } else {\n      args.action = 'add';\n      args.selectedRow = 0;\n      args.index = this.addedRowIndex;\n      gObj.notify(events.virtualScrollEditSuccess, {});\n      gObj.notify(events.modelChanged, args);\n      this.addedRowIndex = null;\n      if (args.cancel) {\n        return;\n      }\n    }\n  };\n  NormalEdit.prototype.destroyElements = function () {\n    var gObj = this.parent;\n    gObj.editModule.destroyWidgets();\n    gObj.editModule.destroyForm();\n    this.parent.notify(events.dialogDestroy, {});\n  };\n  NormalEdit.prototype.editHandler = function (args) {\n    var _this = this;\n    if (args.promise) {\n      args.promise.then(function (e) {\n        return _this.edSucc(e, args);\n      }).catch(function (e) {\n        return _this.edFail(e);\n      });\n    } else {\n      this.editSuccess(args.data, args);\n    }\n  };\n  NormalEdit.prototype.edSucc = function (e, args) {\n    this.editSuccess(e, args);\n  };\n  NormalEdit.prototype.edFail = function (e) {\n    this.editFailure(e);\n  };\n  NormalEdit.prototype.updateCurrentViewData = function (data) {\n    if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) {\n      this.parent.getCurrentViewRecords()[this.editRowIndex] = data;\n    }\n  };\n  NormalEdit.prototype.requestSuccess = function (args) {\n    if (this.parent.editModule.formObj && !this.parent.editModule.formObj.isDestroyed) {\n      this.destroyElements();\n      this.stopEditStatus();\n      if (this.parent.editSettings.mode === 'Dialog' && args.action !== 'add' && this.parent.selectionModule) {\n        this.parent.element.querySelector('.e-dlgeditrow').classList.remove('e-dlgeditrow');\n      }\n    }\n  };\n  NormalEdit.prototype.editSuccess = function (e, args) {\n    if (!isNullOrUndefined(e) && !(e instanceof Array)) {\n      var rowData = 'rowData';\n      args.data = extend({}, extend({}, args[rowData], args.data), e);\n    }\n    this.requestSuccess(args);\n    this.parent.trigger(events.beforeDataBound, args);\n    args.type = events.actionComplete;\n    this.parent.isEdit = false;\n    this.refreshRow(args.data);\n    this.parent.notify(events.virtualScrollEditSuccess, args);\n    this.parent.editModule.checkLastRow(args.row);\n    this.parent.editModule.isLastRow = false;\n    this.updateCurrentViewData(args.data);\n    this.blazorTemplate();\n    this.editRowIndex = null;\n    this.parent.trigger(events.actionComplete, args);\n    if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple') || !this.parent.isPersistSelection && !this.parent.selectionSettings.checkboxOnly) {\n      if (this.parent.editSettings.mode !== 'Dialog') {\n        this.parent.selectRow(this.rowIndex > -1 ? this.rowIndex : this.editRowIndex);\n      }\n    }\n    this.parent.hideSpinner();\n  };\n  NormalEdit.prototype.closeForm = function () {\n    if (!this.cloneRow && this.parent.isEdit) {\n      this.stopEditStatus();\n    }\n    if (this.cloneRow) {\n      this.cloneRow.remove();\n      this.cloneRow = null;\n      this.originalRow.classList.remove('e-hiddenrow');\n    }\n    if (this.parent.isFrozenGrid() && this.cloneFrozen) {\n      this.cloneFrozen.remove();\n      this.frozen.classList.remove('e-hiddenrow');\n    }\n  };\n  NormalEdit.prototype.blazorTemplate = function () {\n    var cols = this.parent.getColumns();\n    if (this.parent.editSettings.template && this.parent.editSettings.mode === 'Normal') {\n      updateBlazorTemplate(this.parent.element.id + 'editSettingsTemplate', 'Template', this.parent.editSettings);\n    }\n    for (var i = 0; i < cols.length; i++) {\n      var col = cols[i];\n      if (col.template) {\n        updateBlazorTemplate(this.parent.element.id + col.uid, 'Template', col, false);\n      }\n      if (col.editTemplate) {\n        updateBlazorTemplate(this.parent.element.id + col.uid + 'editTemplate', 'EditTemplate', col);\n      }\n    }\n  };\n  NormalEdit.prototype.editFailure = function (e) {\n    this.parent.trigger(events.actionFailure, {\n      error: e\n    });\n    this.parent.hideSpinner();\n    this.parent.log('actionfailure', {\n      error: e\n    });\n  };\n  NormalEdit.prototype.needRefresh = function () {\n    var refresh = true;\n    var editedRow = this.parent.element.querySelector('.e-gridform');\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && this.parent.editSettings.mode === 'Normal' && !editedRow) {\n      refresh = false;\n    }\n    return refresh;\n  };\n  NormalEdit.prototype.refreshRow = function (data) {\n    var frzCols = this.parent.isFrozenGrid();\n    var row = new RowRenderer(this.serviceLocator, null, this.parent);\n    var rowObj = this.parent.getRowObjectFromUID(this.uid);\n    if (rowObj) {\n      rowObj.changes = data;\n      this.parent.notify(events.refreshVirtualCache, {\n        data: data\n      });\n      refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n      if (this.needRefresh()) {\n        row.refresh(rowObj, this.parent.getColumns(), true);\n      }\n      var tr = [].slice.call(this.parent.element.querySelectorAll('[aria-rowindex=\"' + rowObj.index + '\"]'));\n      if (frzCols && tr.length) {\n        for (var i = 0; i < tr.length; i++) {\n          var rowUid = tr[i].getAttribute('data-uid');\n          if (rowUid !== this.uid) {\n            rowObj = this.parent.getRowObjectFromUID(rowUid);\n            rowObj.changes = data;\n            row.refresh(rowObj, this.parent.getColumns(), true);\n            this.parent.editModule.checkLastRow(tr[i]);\n          }\n        }\n      }\n    }\n  };\n  NormalEdit.prototype.closeEdit = function () {\n    var _this = this;\n    if (!this.parent.isEdit) {\n      return;\n    }\n    var gObj = this.parent;\n    var args = extend(this.args, {\n      requestType: 'cancel',\n      type: events.actionBegin,\n      cancel: false,\n      data: this.previousData,\n      selectedRow: gObj.selectedRowIndex\n    });\n    gObj.notify(events.virtualScrollEditCancel, args);\n    this.blazorTemplate();\n    gObj.trigger(events.actionBegin, args, function (closeEditArgs) {\n      if (closeEditArgs.cancel) {\n        return;\n      }\n      if (_this.parent.editSettings.mode === 'Dialog') {\n        _this.parent.notify(events.dialogDestroy, {});\n      }\n      gObj.isEdit = false;\n      _this.stopEditStatus();\n      closeEditArgs.type = events.actionComplete;\n      if (gObj.editSettings.mode !== 'Dialog') {\n        _this.refreshRow(closeEditArgs.data);\n      }\n      var isLazyLoad = gObj.groupSettings.enableLazyLoading && gObj.groupSettings.columns.length && !gObj.getContentTable().querySelector('tr.e-emptyrow');\n      if (!gObj.getContentTable().querySelector('tr.e-emptyrow') && !gObj.getContentTable().querySelector('tr.e-row') && !isLazyLoad) {\n        gObj.renderModule.emptyRow();\n      }\n      if (gObj.editSettings.mode !== 'Dialog') {\n        gObj.selectRow(_this.rowIndex);\n      }\n      gObj.trigger(events.actionComplete, closeEditArgs);\n    });\n  };\n  NormalEdit.prototype.addRecord = function (data, index) {\n    var _this = this;\n    var gObj = this.parent;\n    this.addedRowIndex = index = !isNullOrUndefined(index) ? index : 0;\n    if (data) {\n      gObj.notify(events.modelChanged, {\n        requestType: 'save',\n        type: events.actionBegin,\n        data: data,\n        selectedRow: 0,\n        action: 'add',\n        index: index\n      });\n      return;\n    }\n    if (gObj.isEdit) {\n      return;\n    }\n    this.previousData = {};\n    this.uid = '';\n    var cols = gObj.getColumns();\n    var rowData = {\n      virtualData: {},\n      isScroll: false\n    };\n    this.parent.notify(events.getVirtualData, rowData);\n    for (var i = 0; i < cols.length; i++) {\n      if (rowData.isScroll && cols[i].getFreezeTableName() !== 'movable') {\n        continue;\n      }\n      if (cols[i].field) {\n        DataUtil.setValue(cols[i].field, cols[i].defaultValue, this.previousData);\n      }\n    }\n    var args = {\n      cancel: false,\n      foreignKeyData: {},\n      requestType: 'add',\n      data: this.previousData,\n      type: events.actionBegin,\n      index: index,\n      rowData: this.previousData,\n      target: undefined,\n      isScroll: rowData.isScroll\n    };\n    if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache) && Object.keys(rowData.virtualData).length) {\n      args.data = args.rowData = rowData.virtualData;\n    }\n    if (!args.isScroll) {\n      this.parent.notify(events.createVirtualValidationForm, {\n        uid: this.uid,\n        prevData: this.previousData,\n        argsCreator: this.getEditArgs.bind(this),\n        renderer: this.renderer\n      });\n      gObj.trigger(events.actionBegin, args, function (addArgs) {\n        if (addArgs.cancel) {\n          return;\n        }\n        _this.inlineAddHandler(addArgs);\n      });\n    } else {\n      this.inlineAddHandler(args);\n    }\n  };\n  NormalEdit.prototype.inlineAddHandler = function (addArgs) {\n    var gObj = this.parent;\n    gObj.isEdit = true;\n    if (gObj.editSettings.mode !== 'Dialog') {\n      gObj.clearSelection();\n    }\n    this.renderer.addNew(addArgs);\n    gObj.editModule.applyFormValidation();\n    addArgs.type = events.actionComplete;\n    addArgs.row = gObj.element.querySelector('.' + literals.addedRow);\n    gObj.trigger(events.actionComplete, addArgs);\n    this.args = addArgs;\n  };\n  NormalEdit.prototype.deleteRecord = function (fieldname, data) {\n    this.editRowIndex = this.parent.selectedRowIndex;\n    if (data) {\n      data = data instanceof Array ? data : [data];\n      var gObj = this.parent;\n      var dataLen = Object.keys(data).length;\n      fieldname = fieldname || this.parent.getPrimaryKeyFieldNames()[0];\n      var _loop_1 = function (i) {\n        var _a;\n        var tmpRecord;\n        var contained = gObj.currentViewData.some(function (record) {\n          tmpRecord = record;\n          return data[i] === getObject(fieldname, record) || data[i] === record;\n        });\n        data[i] = contained ? tmpRecord : data[i][fieldname] ? data[i] : (_a = {}, _a[fieldname] = data[i], _a);\n      };\n      for (var i = 0; i < dataLen; i++) {\n        _loop_1(i);\n      }\n    }\n    var args = {\n      requestType: 'delete',\n      type: events.actionBegin,\n      foreignKeyData: {},\n      data: data ? data : this.parent.getSelectedRecords(),\n      tr: this.parent.getSelectedRows(),\n      cancel: false\n    };\n    if (!isNullOrUndefined(this.parent.commandDelIndex)) {\n      args.data[0] = this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute('data-uid')).data;\n    }\n    if (this.parent.enableVirtualization && args.data.length > 1) {\n      var uid = this.parent.getSelectedRows()[0].getAttribute('data-uid');\n      args.data = [this.parent.getRowObjectFromUID(uid).data];\n    }\n    this.parent.notify(events.modelChanged, args);\n  };\n  NormalEdit.prototype.stopEditStatus = function () {\n    var gObj = this.parent;\n    var addElements = [].slice.call(gObj.element.getElementsByClassName(literals.addedRow));\n    var editElements = [].slice.call(gObj.element.getElementsByClassName(literals.editedRow));\n    for (var i = 0; i < addElements.length; i++) {\n      remove(addElements[i]);\n    }\n    for (var i = 0; i < editElements.length; i++) {\n      editElements[i].classList.remove(literals.editedRow);\n    }\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  NormalEdit.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    this.evtHandlers = [{\n      event: events.crudAction,\n      handler: this.editHandler\n    }, {\n      event: events.doubleTap,\n      handler: this.dblClickHandler\n    }, {\n      event: events.click,\n      handler: this.clickHandler\n    }, {\n      event: events.recordAdded,\n      handler: this.requestSuccess\n    }, {\n      event: events.dblclick,\n      handler: this.dblClickHandler\n    }, {\n      event: events.deleteComplete,\n      handler: this.editComplete\n    }, {\n      event: events.saveComplete,\n      handler: this.editComplete\n    }, {\n      event: events.rowModeChange,\n      handler: this.closeEdit\n    }, {\n      event: events.closeInline,\n      handler: this.closeForm\n    }];\n    addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  NormalEdit.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n    addRemoveEventListener(this.parent, this.evtHandlers, false);\n  };\n  /**\n   * @returns {void}\n   * @hidden\n   */\n  NormalEdit.prototype.destroy = function () {\n    this.removeEventListener();\n    this.renderer.destroy();\n  };\n  return NormalEdit;\n}();\nexport { NormalEdit };","map":{"version":3,"names":["extend","select","remove","isNullOrUndefined","updateBlazorTemplate","parentsUntil","isGroupAdaptive","refreshForeignData","getObject","gridActionHandler","events","RowRenderer","DataUtil","addRemoveEventListener","literals","NormalEdit","parent","serviceLocator","renderer","args","currentVirtualData","addEventListener","prototype","clickHandler","e","target","gObj","gridContent","id","element","frozenRows","headerContent","rowIndex","rowCell","parseInt","parentElement","getAttribute","ariaRowIndex","isEdit","editModule","endEdit","dblClickHandler","editSettings","allowEditOnDblClick","startEdit","row","editComplete","action","requestType","isCheckBoxSelection","selectionSettings","type","isPersistSelection","selectRow","trigger","actionComplete","editRowIndex","getEditArgs","editedData","rowObj","isScroll","primaryKeys","getPrimaryKeyFieldNames","primaryKeyValues","i","length","push","primaryKey","primaryKeyValue","rowData","cancel","foreignKeyData","undefined","tr","_this","enableVirtualization","enableInfiniteScrolling","selector","virtualRow","querySelector","data","index","notify","virtualScrollEditActionBegin","rObj","getRowObjectFromUID","previousData","getCurrentViewRecords","uid","createVirtualValidationForm","prevData","argsCreator","bind","beginEdit","begineditargs","actionBegin","editargs","inlineEditHandler","mode","clearSelection","selectionModule","preventFocus","classList","add","update","applyFormValidation","allowTextWrap","freezeRender","case","updateRow","getRowByIndex","showSpinner","index_1","refreshInfiniteEditrowindex","updateData","promise","then","refresh","catch","edFail","editFormValidate","isValid","validationArgs","editIdx","addIdx","addedRowIndex","validateVirtualForm","selectedRow","selectedRowIndex","getFrozenMode","isDlg","dlgWrapper","document","dlgForm","getElementsByClassName","virtualData","isAdd","getVirtualData","Object","keys","getCurrentEditedData","isFrozenGrid","mhdrFrm","getMovableVirtualHeader","mCntFrm","getMovableVirtualContent","mvblEle","frHdrFrm","frCntFrm","frEle","leftRight","getFrozenRightHeader","getFrozenRightContent","tableName","elements","_i","elements_1","ele","eleLength","slice","call","editedRow","endEditArgs","virtualScrollEditSuccess","modelChanged","destroyElements","destroyWidgets","destroyForm","dialogDestroy","editHandler","edSucc","editSuccess","editFailure","updateCurrentViewData","requestSuccess","formObj","isDestroyed","stopEditStatus","Array","beforeDataBound","refreshRow","checkLastRow","isLastRow","blazorTemplate","checkboxOnly","hideSpinner","closeForm","cloneRow","originalRow","cloneFrozen","frozen","cols","getColumns","template","col","editTemplate","actionFailure","error","log","needRefresh","infiniteScrollSettings","enableCache","frzCols","changes","refreshVirtualCache","getForeignKeyColumns","querySelectorAll","rowUid","closeEdit","virtualScrollEditCancel","closeEditArgs","isLazyLoad","groupSettings","enableLazyLoading","columns","getContentTable","renderModule","emptyRow","addRecord","getFreezeTableName","field","setValue","defaultValue","addArgs","inlineAddHandler","addNew","addedRow","deleteRecord","fieldname","dataLen","_loop_1","_a","tmpRecord","contained","currentViewData","some","record","getSelectedRecords","getSelectedRows","commandDelIndex","addElements","editElements","evtHandlers","event","crudAction","handler","doubleTap","click","recordAdded","dblclick","deleteComplete","saveComplete","rowModeChange","closeInline","removeEventListener","destroy"],"sources":["C:/Users/Josh/Desktop/School-work/admin_dash/Admin_Dashboard/node_modules/@syncfusion/ej2-grids/src/grid/actions/normal-edit.js"],"sourcesContent":["import { extend, select } from '@syncfusion/ej2-base';\nimport { remove, isNullOrUndefined, updateBlazorTemplate } from '@syncfusion/ej2-base';\nimport { parentsUntil, isGroupAdaptive, refreshForeignData, getObject, gridActionHandler } from '../base/util';\nimport * as events from '../base/constant';\nimport { RowRenderer } from '../renderer/row-renderer';\nimport { DataUtil } from '@syncfusion/ej2-data';\nimport { addRemoveEventListener } from '../base/util';\nimport * as literals from '../base/string-literals';\n/**\n * `NormalEdit` module is used to handle normal('inline, dialog, external') editing actions.\n *\n * @hidden\n */\nvar NormalEdit = /** @class */ (function () {\n    function NormalEdit(parent, serviceLocator, renderer) {\n        this.args = {};\n        this.currentVirtualData = {};\n        this.parent = parent;\n        this.renderer = renderer;\n        this.serviceLocator = serviceLocator;\n        this.addEventListener();\n    }\n    NormalEdit.prototype.clickHandler = function (e) {\n        var target = e.target;\n        var gObj = this.parent;\n        if ((((parentsUntil(target, literals.gridContent) &&\n            parentsUntil(parentsUntil(target, literals.gridContent), 'e-grid').id === gObj.element.id)) || (gObj.frozenRows\n            && parentsUntil(target, literals.headerContent))) && !parentsUntil(target, 'e-unboundcelldiv')) {\n            this.rowIndex = parentsUntil(target, literals.rowCell)\n                ? parseInt(target.parentElement.getAttribute(literals.ariaRowIndex), 10) : -1;\n            if (gObj.isEdit) {\n                gObj.editModule.endEdit();\n            }\n        }\n    };\n    NormalEdit.prototype.dblClickHandler = function (e) {\n        if (parentsUntil(e.target, literals.rowCell) && this.parent.editSettings.allowEditOnDblClick) {\n            this.parent.editModule.startEdit(parentsUntil(e.target, literals.row));\n        }\n    };\n    /**\n     * The function used to trigger editComplete\n     *\n     * @param {NotifyArgs} e - specifies the NotifyArgs\n     * @returns {void}\n     * @hidden\n     */\n    NormalEdit.prototype.editComplete = function (e) {\n        this.parent.isEdit = false;\n        var action = 'action';\n        switch (e.requestType) {\n            case 'save':\n                if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple')\n                    || (!this.parent.isPersistSelection)) {\n                    if (e[action] !== 'edit') {\n                        this.parent.selectRow(0);\n                    }\n                }\n                this.parent.trigger(events.actionComplete, extend(e, {\n                    requestType: 'save',\n                    type: events.actionComplete\n                }));\n                break;\n            case 'delete':\n                this.parent.trigger(events.actionComplete, extend(e, {\n                    requestType: 'delete',\n                    type: events.actionComplete\n                }));\n                if (!this.parent.isCheckBoxSelection) {\n                    this.parent.selectRow(this.editRowIndex);\n                }\n                break;\n        }\n    };\n    NormalEdit.prototype.getEditArgs = function (editedData, rowObj, isScroll) {\n        var primaryKeys = this.parent.getPrimaryKeyFieldNames();\n        var primaryKeyValues = [];\n        for (var i = 0; i < primaryKeys.length; i++) {\n            primaryKeyValues.push(getObject(primaryKeys[i], editedData));\n        }\n        var args = {\n            primaryKey: primaryKeys, primaryKeyValue: primaryKeyValues, requestType: 'beginEdit',\n            rowData: editedData, rowIndex: this.rowIndex, type: 'edit', cancel: false,\n            foreignKeyData: rowObj && rowObj.foreignKeyData, target: undefined, isScroll: isScroll\n        };\n        return args;\n    };\n    NormalEdit.prototype.startEdit = function (tr) {\n        var _this = this;\n        var gObj = this.parent;\n        this.rowIndex = this.editRowIndex = parseInt(tr.getAttribute(literals.ariaRowIndex), 10);\n        if (gObj.enableVirtualization || gObj.enableInfiniteScrolling) {\n            var selector = '.e-row[aria-rowindex=\"' + this.rowIndex + '\"]';\n            var virtualRow = this.parent.element.querySelector(selector);\n            if (!virtualRow) {\n                return;\n            }\n        }\n        var e = { data: undefined, index: this.rowIndex, isScroll: false };\n        this.parent.notify(events.virtualScrollEditActionBegin, e);\n        if (isGroupAdaptive(gObj)) {\n            var rObj = gObj.getRowObjectFromUID(tr.getAttribute('data-uid'));\n            this.previousData = rObj.data;\n        }\n        else if (!this.previousData && (this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)) {\n            this.previousData = e.data;\n        }\n        else if (!this.parent.enableVirtualization) {\n            this.previousData = extend({}, {}, gObj.getCurrentViewRecords()[this.rowIndex], true);\n        }\n        var editedData = extend({}, {}, e.data || this.previousData, true);\n        this.uid = tr.getAttribute('data-uid');\n        var rowObj = gObj.getRowObjectFromUID(this.uid);\n        var args = this.getEditArgs(editedData, rowObj, e.isScroll);\n        args.row = tr;\n        if (!args.isScroll) {\n            this.parent.notify(events.createVirtualValidationForm, { uid: this.uid, prevData: this.previousData, argsCreator: this.getEditArgs.bind(this), renderer: this.renderer });\n            gObj.trigger(events.beginEdit, args, function (begineditargs) {\n                begineditargs.type = 'actionBegin';\n                gObj.trigger(events.actionBegin, begineditargs, function (editargs) {\n                    if (!editargs.cancel) {\n                        _this.inlineEditHandler(editargs, tr);\n                    }\n                });\n            });\n        }\n        else {\n            this.inlineEditHandler(args, tr);\n        }\n    };\n    NormalEdit.prototype.inlineEditHandler = function (editargs, tr) {\n        var gObj = this.parent;\n        gObj.isEdit = true;\n        editargs.row = editargs.row ? editargs.row : tr;\n        if (gObj.editSettings.mode !== 'Dialog') {\n            gObj.clearSelection();\n        }\n        if (gObj.editSettings.mode === 'Dialog' && gObj.selectionModule) {\n            gObj.selectionModule.preventFocus = true;\n            editargs.row.classList.add('e-dlgeditrow');\n        }\n        this.renderer.update(editargs);\n        this.uid = tr.getAttribute('data-uid');\n        gObj.editModule.applyFormValidation();\n        editargs.type = 'actionComplete';\n        gObj.trigger(events.actionComplete, editargs);\n        this.args = editargs;\n        if (this.parent.allowTextWrap) {\n            this.parent.notify(events.freezeRender, { case: 'textwrap' });\n        }\n    };\n    NormalEdit.prototype.updateRow = function (index, data) {\n        var _this = this;\n        var gObj = this.parent;\n        this.editRowIndex = index;\n        var args = {\n            requestType: 'save', action: 'edit', type: events.actionBegin, data: data, cancel: false,\n            previousData: gObj.getCurrentViewRecords()[index],\n            row: gObj.getRowByIndex(index)\n        };\n        gObj.showSpinner();\n        if (gObj.enableInfiniteScrolling) {\n            this.uid = args.row.getAttribute('data-uid');\n            var index_1 = parseInt(args.row.getAttribute('aria-rowindex'));\n            this.parent.notify(events.refreshInfiniteEditrowindex, { index: index_1 });\n        }\n        gObj.notify(events.updateData, args);\n        if (args.promise) {\n            args.promise.then(function () { return gObj.refresh(); }).catch(function (e) { return _this.edFail(e); });\n        }\n        else {\n            if (!gObj.enableInfiniteScrolling) {\n                gObj.refresh();\n            }\n        }\n    };\n    NormalEdit.prototype.editFormValidate = function () {\n        var gObj = this.parent;\n        var isValid = gObj.editModule.editFormValidate();\n        var validationArgs = {\n            prevData: this.previousData, isValid: true, editIdx: this.editRowIndex, addIdx: this.addedRowIndex\n        };\n        gObj.notify(events.validateVirtualForm, validationArgs);\n        return (isValid && validationArgs.isValid);\n    };\n    NormalEdit.prototype.endEdit = function () {\n        var gObj = this.parent;\n        if (!this.parent.isEdit || !this.editFormValidate()) {\n            return;\n        }\n        var editedData = extend({}, {}, this.previousData, true);\n        var args = extend(this.args, {\n            requestType: 'save', type: events.actionBegin, data: editedData, cancel: false,\n            previousData: this.previousData, selectedRow: gObj.selectedRowIndex, foreignKeyData: {}\n        });\n        var index = gObj.getFrozenMode() === 'Right' ? 1 : 0;\n        var isDlg = gObj.editSettings.mode === 'Dialog';\n        var dlgWrapper = select('#' + gObj.element.id + '_dialogEdit_wrapper', document);\n        var dlgForm = isDlg ? dlgWrapper.querySelector('.e-gridform') : gObj.element.getElementsByClassName('e-gridform')[index];\n        var data = {\n            virtualData: extend({}, {}, this.previousData, true), isAdd: false, isScroll: false, endEdit: true\n        };\n        this.parent.notify(events.getVirtualData, data);\n        if ((this.parent.enableVirtualization || this.parent.enableInfiniteScrolling)\n            && this.parent.editSettings.mode === 'Normal' && Object.keys(data.virtualData).length) {\n            if (this.parent.isEdit) {\n                this.currentVirtualData = editedData = args.data = data.virtualData;\n            }\n        }\n        else {\n            editedData = gObj.editModule.getCurrentEditedData(dlgForm, editedData);\n        }\n        if (gObj.isFrozenGrid() && gObj.editSettings.mode === 'Normal') {\n            var mhdrFrm = gObj.getMovableVirtualHeader().querySelector('.e-gridform');\n            var mCntFrm = gObj.getMovableVirtualContent().querySelector('.e-gridform');\n            var mvblEle = [mhdrFrm || mCntFrm];\n            var frHdrFrm = void 0;\n            var frCntFrm = void 0;\n            var frEle = [];\n            if (gObj.getFrozenMode() === literals.leftRight) {\n                frHdrFrm = gObj.getFrozenRightHeader().querySelector('.e-gridform');\n                frCntFrm = gObj.getFrozenRightContent().querySelector('.e-gridform');\n                frEle = [frHdrFrm || frCntFrm];\n            }\n            gridActionHandler(this.parent, function (tableName, elements) {\n                for (var _i = 0, elements_1 = elements; _i < elements_1.length; _i++) {\n                    var ele = elements_1[_i];\n                    if (ele) {\n                        editedData = gObj.editModule.getCurrentEditedData(ele, editedData);\n                    }\n                }\n            }, [[], mvblEle, frEle]);\n        }\n        var eleLength = [].slice.call(gObj.element.getElementsByClassName(literals.editedRow)).length;\n        if (!data.isAdd && Object.keys(this.currentVirtualData).length && !eleLength) {\n            eleLength = 1;\n        }\n        if (isDlg ? dlgWrapper.getElementsByClassName(literals.editedRow).length : eleLength) {\n            args.action = 'edit';\n            gObj.trigger(events.actionBegin, args, function (endEditArgs) {\n                if (endEditArgs.cancel) {\n                    return;\n                }\n                gObj.showSpinner();\n                gObj.notify(events.updateData, endEditArgs);\n            });\n        }\n        else {\n            args.action = 'add';\n            args.selectedRow = 0;\n            args.index = this.addedRowIndex;\n            gObj.notify(events.virtualScrollEditSuccess, {});\n            gObj.notify(events.modelChanged, args);\n            this.addedRowIndex = null;\n            if (args.cancel) {\n                return;\n            }\n        }\n    };\n    NormalEdit.prototype.destroyElements = function () {\n        var gObj = this.parent;\n        gObj.editModule.destroyWidgets();\n        gObj.editModule.destroyForm();\n        this.parent.notify(events.dialogDestroy, {});\n    };\n    NormalEdit.prototype.editHandler = function (args) {\n        var _this = this;\n        if (args.promise) {\n            args.promise.then(function (e) { return _this.edSucc(e, args); }).catch(function (e) { return _this.edFail(e); });\n        }\n        else {\n            this.editSuccess(args.data, args);\n        }\n    };\n    NormalEdit.prototype.edSucc = function (e, args) {\n        this.editSuccess(e, args);\n    };\n    NormalEdit.prototype.edFail = function (e) {\n        this.editFailure(e);\n    };\n    NormalEdit.prototype.updateCurrentViewData = function (data) {\n        if (!this.parent.enableVirtualization && !this.parent.enableInfiniteScrolling) {\n            this.parent.getCurrentViewRecords()[this.editRowIndex] = data;\n        }\n    };\n    NormalEdit.prototype.requestSuccess = function (args) {\n        if (this.parent.editModule.formObj && !this.parent.editModule.formObj.isDestroyed) {\n            this.destroyElements();\n            this.stopEditStatus();\n            if (this.parent.editSettings.mode === 'Dialog' && args.action !== 'add' &&\n                this.parent.selectionModule) {\n                this.parent.element.querySelector('.e-dlgeditrow').classList.remove('e-dlgeditrow');\n            }\n        }\n    };\n    NormalEdit.prototype.editSuccess = function (e, args) {\n        if (!isNullOrUndefined(e) && !(e instanceof Array)) {\n            var rowData = 'rowData';\n            args.data = extend({}, extend({}, args[rowData], args.data), e);\n        }\n        this.requestSuccess(args);\n        this.parent.trigger(events.beforeDataBound, args);\n        args.type = events.actionComplete;\n        this.parent.isEdit = false;\n        this.refreshRow(args.data);\n        this.parent.notify(events.virtualScrollEditSuccess, args);\n        this.parent.editModule.checkLastRow(args.row);\n        this.parent.editModule.isLastRow = false;\n        this.updateCurrentViewData(args.data);\n        this.blazorTemplate();\n        this.editRowIndex = null;\n        this.parent.trigger(events.actionComplete, args);\n        if (!(this.parent.isCheckBoxSelection || this.parent.selectionSettings.type === 'Multiple')\n            || (!this.parent.isPersistSelection) && !this.parent.selectionSettings.checkboxOnly) {\n            if (this.parent.editSettings.mode !== 'Dialog') {\n                this.parent.selectRow(this.rowIndex > -1 ? this.rowIndex : this.editRowIndex);\n            }\n        }\n        this.parent.hideSpinner();\n    };\n    NormalEdit.prototype.closeForm = function () {\n        if (!this.cloneRow && this.parent.isEdit) {\n            this.stopEditStatus();\n        }\n        if (this.cloneRow) {\n            this.cloneRow.remove();\n            this.cloneRow = null;\n            this.originalRow.classList.remove('e-hiddenrow');\n        }\n        if (this.parent.isFrozenGrid() && this.cloneFrozen) {\n            this.cloneFrozen.remove();\n            this.frozen.classList.remove('e-hiddenrow');\n        }\n    };\n    NormalEdit.prototype.blazorTemplate = function () {\n        var cols = this.parent.getColumns();\n        if (this.parent.editSettings.template && this.parent.editSettings.mode === 'Normal') {\n            updateBlazorTemplate(this.parent.element.id + 'editSettingsTemplate', 'Template', this.parent.editSettings);\n        }\n        for (var i = 0; i < cols.length; i++) {\n            var col = cols[i];\n            if (col.template) {\n                updateBlazorTemplate(this.parent.element.id + col.uid, 'Template', col, false);\n            }\n            if (col.editTemplate) {\n                updateBlazorTemplate(this.parent.element.id + col.uid + 'editTemplate', 'EditTemplate', col);\n            }\n        }\n    };\n    NormalEdit.prototype.editFailure = function (e) {\n        this.parent.trigger(events.actionFailure, ({ error: e }));\n        this.parent.hideSpinner();\n        this.parent.log('actionfailure', { error: e });\n    };\n    NormalEdit.prototype.needRefresh = function () {\n        var refresh = true;\n        var editedRow = this.parent.element.querySelector('.e-gridform');\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && this.parent.editSettings.mode === 'Normal' && !editedRow) {\n            refresh = false;\n        }\n        return refresh;\n    };\n    NormalEdit.prototype.refreshRow = function (data) {\n        var frzCols = this.parent.isFrozenGrid();\n        var row = new RowRenderer(this.serviceLocator, null, this.parent);\n        var rowObj = this.parent.getRowObjectFromUID(this.uid);\n        if (rowObj) {\n            rowObj.changes = data;\n            this.parent.notify(events.refreshVirtualCache, { data: data });\n            refreshForeignData(rowObj, this.parent.getForeignKeyColumns(), rowObj.changes);\n            if (this.needRefresh()) {\n                row.refresh(rowObj, this.parent.getColumns(), true);\n            }\n            var tr = [].slice.call(this.parent.element.querySelectorAll('[aria-rowindex=\"' + rowObj.index + '\"]'));\n            if (frzCols && tr.length) {\n                for (var i = 0; i < tr.length; i++) {\n                    var rowUid = tr[i].getAttribute('data-uid');\n                    if (rowUid !== this.uid) {\n                        rowObj = this.parent.getRowObjectFromUID(rowUid);\n                        rowObj.changes = data;\n                        row.refresh(rowObj, this.parent.getColumns(), true);\n                        this.parent.editModule.checkLastRow(tr[i]);\n                    }\n                }\n            }\n        }\n    };\n    NormalEdit.prototype.closeEdit = function () {\n        var _this = this;\n        if (!this.parent.isEdit) {\n            return;\n        }\n        var gObj = this.parent;\n        var args = extend(this.args, {\n            requestType: 'cancel', type: events.actionBegin, cancel: false, data: this.previousData, selectedRow: gObj.selectedRowIndex\n        });\n        gObj.notify(events.virtualScrollEditCancel, args);\n        this.blazorTemplate();\n        gObj.trigger(events.actionBegin, args, function (closeEditArgs) {\n            if (closeEditArgs.cancel) {\n                return;\n            }\n            if (_this.parent.editSettings.mode === 'Dialog') {\n                _this.parent.notify(events.dialogDestroy, {});\n            }\n            gObj.isEdit = false;\n            _this.stopEditStatus();\n            closeEditArgs.type = events.actionComplete;\n            if (gObj.editSettings.mode !== 'Dialog') {\n                _this.refreshRow(closeEditArgs.data);\n            }\n            var isLazyLoad = gObj.groupSettings.enableLazyLoading && gObj.groupSettings.columns.length\n                && !gObj.getContentTable().querySelector('tr.e-emptyrow');\n            if (!gObj.getContentTable().querySelector('tr.e-emptyrow') &&\n                !gObj.getContentTable().querySelector('tr.e-row') && !isLazyLoad) {\n                gObj.renderModule.emptyRow();\n            }\n            if (gObj.editSettings.mode !== 'Dialog') {\n                gObj.selectRow(_this.rowIndex);\n            }\n            gObj.trigger(events.actionComplete, closeEditArgs);\n        });\n    };\n    NormalEdit.prototype.addRecord = function (data, index) {\n        var _this = this;\n        var gObj = this.parent;\n        this.addedRowIndex = index = !isNullOrUndefined(index) ? index : 0;\n        if (data) {\n            gObj.notify(events.modelChanged, {\n                requestType: 'save', type: events.actionBegin, data: data, selectedRow: 0, action: 'add', index: index\n            });\n            return;\n        }\n        if (gObj.isEdit) {\n            return;\n        }\n        this.previousData = {};\n        this.uid = '';\n        var cols = gObj.getColumns();\n        var rowData = { virtualData: {}, isScroll: false };\n        this.parent.notify(events.getVirtualData, rowData);\n        for (var i = 0; i < cols.length; i++) {\n            if (rowData.isScroll && cols[i].getFreezeTableName() !== 'movable') {\n                continue;\n            }\n            if (cols[i].field) {\n                DataUtil.setValue(cols[i].field, cols[i].defaultValue, this.previousData);\n            }\n        }\n        var args = {\n            cancel: false, foreignKeyData: {},\n            requestType: 'add', data: this.previousData, type: events.actionBegin, index: index,\n            rowData: this.previousData, target: undefined, isScroll: rowData.isScroll\n        };\n        if ((this.parent.enableVirtualization || this.parent.infiniteScrollSettings.enableCache)\n            && Object.keys(rowData.virtualData).length) {\n            args.data = args.rowData = rowData.virtualData;\n        }\n        if (!args.isScroll) {\n            this.parent.notify(events.createVirtualValidationForm, { uid: this.uid, prevData: this.previousData, argsCreator: this.getEditArgs.bind(this), renderer: this.renderer });\n            gObj.trigger(events.actionBegin, args, function (addArgs) {\n                if (addArgs.cancel) {\n                    return;\n                }\n                _this.inlineAddHandler(addArgs);\n            });\n        }\n        else {\n            this.inlineAddHandler(args);\n        }\n    };\n    NormalEdit.prototype.inlineAddHandler = function (addArgs) {\n        var gObj = this.parent;\n        gObj.isEdit = true;\n        if (gObj.editSettings.mode !== 'Dialog') {\n            gObj.clearSelection();\n        }\n        this.renderer.addNew(addArgs);\n        gObj.editModule.applyFormValidation();\n        addArgs.type = events.actionComplete;\n        addArgs.row = gObj.element.querySelector('.' + literals.addedRow);\n        gObj.trigger(events.actionComplete, addArgs);\n        this.args = addArgs;\n    };\n    NormalEdit.prototype.deleteRecord = function (fieldname, data) {\n        this.editRowIndex = this.parent.selectedRowIndex;\n        if (data) {\n            data = (data instanceof Array) ? data : [data];\n            var gObj = this.parent;\n            var dataLen = Object.keys(data).length;\n            fieldname = fieldname || this.parent.getPrimaryKeyFieldNames()[0];\n            var _loop_1 = function (i) {\n                var _a;\n                var tmpRecord;\n                var contained = gObj.currentViewData.some(function (record) {\n                    tmpRecord = record;\n                    return data[i] === getObject(fieldname, record) || data[i] === record;\n                });\n                data[i] = contained ? tmpRecord : data[i][fieldname] ? data[i] : (_a = {}, _a[fieldname] = data[i], _a);\n            };\n            for (var i = 0; i < dataLen; i++) {\n                _loop_1(i);\n            }\n        }\n        var args = {\n            requestType: 'delete', type: events.actionBegin, foreignKeyData: {},\n            data: data ? data : this.parent.getSelectedRecords(), tr: this.parent.getSelectedRows(), cancel: false\n        };\n        if (!isNullOrUndefined(this.parent.commandDelIndex)) {\n            args.data[0] =\n                this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute('data-uid')).data;\n        }\n        if (this.parent.enableVirtualization && args.data.length > 1) {\n            var uid = this.parent.getSelectedRows()[0].getAttribute('data-uid');\n            args.data = [this.parent.getRowObjectFromUID(uid).data];\n        }\n        this.parent.notify(events.modelChanged, args);\n    };\n    NormalEdit.prototype.stopEditStatus = function () {\n        var gObj = this.parent;\n        var addElements = [].slice.call(gObj.element.getElementsByClassName(literals.addedRow));\n        var editElements = [].slice.call(gObj.element.getElementsByClassName(literals.editedRow));\n        for (var i = 0; i < addElements.length; i++) {\n            remove(addElements[i]);\n        }\n        for (var i = 0; i < editElements.length; i++) {\n            editElements[i].classList.remove(literals.editedRow);\n        }\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    NormalEdit.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.evtHandlers = [{ event: events.crudAction, handler: this.editHandler },\n            { event: events.doubleTap, handler: this.dblClickHandler },\n            { event: events.click, handler: this.clickHandler },\n            { event: events.recordAdded, handler: this.requestSuccess },\n            { event: events.dblclick, handler: this.dblClickHandler },\n            { event: events.deleteComplete, handler: this.editComplete },\n            { event: events.saveComplete, handler: this.editComplete },\n            { event: events.rowModeChange, handler: this.closeEdit },\n            { event: events.closeInline, handler: this.closeForm }];\n        addRemoveEventListener(this.parent, this.evtHandlers, true, this);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    NormalEdit.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        addRemoveEventListener(this.parent, this.evtHandlers, false);\n    };\n    /**\n     * @returns {void}\n     * @hidden\n     */\n    NormalEdit.prototype.destroy = function () {\n        this.removeEventListener();\n        this.renderer.destroy();\n    };\n    return NormalEdit;\n}());\nexport { NormalEdit };\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}